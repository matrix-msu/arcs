/**\n * ARCS\n * 0.9.9\n * Generated on Mon May  4 13:00:28 EDT 2015 with c858fe8\n *\n * Copyright 2012-2013, Michigan State University Board of Trustees\n */
var JSON;if(!JSON){JSON={}}(function(){"use strict";function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else if(typeof space==="string"){indent=space}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}})();(function(a,b){function cy(a){return f.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function cv(a){if(!ck[a]){var b=c.body,d=f("<"+a+">").appendTo(b),e=d.css("display");d.remove();if(e==="none"||e===""){cl||(cl=c.createElement("iframe"),cl.frameBorder=cl.width=cl.height=0),b.appendChild(cl);if(!cm||!cl.createElement)cm=(cl.contentWindow||cl.contentDocument).document,cm.write((c.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>"),cm.close();d=cm.createElement(a),cm.body.appendChild(d),e=f.css(d,"display"),b.removeChild(cl)}ck[a]=e}return ck[a]}function cu(a,b){var c={};f.each(cq.concat.apply([],cq.slice(0,b)),function(){c[this]=a});return c}function ct(){cr=b}function cs(){setTimeout(ct,0);return cr=f.now()}function cj(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function ci(){try{return new a.XMLHttpRequest}catch(b){}}function cc(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},g,h,i=d.length,j,k=d[0],l,m,n,o,p;for(g=1;g<i;g++){if(g===1)for(h in a.converters)typeof h=="string"&&(e[h.toLowerCase()]=a.converters[h]);l=k,k=d[g];if(k==="*")k=l;else if(l!=="*"&&l!==k){m=l+" "+k,n=e[m]||e["* "+k];if(!n){p=b;for(o in e){j=o.split(" ");if(j[0]===l||j[0]==="*"){p=e[j[1]+" "+k];if(p){o=e[o],o===!0?n=p:p===!0&&(n=o);break}}}}!n&&!p&&f.error("No conversion from "+m.replace(" "," to ")),n!==!0&&(c=n?n(c):p(o(c)))}}return c}function cb(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g)i in d&&(c[g[i]]=d[i]);while(f[0]==="*")f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"));if(h)for(i in e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in d)j=f[0];else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j){j!==f[0]&&f.unshift(j);return d[j]}}function ca(a,b,c,d){if(f.isArray(b))f.each(b,function(b,e){c||bE.test(a)?d(a,e):ca(a+"["+(typeof e=="object"||f.isArray(e)?b:"")+"]",e,c,d)});else if(!c&&b!=null&&typeof b=="object")for(var e in b)ca(a+"["+e+"]",b[e],c,d);else d(a,b)}function b_(a,c){var d,e,g=f.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((g[d]?a:e||(e={}))[d]=c[d]);e&&f.extend(!0,a,e)}function b$(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===bT,l;for(;i<j&&(k||!l);i++)l=h[i](c,d,e),typeof l=="string"&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=b$(a,c,d,e,l,g)));(k||!l)&&!g["*"]&&(l=b$(a,c,d,e,"*",g));return l}function bZ(a){return function(b,c){typeof b!="string"&&(c=b,b="*");if(f.isFunction(c)){var d=b.toLowerCase().split(bP),e=0,g=d.length,h,i,j;for(;e<g;e++)h=d[e],j=/^\+/.test(h),j&&(h=h.substr(1)||"*"),i=a[h]=a[h]||[],i[j?"unshift":"push"](c)}}}function bC(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=b==="width"?bx:by,g=0,h=e.length;if(d>0){if(c!=="border")for(;g<h;g++)c||(d-=parseFloat(f.css(a,"padding"+e[g]))||0),c==="margin"?d+=parseFloat(f.css(a,c+e[g]))||0:d-=parseFloat(f.css(a,"border"+e[g]+"Width"))||0;return d+"px"}d=bz(a,b,b);if(d<0||d==null)d=a.style[b]||0;d=parseFloat(d)||0;if(c)for(;g<h;g++)d+=parseFloat(f.css(a,"padding"+e[g]))||0,c!=="padding"&&(d+=parseFloat(f.css(a,"border"+e[g]+"Width"))||0),c==="margin"&&(d+=parseFloat(f.css(a,c+e[g]))||0);return d+"px"}function bp(a,b){b.src?f.ajax({url:b.src,async:!1,dataType:"script"}):f.globalEval((b.text||b.textContent||b.innerHTML||"").replace(bf,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)}function bo(a){var b=c.createElement("div");bh.appendChild(b),b.innerHTML=a.outerHTML;return b.firstChild}function bn(a){var b=(a.nodeName||"").toLowerCase();b==="input"?bm(a):b!=="script"&&typeof a.getElementsByTagName!="undefined"&&f.grep(a.getElementsByTagName("input"),bm)}function bm(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function bl(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function bk(a,b){var c;if(b.nodeType===1){b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase();if(c==="object")b.outerHTML=a.outerHTML;else if(c!=="input"||a.type!=="checkbox"&&a.type!=="radio"){if(c==="option")b.selected=a.defaultSelected;else if(c==="input"||c==="textarea")b.defaultValue=a.defaultValue}else a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value);b.removeAttribute(f.expando)}}function bj(a,b){if(b.nodeType===1&&!!f.hasData(a)){var c,d,e,g=f._data(a),h=f._data(b,g),i=g.events;if(i){delete h.handle,h.events={};for(c in i)for(d=0,e=i[c].length;d<e;d++)f.event.add(b,c+(i[c][d].namespace?".":"")+i[c][d].namespace,i[c][d],i[c][d].data)}h.data&&(h.data=f.extend({},h.data))}}function bi(a,b){return f.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function U(a){var b=V.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}function T(a,b,c){b=b||0;if(f.isFunction(b))return f.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return f.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=f.grep(a,function(a){return a.nodeType===1});if(O.test(b))return f.filter(b,d,!c);b=f.filter(b,d)}return f.grep(a,function(a,d){return f.inArray(a,b)>=0===c})}function S(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function K(){return!0}function J(){return!1}function n(a,b,c){var d=b+"defer",e=b+"queue",g=b+"mark",h=f._data(a,d);h&&(c==="queue"||!f._data(a,e))&&(c==="mark"||!f._data(a,g))&&setTimeout(function(){!f._data(a,e)&&!f._data(a,g)&&(f.removeData(a,d,!0),h.fire())},0)}function m(a){for(var b in a){if(b==="data"&&f.isEmptyObject(a[b]))continue;if(b!=="toJSON")return!1}return!0}function l(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(k,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:f.isNumeric(d)?parseFloat(d):j.test(d)?f.parseJSON(d):d}catch(g){}f.data(a,c,d)}else d=b}return d}function h(a){var b=g[a]={},c,d;a=a.split(/\s+/);for(c=0,d=a.length;c<d;c++)b[a[c]]=!0;return b}var c=a.document,d=a.navigator,e=a.location,f=function(){function J(){if(!e.isReady){try{c.documentElement.doScroll("left")}catch(a){setTimeout(J,1);return}e.ready()}}var e=function(a,b){return new e.fn.init(a,b,h)},f=a.jQuery,g=a.$,h,i=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,j=/\S/,k=/^\s+/,l=/\s+$/,m=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,n=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,p=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,q=/(?:^|:|,)(?:\s*\[)+/g,r=/(webkit)[ \/]([\w.]+)/,s=/(opera)(?:.*version)?[ \/]([\w.]+)/,t=/(msie) ([\w.]+)/,u=/(mozilla)(?:.*? rv:([\w.]+))?/,v=/-([a-z]|[0-9])/gi,w=/^-ms-/,x=function(a,b){return(b+"").toUpperCase()},y=d.userAgent,z,A,B,C=Object.prototype.toString,D=Object.prototype.hasOwnProperty,E=Array.prototype.push,F=Array.prototype.slice,G=String.prototype.trim,H=Array.prototype.indexOf,I={};e.fn=e.prototype={constructor:e,init:function(a,d,f){var g,h,j,k;if(!a)return this;if(a.nodeType){this.context=this[0]=a,this.length=1;return this}if(a==="body"&&!d&&c.body){this.context=c,this[0]=c.body,this.selector=a,this.length=1;return this}if(typeof a=="string"){a.charAt(0)!=="<"||a.charAt(a.length-1)!==">"||a.length<3?g=i.exec(a):g=[null,a,null];if(g&&(g[1]||!d)){if(g[1]){d=d instanceof e?d[0]:d,k=d?d.ownerDocument||d:c,j=m.exec(a),j?e.isPlainObject(d)?(a=[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=[k.createElement(j[1])]:(j=e.buildFragment([g[1]],[k]),a=(j.cacheable?e.clone(j.fragment):j.fragment).childNodes);return e.merge(this,a)}h=c.getElementById(g[2]);if(h&&h.parentNode){if(h.id!==g[2])return f.find(a);this.length=1,this[0]=h}this.context=c,this.selector=a;return this}return!d||d.jquery?(d||f).find(a):this.constructor(d).find(a)}if(e.isFunction(a))return f.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return e.makeArray(a,this)},selector:"",jquery:"1.7.1",length:0,size:function(){return this.length},toArray:function(){return F.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();e.isArray(a)?E.apply(d,a):e.merge(d,a),d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")");return d},each:function(a,b){return e.each(this,a,b)},ready:function(a){e.bindReady(),A.add(a);return this},eq:function(a){a=+a;return a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(F.apply(this,arguments),"slice",F.call(arguments).join(","))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:E,sort:[].sort,splice:[].splice},e.fn.init.prototype=e.fn,e.extend=e.fn.extend=function(){var a,c,d,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i=="boolean"&&(l=i,i=arguments[1]||{},j=2),typeof i!="object"&&!e.isFunction(i)&&(i={}),k===j&&(i=this,--j);for(;j<k;j++)if((a=arguments[j])!=null)for(c in a){d=i[c],f=a[c];if(i===f)continue;l&&f&&(e.isPlainObject(f)||(g=e.isArray(f)))?(g?(g=!1,h=d&&e.isArray(d)?d:[]):h=d&&e.isPlainObject(d)?d:{},i[c]=e.extend(l,h,f)):f!==b&&(i[c]=f)}return i},e.extend({noConflict:function(b){a.$===e&&(a.$=g),b&&a.jQuery===e&&(a.jQuery=f);return e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!c.body)return setTimeout(e.ready,1);e.isReady=!0;if(a!==!0&&--e.readyWait>0)return;A.fireWith(c,[e]),e.fn.trigger&&e(c).trigger("ready").off("ready")}},bindReady:function(){if(!A){A=e.Callbacks("once memory");if(c.readyState==="complete")return setTimeout(e.ready,1);if(c.addEventListener)c.addEventListener("DOMContentLoaded",B,!1),a.addEventListener("load",e.ready,!1);else if(c.attachEvent){c.attachEvent("onreadystatechange",B),a.attachEvent("onload",e.ready);var b=!1;try{b=a.frameElement==null}catch(d){}c.documentElement.doScroll&&b&&J()}}},isFunction:function(a){return e.type(a)==="function"},isArray:Array.isArray||function(a){return e.type(a)==="array"},isWindow:function(a){return a&&typeof a=="object"&&"setInterval"in a},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):I[C.call(a)]||"object"},isPlainObject:function(a){if(!a||e.type(a)!=="object"||a.nodeType||e.isWindow(a))return!1;try{if(a.constructor&&!D.call(a,"constructor")&&!D.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||D.call(a,d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw new Error(a)},parseJSON:function(b){if(typeof b!="string"||!b)return null;b=e.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(n.test(b.replace(o,"@").replace(p,"]").replace(q,"")))return new Function("return "+b)();e.error("Invalid JSON: "+b)},parseXML:function(c){var d,f;try{a.DOMParser?(f=new DOMParser,d=f.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(g){d=b}(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&e.error("Invalid XML: "+c);return d},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(w,"ms-").replace(v,x)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,g=0,h=a.length,i=h===b||e.isFunction(a);if(d){if(i){for(f in a)if(c.apply(a[f],d)===!1)break}else for(;g<h;)if(c.apply(a[g++],d)===!1)break}else if(i){for(f in a)if(c.call(a[f],f,a[f])===!1)break}else for(;g<h;)if(c.call(a[g],g,a[g++])===!1)break;return a},trim:G?function(a){return a==null?"":G.call(a)}:function(a){return a==null?"":(a+"").replace(k,"").replace(l,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var d=e.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||e.isWindow(a)?E.call(c,a):e.merge(c,a)}return c},inArray:function(a,b,c){var d;if(b){if(H)return H.call(b,a,c);d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number")for(var f=c.length;e<f;e++)a[d++]=c[e];else while(c[e]!==b)a[d++]=c[e++];a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);return d},map:function(a,c,d){var f,g,h=[],i=0,j=a.length,k=a instanceof e||j!==b&&typeof j=="number"&&(j>0&&a[0]&&a[j-1]||j===0||e.isArray(a));if(k)for(;i<j;i++)f=c(a[i],i,d),f!=null&&(h[h.length]=f);else for(g in a)f=c(a[g],g,d),f!=null&&(h[h.length]=f);return h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof c=="string"){var d=a[c];c=a,a=d}if(!e.isFunction(a))return b;var f=F.call(arguments,2),g=function(){return a.apply(c,f.concat(F.call(arguments)))};g.guid=a.guid=a.guid||g.guid||e.guid++;return g},access:function(a,c,d,f,g,h){var i=a.length;if(typeof c=="object"){for(var j in c)e.access(a,j,c[j],f,g,d);return a}if(d!==b){f=!h&&f&&e.isFunction(d);for(var k=0;k<i;k++)g(a[k],c,f?d.call(a[k],k,g(a[k],c)):d,h);return a}return i?g(a[0],c):b},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=r.exec(a)||s.exec(a)||t.exec(a)||a.indexOf("compatible")<0&&u.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,f){f&&f instanceof e&&!(f instanceof a)&&(f=a(f));return e.fn.init.call(this,d,f,b)},a.fn.init.prototype=a.fn;var b=a(c);return a},browser:{}}),e.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){I["[object "+b+"]"]=b.toLowerCase()}),z=e.uaMatch(y),z.browser&&(e.browser[z.browser]=!0,e.browser.version=z.version),e.browser.webkit&&(e.browser.safari=!0),j.test("Â ")&&(k=/^[\s\xA0]+/,l=/[\s\xA0]+$/),h=e(c),c.addEventListener?B=function(){c.removeEventListener("DOMContentLoaded",B,!1),e.ready()}:c.attachEvent&&(B=function(){c.readyState==="complete"&&(c.detachEvent("onreadystatechange",B),e.ready())});return e}(),g={};f.Callbacks=function(a){a=a?g[a]||h(a):{};var c=[],d=[],e,i,j,k,l,m=function(b){var d,e,g,h,i;for(d=0,e=b.length;d<e;d++)g=b[d],h=f.type(g),h==="array"?m(g):h==="function"&&(!a.unique||!o.has(g))&&c.push(g)},n=function(b,f){f=f||[],e=!a.memory||[b,f],i=!0,l=j||0,j=0,k=c.length;for(;c&&l<k;l++)if(c[l].apply(b,f)===!1&&a.stopOnFalse){e=!0;break}i=!1,c&&(a.once?e===!0?o.disable():c=[]:d&&d.length&&(e=d.shift(),o.fireWith(e[0],e[1])))},o={add:function(){if(c){var a=c.length;m(arguments),i?k=c.length:e&&e!==!0&&(j=a,n(e[0],e[1]))}return this},remove:function(){if(c){var b=arguments,d=0,e=b.length;for(;d<e;d++)for(var f=0;f<c.length;f++)if(b[d]===c[f]){i&&f<=k&&(k--,f<=l&&l--),c.splice(f--,1);if(a.unique)break}}return this},has:function(a){if(c){var b=0,d=c.length;for(;b<d;b++)if(a===c[b])return!0}return!1},empty:function(){c=[];return this},disable:function(){c=d=e=b;return this},disabled:function(){return!c},lock:function(){d=b,(!e||e===!0)&&o.disable();return this},locked:function(){return!d},fireWith:function(b,c){d&&(i?a.once||d.push([b,c]):(!a.once||!e)&&n(b,c));return this},fire:function(){o.fireWith(this,arguments);return this},fired:function(){return!!e}};return o};var i=[].slice;f.extend({Deferred:function(a){var b=f.Callbacks("once memory"),c=f.Callbacks("once memory"),d=f.Callbacks("memory"),e="pending",g={resolve:b,reject:c,notify:d},h={done:b.add,fail:c.add,progress:d.add,state:function(){return e},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){i.done(a).fail(b).progress(c);return this},always:function(){i.done.apply(i,arguments).fail.apply(i,arguments);return this},pipe:function(a,b,c){return f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c=b[0],e=b[1],g;f.isFunction(c)?i[a](function(){g=c.apply(this,arguments),g&&f.isFunction(g.promise)?g.promise().then(d.resolve,d.reject,d.notify):d[e+"With"](this===i?d:this,[g])}):i[a](d[e])})}).promise()},promise:function(a){if(a==null)a=h;else for(var b in h)a[b]=h[b];return a}},i=h.promise({}),j;for(j in g)i[j]=g[j].fire,i[j+"With"]=g[j].fireWith;i.done(function(){e="resolved"},c.disable,d.lock).fail(function(){e="rejected"},b.disable,d.lock),a&&a.call(i,i);return i},when:function(a){function m(a){return function(b){e[a]=arguments.length>1?i.call(arguments,0):b,j.notifyWith(k,e)}}function l(a){return function(c){b[a]=arguments.length>1?i.call(arguments,0):c,--g||j.resolveWith(j,b)}}var b=i.call(arguments,0),c=0,d=b.length,e=Array(d),g=d,h=d,j=d<=1&&a&&f.isFunction(a.promise)?a:f.Deferred(),k=j.promise();if(d>1){for(;c<d;c++)b[c]&&b[c].promise&&f.isFunction(b[c].promise)?b[c].promise().then(l(c),j.reject,m(c)):--g;g||j.resolveWith(j,b)}else j!==a&&j.resolveWith(j,d?[a]:[]);return k}}),f.support=function(){var b,d,e,g,h,i,j,k,l,m,n,o,p,q=c.createElement("div"),r=c.documentElement;q.setAttribute("className","t"),q.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",d=q.getElementsByTagName("*"),e=q.getElementsByTagName("a")[0];if(!d||!d.length||!e)return{};g=c.createElement("select"),h=g.appendChild(c.createElement("option")),i=q.getElementsByTagName("input")[0],b={leadingWhitespace:q.firstChild.nodeType===3,tbody:!q.getElementsByTagName("tbody").length,htmlSerialize:!!q.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:e.getAttribute("href")==="/a",opacity:/^0.55/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:i.value==="on",optSelected:h.selected,getSetAttribute:q.className!=="t",enctype:!!c.createElement("form").enctype,html5Clone:c.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0},i.checked=!0,b.noCloneChecked=i.cloneNode(!0).checked,g.disabled=!0,b.optDisabled=!h.disabled;try{delete q.test}catch(s){b.deleteExpando=!1}!q.addEventListener&&q.attachEvent&&q.fireEvent&&(q.attachEvent("onclick",function(){b.noCloneEvent=!1}),q.cloneNode(!0).fireEvent("onclick")),i=c.createElement("input"),i.value="t",i.setAttribute("type","radio"),b.radioValue=i.value==="t",i.setAttribute("checked","checked"),q.appendChild(i),k=c.createDocumentFragment(),k.appendChild(q.lastChild),b.checkClone=k.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=i.checked,k.removeChild(i),k.appendChild(q),q.innerHTML="",a.getComputedStyle&&(j=c.createElement("div"),j.style.width="0",j.style.marginRight="0",q.style.width="2px",q.appendChild(j),b.reliableMarginRight=(parseInt((a.getComputedStyle(j,null)||{marginRight:0}).marginRight,10)||0)===0);if(q.attachEvent)for(o in{submit:1,change:1,focusin:1})n="on"+o,p=n in q,p||(q.setAttribute(n,"return;"),p=typeof q[n]=="function"),b[o+"Bubbles"]=p;k.removeChild(q),k=g=h=j=q=i=null,f(function(){var a,d,e,g,h,i,j,k,m,n,o,r=c.getElementsByTagName("body")[0];!r||(j=1,k="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;",m="visibility:hidden;border:0;",n="style='"+k+"border:5px solid #000;padding:0;'",o="<div "+n+"><div></div></div>"+"<table "+n+" cellpadding='0' cellspacing='0'>"+"<tr><td></td></tr></table>",a=c.createElement("div"),a.style.cssText=m+"width:0;height:0;position:static;top:0;margin-top:"+j+"px",r.insertBefore(a,r.firstChild),q=c.createElement("div"),a.appendChild(q),q.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>",l=q.getElementsByTagName("td"),p=l[0].offsetHeight===0,l[0].style.display="",l[1].style.display="none",b.reliableHiddenOffsets=p&&l[0].offsetHeight===0,q.innerHTML="",q.style.width=q.style.paddingLeft="1px",f.boxModel=b.boxModel=q.offsetWidth===2,typeof q.style.zoom!="undefined"&&(q.style.display="inline",q.style.zoom=1,b.inlineBlockNeedsLayout=q.offsetWidth===2,q.style.display="",q.innerHTML="<div style='width:4px;'></div>",b.shrinkWrapBlocks=q.offsetWidth!==2),q.style.cssText=k+m,q.innerHTML=o,d=q.firstChild,e=d.firstChild,h=d.nextSibling.firstChild.firstChild,i={doesNotAddBorder:e.offsetTop!==5,doesAddBorderForTableAndCells:h.offsetTop===5},e.style.position="fixed",e.style.top="20px",i.fixedPosition=e.offsetTop===20||e.offsetTop===15,e.style.position=e.style.top="",d.style.overflow="hidden",d.style.position="relative",i.subtractsBorderForOverflowNotVisible=e.offsetTop===-5,i.doesNotIncludeMarginInBodyOffset=r.offsetTop!==j,r.removeChild(a),q=a=null,f.extend(b,i))});return b}();var j=/^(?:\{.*\}|\[.*\])$/,k=/([A-Z])/g;f.extend({cache:{},uuid:0,expando:"jQuery"+(f.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?f.cache[a[f.expando]]:a[f.expando];return!!a&&!m(a)},data:function(a,c,d,e){if(!!f.acceptData(a)){var g,h,i,j=f.expando,k=typeof c=="string",l=a.nodeType,m=l?f.cache:a,n=l?a[j]:a[j]&&j,o=c==="events";if((!n||!m[n]||!o&&!e&&!m[n].data)&&k&&d===b)return;n||(l?a[j]=n=++f.uuid:n=j),m[n]||(m[n]={},l||(m[n].toJSON=f.noop));if(typeof c=="object"||typeof c=="function")e?m[n]=f.extend(m[n],c):m[n].data=f.extend(m[n].data,c);g=h=m[n],e||(h.data||(h.data={}),h=h.data),d!==b&&(h[f.camelCase(c)]=d);if(o&&!h[c])return g.events;k?(i=h[c],i==null&&(i=h[f.camelCase(c)])):i=h;return i}},removeData:function(a,b,c){if(!!f.acceptData(a)){var d,e,g,h=f.expando,i=a.nodeType,j=i?f.cache:a,k=i?a[h]:h;if(!j[k])return;if(b){d=c?j[k]:j[k].data;if(d){f.isArray(b)||(b in d?b=[b]:(b=f.camelCase(b),b in d?b=[b]:b=b.split(" ")));for(e=0,g=b.length;e<g;e++)delete d[b[e]];if(!(c?m:f.isEmptyObject)(d))return}}if(!c){delete j[k].data;if(!m(j[k]))return}f.support.deleteExpando||!j.setInterval?delete j[k]:j[k]=null,i&&(f.support.deleteExpando?delete a[h]:a.removeAttribute?a.removeAttribute(h):a[h]=null)}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute("classid")===b}return!0}}),f.fn.extend({data:function(a,c){var d,e,g,h=null;if(typeof a=="undefined"){if(this.length){h=f.data(this[0]);if(this[0].nodeType===1&&!f._data(this[0],"parsedAttrs")){e=this[0].attributes;for(var i=0,j=e.length;i<j;i++)g=e[i].name,g.indexOf("data-")===0&&(g=f.camelCase(g.substring(5)),l(this[0],g,h[g]));f._data(this[0],"parsedAttrs",!0)}}return h}if(typeof a=="object")return this.each(function(){f.data(this,a)});d=a.split("."),d[1]=d[1]?"."+d[1]:"";if(c===b){h=this.triggerHandler("getData"+d[1]+"!",[d[0]]),h===b&&this.length&&(h=f.data(this[0],a),h=l(this[0],a,h));return h===b&&d[1]?this.data(d[0]):h}return this.each(function(){var b=f(this),e=[d[0],c];b.triggerHandler("setData"+d[1]+"!",e),f.data(this,a,c),b.triggerHandler("changeData"+d[1]+"!",e)})},removeData:function(a){return this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a,b){a&&(b=(b||"fx")+"mark",f._data(a,b,(f._data(a,b)||0)+1))},_unmark:function(a,b,c){a!==!0&&(c=b,b=a,a=!1);if(b){c=c||"fx";var d=c+"mark",e=a?0:(f._data(b,d)||1)-1;e?f._data(b,d,e):(f.removeData(b,d,!0),n(b,c,"mark"))}},queue:function(a,b,c){var d;if(a){b=(b||"fx")+"queue",d=f._data(a,b),c&&(!d||f.isArray(c)?d=f._data(a,b,f.makeArray(c)):d.push(c));return d||[]}},dequeue:function(a,b){b=b||"fx";var c=f.queue(a,b),d=c.shift(),e={};d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),f._data(a,b+".run",e),d.call(a,function(){f.dequeue(a,b)},e)),c.length||(f.removeData(a,b+"queue "+b+".run",!0),n(a,b,"queue"))}}),f.fn.extend({queue:function(a,c){typeof a!="string"&&(c=a,a="fx");if(c===b)return f.queue(this[0],a);return this.each(function(){var b=f.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,b){a=f.fx?f.fx.speeds[a]||a:a,b=b||"fx";return this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function m(){--h||d.resolveWith(e,[e])}typeof a!="string"&&(c=a,a=b),a=a||"fx";var d=f.Deferred(),e=this,g=e.length,h=1,i=a+"defer",j=a+"queue",k=a+"mark",l;while(g--)if(l=f.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)||f.data(e[g],k,b,!0))&&f.data(e[g],i,f.Callbacks("once memory"),!0))h++,l.add(m);m();return d.promise()}});var o=/[\n\t\r]/g,p=/\s+/,q=/\r/g,r=/^(?:button|input)$/i,s=/^(?:button|input|object|select|textarea)$/i,t=/^a(?:rea)?$/i,u=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,v=f.support.getSetAttribute,w,x,y;f.fn.extend({attr:function(a,b){return f.access(this,a,b,!0,f.attr)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,a,b,!0,f.prop)},removeProp:function(a){a=f.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,g,h,i;if(f.isFunction(a))return this.each(function(b){f(this).addClass(a.call(this,b,this.className))});if(a&&typeof a=="string"){b=a.split(p);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1)if(!e.className&&b.length===1)e.className=a;else{g=" "+e.className+" ";for(h=0,i=b.length;h<i;h++)~g.indexOf(" "+b[h]+" ")||(g+=b[h]+" ");e.className=f.trim(g)}}}return this},removeClass:function(a){var c,d,e,g,h,i,j;if(f.isFunction(a))return this.each(function(b){f(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a=="string"||a===b){c=(a||"").split(p);for(d=0,e=this.length;d<e;d++){g=this[d];if(g.nodeType===1&&g.className)if(a){h=(" "+g.className+" ").replace(o," ");for(i=0,j=c.length;i<j;i++)h=h.replace(" "+c[i]+" "," ");g.className=f.trim(h)}else g.className=""}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";if(f.isFunction(a))return this.each(function(c){f(this).toggleClass(a.call(this,c,this.className,b),b)});return this.each(function(){if(c==="string"){var e,g=0,h=f(this),i=b,j=a.split(p);while(e=j[g++])i=d?i:!h.hasClass(e),h[i?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&f._data(this,"__className__",this.className),this.className=this.className||a===!1?"":f._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ",c=0,d=this.length;for(;c<d;c++)if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(o," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e,g=this[0];{if(!!arguments.length){e=f.isFunction(a);return this.each(function(d){var g=f(this),h;if(this.nodeType===1){e?h=a.call(this,d,g.val()):h=a,h==null?h="":typeof h=="number"?h+="":f.isArray(h)&&(h=f.map(h,function(a){return a==null?"":a+""})),c=f.valHooks[this.nodeName.toLowerCase()]||f.valHooks[this.type];if(!c||!("set"in c)||c.set(this,h,"value")===b)this.value=h}})}if(g){c=f.valHooks[g.nodeName.toLowerCase()]||f.valHooks[g.type];if(c&&"get"in c&&(d=c.get(g,"value"))!==b)return d;d=g.value;return typeof d=="string"?d.replace(q,""):d==null?"":d}}}}),f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,g=a.selectedIndex,h=[],i=a.options,j=a.type==="select-one";if(g<0)return null;c=j?g:0,d=j?g+1:i.length;for(;c<d;c++){e=i[c];if(e.selected&&(f.support.optDisabled?!e.disabled:e.getAttribute("disabled")===null)&&(!e.parentNode.disabled||!f.nodeName(e.parentNode,"optgroup"))){b=f(e).val();if(j)return b;h.push(b)}}if(j&&!h.length&&i.length)return f(i[g]).val();return h},set:function(a,b){var c=f.makeArray(b);f(a).find("option").each(function(){this.selected=f.inArray(f(this).val(),c)>=0}),c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){var g,h,i,j=a.nodeType;if(!!a&&j!==3&&j!==8&&j!==2){if(e&&c in f.attrFn)return f(a)[c](d);if(typeof a.getAttribute=="undefined")return f.prop(a,c,d);i=j!==1||!f.isXMLDoc(a),i&&(c=c.toLowerCase(),h=f.attrHooks[c]||(u.test(c)?x:w));if(d!==b){if(d===null){f.removeAttr(a,c);return}if(h&&"set"in h&&i&&(g=h.set(a,d,c))!==b)return g;a.setAttribute(c,""+d);return d}if(h&&"get"in h&&i&&(g=h.get(a,c))!==null)return g;g=a.getAttribute(c);return g===null?b:g}},removeAttr:function(a,b){var c,d,e,g,h=0;if(b&&a.nodeType===1){d=b.toLowerCase().split(p),g=d.length;for(;h<g;h++)e=d[h],e&&(c=f.propFix[e]||e,f.attr(a,e,""),a.removeAttribute(v?e:c),u.test(e)&&c in a&&(a[c]=!1))}},attrHooks:{type:{set:function(a,b){if(r.test(a.nodeName)&&a.parentNode)f.error("type property can't be changed");else if(!f.support.radioValue&&b==="radio"&&f.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b),c&&(a.value=c);return b}}},value:{get:function(a,b){if(w&&f.nodeName(a,"button"))return w.get(a,b);return b in a?a.value:null},set:function(a,b,c){if(w&&f.nodeName(a,"button"))return w.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,g,h,i=a.nodeType;if(!!a&&i!==3&&i!==8&&i!==2){h=i!==1||!f.isXMLDoc(a),h&&(c=f.propFix[c]||c,g=f.propHooks[c]);return d!==b?g&&"set"in g&&(e=g.set(a,d,c))!==b?e:a[c]=d:g&&"get"in g&&(e=g.get(a,c))!==null?e:a[c]}},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):s.test(a.nodeName)||t.test(a.nodeName)&&a.href?0:b}}}}),f.attrHooks.tabindex=f.propHooks.tabIndex,x={get:function(a,c){var d,e=f.prop(a,c);return e===!0||typeof e!="boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;b===!1?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase()));return c}},v||(y={name:!0,id:!0},w=f.valHooks.button={get:function(a,c){var d;d=a.getAttributeNode(c);return d&&(y[c]?d.nodeValue!=="":d.specified)?d.nodeValue:b},set:function(a,b,d){var e=a.getAttributeNode(d);e||(e=c.createAttribute(d),a.setAttributeNode(e));return e.nodeValue=b+""}},f.attrHooks.tabindex.set=w.set,f.each(["width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,c){if(c===""){a.setAttribute(b,"auto");return c}}})}),f.attrHooks.contenteditable={get:w.get,set:function(a,b,c){b===""&&(b="false"),w.set(a,b,c)}}),f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex);return null}})),f.support.enctype||(f.propFix.enctype="encoding"),f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,b){if(f.isArray(b))return a.checked=f.inArray(f(a).val(),b)>=0}})});var z=/^(?:textarea|input|select)$/i,A=/^([^\.]*)?(?:\.(.+))?$/,B=/\bhover(\.\S+)?\b/,C=/^key/,D=/^(?:mouse|contextmenu)|click/,E=/^(?:focusinfocus|focusoutblur)$/,F=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,G=function(a){var b=F.exec(a);
b&&(b[1]=(b[1]||"").toLowerCase(),b[3]=b[3]&&new RegExp("(?:^|\\s)"+b[3]+"(?:\\s|$)"));return b},H=function(a,b){var c=a.attributes||{};return(!b[1]||a.nodeName.toLowerCase()===b[1])&&(!b[2]||(c.id||{}).value===b[2])&&(!b[3]||b[3].test((c["class"]||{}).value))},I=function(a){return f.event.special.hover?a:a.replace(B,"mouseenter$1 mouseleave$1")};f.event={add:function(a,c,d,e,g){var h,i,j,k,l,m,n,o,p,q,r,s;if(!(a.nodeType===3||a.nodeType===8||!c||!d||!(h=f._data(a)))){d.handler&&(p=d,d=p.handler),d.guid||(d.guid=f.guid++),j=h.events,j||(h.events=j={}),i=h.handle,i||(h.handle=i=function(a){return typeof f!="undefined"&&(!a||f.event.triggered!==a.type)?f.event.dispatch.apply(i.elem,arguments):b},i.elem=a),c=f.trim(I(c)).split(" ");for(k=0;k<c.length;k++){l=A.exec(c[k])||[],m=l[1],n=(l[2]||"").split(".").sort(),s=f.event.special[m]||{},m=(g?s.delegateType:s.bindType)||m,s=f.event.special[m]||{},o=f.extend({type:m,origType:l[1],data:e,handler:d,guid:d.guid,selector:g,quick:G(g),namespace:n.join(".")},p),r=j[m];if(!r){r=j[m]=[],r.delegateCount=0;if(!s.setup||s.setup.call(a,e,n,i)===!1)a.addEventListener?a.addEventListener(m,i,!1):a.attachEvent&&a.attachEvent("on"+m,i)}s.add&&(s.add.call(a,o),o.handler.guid||(o.handler.guid=d.guid)),g?r.splice(r.delegateCount++,0,o):r.push(o),f.event.global[m]=!0}a=null}},global:{},remove:function(a,b,c,d,e){var g=f.hasData(a)&&f._data(a),h,i,j,k,l,m,n,o,p,q,r,s;if(!!g&&!!(o=g.events)){b=f.trim(I(b||"")).split(" ");for(h=0;h<b.length;h++){i=A.exec(b[h])||[],j=k=i[1],l=i[2];if(!j){for(j in o)f.event.remove(a,j+b[h],c,d,!0);continue}p=f.event.special[j]||{},j=(d?p.delegateType:p.bindType)||j,r=o[j]||[],m=r.length,l=l?new RegExp("(^|\\.)"+l.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(n=0;n<r.length;n++)s=r[n],(e||k===s.origType)&&(!c||c.guid===s.guid)&&(!l||l.test(s.namespace))&&(!d||d===s.selector||d==="**"&&s.selector)&&(r.splice(n--,1),s.selector&&r.delegateCount--,p.remove&&p.remove.call(a,s));r.length===0&&m!==r.length&&((!p.teardown||p.teardown.call(a,l)===!1)&&f.removeEvent(a,j,g.handle),delete o[j])}f.isEmptyObject(o)&&(q=g.handle,q&&(q.elem=null),f.removeData(a,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){if(!e||e.nodeType!==3&&e.nodeType!==8){var h=c.type||c,i=[],j,k,l,m,n,o,p,q,r,s;if(E.test(h+f.event.triggered))return;h.indexOf("!")>=0&&(h=h.slice(0,-1),k=!0),h.indexOf(".")>=0&&(i=h.split("."),h=i.shift(),i.sort());if((!e||f.event.customEvent[h])&&!f.event.global[h])return;c=typeof c=="object"?c[f.expando]?c:new f.Event(h,c):new f.Event(h),c.type=h,c.isTrigger=!0,c.exclusive=k,c.namespace=i.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,o=h.indexOf(":")<0?"on"+h:"";if(!e){j=f.cache;for(l in j)j[l].events&&j[l].events[h]&&f.event.trigger(c,d,j[l].handle.elem,!0);return}c.result=b,c.target||(c.target=e),d=d!=null?f.makeArray(d):[],d.unshift(c),p=f.event.special[h]||{};if(p.trigger&&p.trigger.apply(e,d)===!1)return;r=[[e,p.bindType||h]];if(!g&&!p.noBubble&&!f.isWindow(e)){s=p.delegateType||h,m=E.test(s+h)?e:e.parentNode,n=null;for(;m;m=m.parentNode)r.push([m,s]),n=m;n&&n===e.ownerDocument&&r.push([n.defaultView||n.parentWindow||a,s])}for(l=0;l<r.length&&!c.isPropagationStopped();l++)m=r[l][0],c.type=r[l][1],q=(f._data(m,"events")||{})[c.type]&&f._data(m,"handle"),q&&q.apply(m,d),q=o&&m[o],q&&f.acceptData(m)&&q.apply(m,d)===!1&&c.preventDefault();c.type=h,!g&&!c.isDefaultPrevented()&&(!p._default||p._default.apply(e.ownerDocument,d)===!1)&&(h!=="click"||!f.nodeName(e,"a"))&&f.acceptData(e)&&o&&e[h]&&(h!=="focus"&&h!=="blur"||c.target.offsetWidth!==0)&&!f.isWindow(e)&&(n=e[o],n&&(e[o]=null),f.event.triggered=h,e[h](),f.event.triggered=b,n&&(e[o]=n));return c.result}},dispatch:function(c){c=f.event.fix(c||a.event);var d=(f._data(this,"events")||{})[c.type]||[],e=d.delegateCount,g=[].slice.call(arguments,0),h=!c.exclusive&&!c.namespace,i=[],j,k,l,m,n,o,p,q,r,s,t;g[0]=c,c.delegateTarget=this;if(e&&!c.target.disabled&&(!c.button||c.type!=="click")){m=f(this),m.context=this.ownerDocument||this;for(l=c.target;l!=this;l=l.parentNode||this){o={},q=[],m[0]=l;for(j=0;j<e;j++)r=d[j],s=r.selector,o[s]===b&&(o[s]=r.quick?H(l,r.quick):m.is(s)),o[s]&&q.push(r);q.length&&i.push({elem:l,matches:q})}}d.length>e&&i.push({elem:this,matches:d.slice(e)});for(j=0;j<i.length&&!c.isPropagationStopped();j++){p=i[j],c.currentTarget=p.elem;for(k=0;k<p.matches.length&&!c.isImmediatePropagationStopped();k++){r=p.matches[k];if(h||!c.namespace&&!r.namespace||c.namespace_re&&c.namespace_re.test(r.namespace))c.data=r.data,c.handleObj=r,n=((f.event.special[r.origType]||{}).handle||r.handler).apply(p.elem,g),n!==b&&(c.result=n,n===!1&&(c.preventDefault(),c.stopPropagation()))}}return c.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,d){var e,f,g,h=d.button,i=d.fromElement;a.pageX==null&&d.clientX!=null&&(e=a.target.ownerDocument||c,f=e.documentElement,g=e.body,a.pageX=d.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=d.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?d.toElement:i),!a.which&&h!==b&&(a.which=h&1?1:h&2?3:h&4?2:0);return a}},fix:function(a){if(a[f.expando])return a;var d,e,g=a,h=f.event.fixHooks[a.type]||{},i=h.props?this.props.concat(h.props):this.props;a=f.Event(g);for(d=i.length;d;)e=i[--d],a[e]=g[e];a.target||(a.target=g.srcElement||c),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey===b&&(a.metaKey=a.ctrlKey);return h.filter?h.filter(a,g):a},special:{ready:{setup:f.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=f.extend(new f.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?f.event.trigger(e,null,b):f.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},f.event.handle=f.event.dispatch,f.removeEvent=c.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},f.Event=function(a,b){if(!(this instanceof f.Event))return new f.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?K:J):this.type=a,b&&f.extend(this,b),this.timeStamp=a&&a.timeStamp||f.now(),this[f.expando]=!0},f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=K;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=K;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=K,this.stopPropagation()},isDefaultPrevented:J,isPropagationStopped:J,isImmediatePropagationStopped:J},f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c=this,d=a.relatedTarget,e=a.handleObj,g=e.selector,h;if(!d||d!==c&&!f.contains(c,d))a.type=e.origType,h=e.handler.apply(this,arguments),a.type=b;return h}}}),f.support.submitBubbles||(f.event.special.submit={setup:function(){if(f.nodeName(this,"form"))return!1;f.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=f.nodeName(c,"input")||f.nodeName(c,"button")?c.form:b;d&&!d._submit_attached&&(f.event.add(d,"submit._submit",function(a){this.parentNode&&!a.isTrigger&&f.event.simulate("submit",this.parentNode,a,!0)}),d._submit_attached=!0)})},teardown:function(){if(f.nodeName(this,"form"))return!1;f.event.remove(this,"._submit")}}),f.support.changeBubbles||(f.event.special.change={setup:function(){if(z.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")f.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),f.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1,f.event.simulate("change",this,a,!0))});return!1}f.event.add(this,"beforeactivate._change",function(a){var b=a.target;z.test(b.nodeName)&&!b._change_attached&&(f.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&f.event.simulate("change",this.parentNode,a,!0)}),b._change_attached=!0)})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){f.event.remove(this,"._change");return z.test(this.nodeName)}}),f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},function(a,b){var d=0,e=function(a){f.event.simulate(b,a.target,f.event.fix(a),!0)};f.event.special[b]={setup:function(){d++===0&&c.addEventListener(a,e,!0)},teardown:function(){--d===0&&c.removeEventListener(a,e,!0)}}}),f.fn.extend({on:function(a,c,d,e,g){var h,i;if(typeof a=="object"){typeof c!="string"&&(d=c,c=b);for(i in a)this.on(i,c,d,a[i],g);return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c=="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1)e=J;else if(!e)return this;g===1&&(h=e,e=function(a){f().off(a);return h.apply(this,arguments)},e.guid=h.guid||(h.guid=f.guid++));return this.each(function(){f.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on.call(this,a,b,c,d,1)},off:function(a,c,d){if(a&&a.preventDefault&&a.handleObj){var e=a.handleObj;f(a.delegateTarget).off(e.namespace?e.type+"."+e.namespace:e.type,e.selector,e.handler);return this}if(typeof a=="object"){for(var g in a)this.off(g,c,a[g]);return this}if(c===!1||typeof c=="function")d=c,c=b;d===!1&&(d=J);return this.each(function(){f.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){f(this.context).on(a,this.selector,b,c);return this},die:function(a,b){f(this.context).off(a,this.selector||"**",b);return this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return f.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f._data(this,"lastToggle"+a.guid)||0)%d;f._data(this,"lastToggle"+a.guid,e+1),c.preventDefault();return b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){f.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.on(b,null,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[b]=!0),C.test(b)&&(f.event.fixHooks[b]=f.event.keyHooks),D.test(b)&&(f.event.fixHooks[b]=f.event.mouseHooks)}),function(){function x(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}if(j.nodeType===1){g||(j[d]=c,j.sizset=h);if(typeof b!="string"){if(j===b){k=!0;break}}else if(m.filter(b,[j]).length>0){k=j;break}}j=j[a]}e[h]=k}}}function w(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}j.nodeType===1&&!g&&(j[d]=c,j.sizset=h);if(j.nodeName.toLowerCase()===b){k=j;break}j=j[a]}e[h]=k}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d="sizcache"+(Math.random()+"").replace(".",""),e=0,g=Object.prototype.toString,h=!1,i=!0,j=/\\/g,k=/\r\n/g,l=/\W/;[0,0].sort(function(){i=!1;return 0});var m=function(b,d,e,f){e=e||[],d=d||c;var h=d;if(d.nodeType!==1&&d.nodeType!==9)return[];if(!b||typeof b!="string")return e;var i,j,k,l,n,q,r,t,u=!0,v=m.isXML(d),w=[],x=b;do{a.exec(""),i=a.exec(x);if(i){x=i[3],w.push(i[1]);if(i[2]){l=i[3];break}}}while(i);if(w.length>1&&p.exec(b))if(w.length===2&&o.relative[w[0]])j=y(w[0]+w[1],d,f);else{j=o.relative[w[0]]?[d]:m(w.shift(),d);while(w.length)b=w.shift(),o.relative[b]&&(b+=w.shift()),j=y(b,j,f)}else{!f&&w.length>1&&d.nodeType===9&&!v&&o.match.ID.test(w[0])&&!o.match.ID.test(w[w.length-1])&&(n=m.find(w.shift(),d,v),d=n.expr?m.filter(n.expr,n.set)[0]:n.set[0]);if(d){n=f?{expr:w.pop(),set:s(f)}:m.find(w.pop(),w.length===1&&(w[0]==="~"||w[0]==="+")&&d.parentNode?d.parentNode:d,v),j=n.expr?m.filter(n.expr,n.set):n.set,w.length>0?k=s(j):u=!1;while(w.length)q=w.pop(),r=q,o.relative[q]?r=w.pop():q="",r==null&&(r=d),o.relative[q](k,r,v)}else k=w=[]}k||(k=j),k||m.error(q||b);if(g.call(k)==="[object Array]")if(!u)e.push.apply(e,k);else if(d&&d.nodeType===1)for(t=0;k[t]!=null;t++)k[t]&&(k[t]===!0||k[t].nodeType===1&&m.contains(d,k[t]))&&e.push(j[t]);else for(t=0;k[t]!=null;t++)k[t]&&k[t].nodeType===1&&e.push(j[t]);else s(k,e);l&&(m(l,h,e,f),m.uniqueSort(e));return e};m.uniqueSort=function(a){if(u){h=i,a.sort(u);if(h)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},m.matches=function(a,b){return m(a,null,null,b)},m.matchesSelector=function(a,b){return m(b,null,null,[a]).length>0},m.find=function(a,b,c){var d,e,f,g,h,i;if(!a)return[];for(e=0,f=o.order.length;e<f;e++){h=o.order[e];if(g=o.leftMatch[h].exec(a)){i=g[1],g.splice(1,1);if(i.substr(i.length-1)!=="\\"){g[1]=(g[1]||"").replace(j,""),d=o.find[h](g,b,c);if(d!=null){a=a.replace(o.match[h],"");break}}}}d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}},m.filter=function(a,c,d,e){var f,g,h,i,j,k,l,n,p,q=a,r=[],s=c,t=c&&c[0]&&m.isXML(c[0]);while(a&&c.length){for(h in o.filter)if((f=o.leftMatch[h].exec(a))!=null&&f[2]){k=o.filter[h],l=f[1],g=!1,f.splice(1,1);if(l.substr(l.length-1)==="\\")continue;s===r&&(r=[]);if(o.preFilter[h]){f=o.preFilter[h](f,s,d,r,e,t);if(!f)g=i=!0;else if(f===!0)continue}if(f)for(n=0;(j=s[n])!=null;n++)j&&(i=k(j,f,n,s),p=e^i,d&&i!=null?p?g=!0:s[n]=!1:p&&(r.push(j),g=!0));if(i!==b){d||(s=r),a=a.replace(o.match[h],"");if(!g)return[];break}}if(a===q)if(g==null)m.error(a);else break;q=a}return s},m.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)};var n=m.getText=function(a){var b,c,d=a.nodeType,e="";if(d){if(d===1||d===9){if(typeof a.textContent=="string")return a.textContent;if(typeof a.innerText=="string")return a.innerText.replace(k,"");for(a=a.firstChild;a;a=a.nextSibling)e+=n(a)}else if(d===3||d===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(e+=n(c));return e},o=m.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!l.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&m.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!l.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&m.filter(b,a,!0)}},"":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("parentNode",b,f,a,d,c)},"~":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("previousSibling",b,f,a,d,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(j,"")+" ";if(f)return a;for(var g=0,h;(h=b[g])!=null;g++)h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(j,"")},TAG:function(a,b){return a[1].replace(j,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||m.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&m.error(a[0]);a[0]=e++;return a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(j,"");!f&&o.attrMap[g]&&(a[1]=o.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(j,""),a[2]==="~="&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not")if((a.exec(b[3])||"").length>1||/^\w/.test(b[3]))b[3]=m(b[3],null,null,c);else{var g=m.filter(b[3],c,d,!0^f);d||e.push.apply(e,g);return!1}else if(o.match.POS.test(b[0])||o.match.CHILD.test(b[0]))return!0;return b},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!m(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=o.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||n([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}m.error(e)},CHILD:function(a,b){var c,e,f,g,h,i,j,k=b[1],l=a;switch(k){case"only":case"first":while(l=l.previousSibling)if(l.nodeType===1)return!1;if(k==="first")return!0;l=a;case"last":while(l=l.nextSibling)if(l.nodeType===1)return!1;return!0;case"nth":c=b[2],e=b[3];if(c===1&&e===0)return!0;f=b[0],g=a.parentNode;if(g&&(g[d]!==f||!a.nodeIndex)){i=0;for(l=g.firstChild;l;l=l.nextSibling)l.nodeType===1&&(l.nodeIndex=++i);g[d]=f}j=a.nodeIndex-e;return c===0?j===0:j%c===0&&j/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=m.attr?m.attr(a,c):o.attrHandle[c]?o.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":!f&&m.attr?d!=null:f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=o.setFilters[e];if(f)return f(a,c,b,d)}}},p=o.match.POS,q=function(a,b){return"\\"+(b-0+1)};for(var r in o.match)o.match[r]=new RegExp(o.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source),o.leftMatch[r]=new RegExp(/(^(?:.|\r|\n)*?)/.source+o.match[r].source.replace(/\\(\d+)/g,q));var s=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].nodeType}catch(t){s=function(a,b){var c=0,d=b||[];if(g.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length=="number")for(var e=a.length;c<e;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var u,v;c.documentElement.compareDocumentPosition?u=function(a,b){if(a===b){h=!0;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1}:(u=function(a,b){if(a===b){h=!0;return 0}if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,i=b.parentNode,j=g;if(g===i)return v(a,b);if(!g)return-1;if(!i)return 1;while(j)e.unshift(j),j=j.parentNode;j=i;while(j)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++)if(e[k]!==f[k])return v(e[k],f[k]);return k===c?v(a,f[k],-1):v(e[k],b,1)},v=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),function(){var a=c.createElement("div"),d="script"+(new Date).getTime(),e=c.documentElement;a.innerHTML="<a name='"+d+"'/>",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(o.find.ID=function(a,c,d){if(typeof c.getElementById!="undefined"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},o.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),e.removeChild(a),e=a=null}(),function(){var a=c.createElement("div");a.appendChild(c.createComment("")),a.getElementsByTagName("*").length>0&&(o.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(o.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),c.querySelectorAll&&function(){var a=m,b=c.createElement("div"),d="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").length!==0){m=function(b,e,f,g){e=e||c;if(!g&&!m.isXML(e)){var h=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(h&&(e.nodeType===1||e.nodeType===9)){if(h[1])return s(e.getElementsByTagName(b),f);if(h[2]&&o.find.CLASS&&e.getElementsByClassName)return s(e.getElementsByClassName(h[2]),f)}if(e.nodeType===9){if(b==="body"&&e.body)return s([e.body],f);if(h&&h[3]){var i=e.getElementById(h[3]);if(!i||!i.parentNode)return s([],f);if(i.id===h[3])return s([i],f)}try{return s(e.querySelectorAll(b),f)}catch(j){}}else if(e.nodeType===1&&e.nodeName.toLowerCase()!=="object"){var k=e,l=e.getAttribute("id"),n=l||d,p=e.parentNode,q=/^\s*[+~]/.test(b);l?n=n.replace(/'/g,"\\$&"):e.setAttribute("id",n),q&&p&&(e=e.parentNode);try{if(!q||p)return s(e.querySelectorAll("[id='"+n+"'] "+b),f)}catch(r){}finally{l||k.removeAttribute("id")}}}return a(b,e,f,g)};for(var e in a)m[e]=a[e];b=null}}(),function(){var a=c.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var d=!b.call(c.createElement("div"),"div"),e=!1;try{b.call(c.documentElement,"[test!='']:sizzle")}catch(f){e=!0}m.matchesSelector=function(a,c){c=c.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!m.isXML(a))try{if(e||!o.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&a.document.nodeType!==11)return f}}catch(g){}return m(c,null,null,[a]).length>0}}}(),function(){var a=c.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!!a.getElementsByClassName&&a.getElementsByClassName("e").length!==0){a.lastChild.className="e";if(a.getElementsByClassName("e").length===1)return;o.order.splice(1,0,"CLASS"),o.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}}(),c.documentElement.contains?m.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocumentPosition?m.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:m.contains=function(){return!1},m.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var y=function(a,b,c){var d,e=[],f="",g=b.nodeType?[b]:b;while(d=o.match.PSEUDO.exec(a))f+=d[0],a=a.replace(o.match.PSEUDO,"");a=o.relative[a]?a+"*":a;for(var h=0,i=g.length;h<i;h++)m(a,g[h],e,c);return m.filter(f,e)};m.attr=f.attr,m.selectors.attrMap={},f.find=m,f.expr=m.selectors,f.expr[":"]=f.expr.filters,f.unique=m.uniqueSort,f.text=m.getText,f.isXMLDoc=m.isXML,f.contains=m.contains}();var L=/Until$/,M=/^(?:parents|prevUntil|prevAll)/,N=/,/,O=/^.[^:#\[\.,]*$/,P=Array.prototype.slice,Q=f.expr.match.POS,R={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b=this,c,d;if(typeof a!="string")return f(a).filter(function(){for(c=0,d=b.length;c<d;c++)if(f.contains(b[c],this))return!0});var e=this.pushStack("","find",a),g,h,i;for(c=0,d=this.length;c<d;c++){g=e.length,f.find(a,this[c],e);if(c>0)for(h=g;h<e.length;h++)for(i=0;i<g;i++)if(e[i]===e[h]){e.splice(h--,1);break}}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(f.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(T(this,a,!1),"not",a)},filter:function(a){return this.pushStack(T(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?Q.test(a)?f(a,this.context).index(this[0])>=0:f.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,e,g=this[0];if(f.isArray(a)){var h=1;while(g&&g.ownerDocument&&g!==b){for(d=0;d<a.length;d++)f(g).is(a[d])&&c.push({selector:a[d],elem:g,level:h});g=g.parentNode,h++}return c}var i=Q.test(a)||typeof a!="string"?f(a,b||this.context):0;for(d=0,e=this.length;d<e;d++){g=this[d];while(g){if(i?i.index(g)>-1:f.find.matchesSelector(g,a)){c.push(g);break}g=g.parentNode;if(!g||!g.ownerDocument||g===b||g.nodeType===11)break}}c=c.length>1?f.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){if(!a)return this[0]&&this[0].parentNode?this.prevAll().length:-1;if(typeof a=="string")return f.inArray(this[0],f(a));return f.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a=="string"?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(S(c[0])||S(d[0])?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),f.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,2,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling(a.parentNode.firstChild,a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,b){f.fn[a]=function(c,d){var e=f.map(this,b,c);L.test(a)||(d=c),d&&typeof d=="string"&&(e=f.filter(d,e)),e=this.length>1&&!R[a]?f.unique(e):e,(this.length>1||N.test(d))&&M.test(a)&&(e=e.reverse());return this.pushStack(e,a,P.call(arguments).join(","))}}),f.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return b.length===1?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){var e=[],g=a[c];while(g&&g.nodeType!==9&&(d===b||g.nodeType!==1||!f(g).is(d)))g.nodeType===1&&e.push(g),g=g[c];return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var V="abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",W=/ jQuery\d+="(?:\d+|null)"/g,X=/^\s+/,Y=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Z=/<([\w:]+)/,$=/<tbody/i,_=/<|&#?\w+;/,ba=/<(?:script|style)/i,bb=/<(?:script|object|embed|option|style)/i,bc=new RegExp("<(?:"+V+")","i"),bd=/checked\s*(?:[^=]|=\s*.checked.)/i,be=/\/(java|ecma)script/i,bf=/^\s*<!(?:\[CDATA\[|\-\-)/,bg={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bh=U(c);bg.optgroup=bg.option,bg.tbody=bg.tfoot=bg.colgroup=bg.caption=bg.thead,bg.th=bg.td,f.support.htmlSerialize||(bg._default=[1,"div<div>","</div>"]),f.fn.extend({text:function(a){if(f.isFunction(a))return this.each(function(b){var c=f(this);c.text(a.call(this,b,c.text()))});if(typeof a!="object"&&a!==b)return this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a));return f.text(this)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapAll(a.call(this,b))});if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapInner(a.call(this,b))});return this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=f.isFunction(a);return this.each(function(c){f(this).wrapAll(b?a.call(this,c):a)
})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=f.clean(arguments);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,f.clean(arguments));return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||f.filter(a,[d]).length)!b&&d.nodeType===1&&(f.cleanData(d.getElementsByTagName("*")),f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&f.cleanData(b.getElementsByTagName("*"));while(b.firstChild)b.removeChild(b.firstChild)}return this},clone:function(a,b){a=a==null?!1:a,b=b==null?a:b;return this.map(function(){return f.clone(this,a,b)})},html:function(a){if(a===b)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(W,""):null;if(typeof a=="string"&&!ba.test(a)&&(f.support.leadingWhitespace||!X.test(a))&&!bg[(Z.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Y,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++)this[c].nodeType===1&&(f.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a)}catch(e){this.empty().append(a)}}else f.isFunction(a)?this.each(function(b){var c=f(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a))return this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))});typeof a!="string"&&(a=f(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove(),b?f(b).before(a):f(c).append(a)})}return this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,g,h,i,j=a[0],k=[];if(!f.support.checkClone&&arguments.length===3&&typeof j=="string"&&bd.test(j))return this.each(function(){f(this).domManip(a,c,d,!0)});if(f.isFunction(j))return this.each(function(e){var g=f(this);a[0]=j.call(this,e,c?g.html():b),g.domManip(a,c,d)});if(this[0]){i=j&&j.parentNode,f.support.parentNode&&i&&i.nodeType===11&&i.childNodes.length===this.length?e={fragment:i}:e=f.buildFragment(a,this,k),h=e.fragment,h.childNodes.length===1?g=h=h.firstChild:g=h.firstChild;if(g){c=c&&f.nodeName(g,"tr");for(var l=0,m=this.length,n=m-1;l<m;l++)d.call(c?bi(this[l],g):this[l],e.cacheable||m>1&&l<n?f.clone(h,!0,!0):h)}k.length&&f.each(k,bp)}return this}}),f.buildFragment=function(a,b,d){var e,g,h,i,j=a[0];b&&b[0]&&(i=b[0].ownerDocument||b[0]),i.createDocumentFragment||(i=c),a.length===1&&typeof j=="string"&&j.length<512&&i===c&&j.charAt(0)==="<"&&!bb.test(j)&&(f.support.checkClone||!bd.test(j))&&(f.support.html5Clone||!bc.test(j))&&(g=!0,h=f.fragments[j],h&&h!==1&&(e=h)),e||(e=i.createDocumentFragment(),f.clean(a,i,e,d)),g&&(f.fragments[j]=h?e:1);return{fragment:e,cacheable:g}},f.fragments={},f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d=[],e=f(c),g=this.length===1&&this[0].parentNode;if(g&&g.nodeType===11&&g.childNodes.length===1&&e.length===1){e[b](this[0]);return this}for(var h=0,i=e.length;h<i;h++){var j=(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=d.concat(j)}return this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var d,e,g,h=f.support.html5Clone||!bc.test("<"+a.nodeName)?a.cloneNode(!0):bo(a);if((!f.support.noCloneEvent||!f.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!f.isXMLDoc(a)){bk(a,h),d=bl(a),e=bl(h);for(g=0;d[g];++g)e[g]&&bk(d[g],e[g])}if(b){bj(a,h);if(c){d=bl(a),e=bl(h);for(g=0;d[g];++g)bj(d[g],e[g])}}d=e=null;return h},clean:function(a,b,d,e){var g;b=b||c,typeof b.createElement=="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||c);var h=[],i;for(var j=0,k;(k=a[j])!=null;j++){typeof k=="number"&&(k+="");if(!k)continue;if(typeof k=="string")if(!_.test(k))k=b.createTextNode(k);else{k=k.replace(Y,"<$1></$2>");var l=(Z.exec(k)||["",""])[1].toLowerCase(),m=bg[l]||bg._default,n=m[0],o=b.createElement("div");b===c?bh.appendChild(o):U(b).appendChild(o),o.innerHTML=m[1]+k+m[2];while(n--)o=o.lastChild;if(!f.support.tbody){var p=$.test(k),q=l==="table"&&!p?o.firstChild&&o.firstChild.childNodes:m[1]==="<table>"&&!p?o.childNodes:[];for(i=q.length-1;i>=0;--i)f.nodeName(q[i],"tbody")&&!q[i].childNodes.length&&q[i].parentNode.removeChild(q[i])}!f.support.leadingWhitespace&&X.test(k)&&o.insertBefore(b.createTextNode(X.exec(k)[0]),o.firstChild),k=o.childNodes}var r;if(!f.support.appendChecked)if(k[0]&&typeof(r=k.length)=="number")for(i=0;i<r;i++)bn(k[i]);else bn(k);k.nodeType?h.push(k):h=f.merge(h,k)}if(d){g=function(a){return!a.type||be.test(a.type)};for(j=0;h[j];j++)if(e&&f.nodeName(h[j],"script")&&(!h[j].type||h[j].type.toLowerCase()==="text/javascript"))e.push(h[j].parentNode?h[j].parentNode.removeChild(h[j]):h[j]);else{if(h[j].nodeType===1){var s=f.grep(h[j].getElementsByTagName("script"),g);h.splice.apply(h,[j+1,0].concat(s))}d.appendChild(h[j])}}return h},cleanData:function(a){var b,c,d=f.cache,e=f.event.special,g=f.support.deleteExpando;for(var h=0,i;(i=a[h])!=null;h++){if(i.nodeName&&f.noData[i.nodeName.toLowerCase()])continue;c=i[f.expando];if(c){b=d[c];if(b&&b.events){for(var j in b.events)e[j]?f.event.remove(i,j):f.removeEvent(i,j,b.handle);b.handle&&(b.handle.elem=null)}g?delete i[f.expando]:i.removeAttribute&&i.removeAttribute(f.expando),delete d[c]}}}});var bq=/alpha\([^)]*\)/i,br=/opacity=([^)]*)/,bs=/([A-Z]|^ms)/g,bt=/^-?\d+(?:px)?$/i,bu=/^-?\d/,bv=/^([\-+])=([\-+.\de]+)/,bw={position:"absolute",visibility:"hidden",display:"block"},bx=["Left","Right"],by=["Top","Bottom"],bz,bA,bB;f.fn.css=function(a,c){if(arguments.length===2&&c===b)return this;return f.access(this,a,c,!0,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)})},f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bz(a,"opacity","opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!!a&&a.nodeType!==3&&a.nodeType!==8&&!!a.style){var g,h,i=f.camelCase(c),j=a.style,k=f.cssHooks[i];c=f.cssProps[i]||i;if(d===b){if(k&&"get"in k&&(g=k.get(a,!1,e))!==b)return g;return j[c]}h=typeof d,h==="string"&&(g=bv.exec(d))&&(d=+(g[1]+1)*+g[2]+parseFloat(f.css(a,c)),h="number");if(d==null||h==="number"&&isNaN(d))return;h==="number"&&!f.cssNumber[i]&&(d+="px");if(!k||!("set"in k)||(d=k.set(a,d))!==b)try{j[c]=d}catch(l){}}},css:function(a,c,d){var e,g;c=f.camelCase(c),g=f.cssHooks[c],c=f.cssProps[c]||c,c==="cssFloat"&&(c="float");if(g&&"get"in g&&(e=g.get(a,!0,d))!==b)return e;if(bz)return bz(a,c)},swap:function(a,b,c){var d={};for(var e in b)d[e]=a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=d[e]}}),f.curCSS=f.css,f.each(["height","width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){var e;if(c){if(a.offsetWidth!==0)return bC(a,b,d);f.swap(a,bw,function(){e=bC(a,b,d)});return e}},set:function(a,b){if(!bt.test(b))return b;b=parseFloat(b);if(b>=0)return b+"px"}}}),f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return br.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=f.isNumeric(b)?"alpha(opacity="+b*100+")":"",g=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&f.trim(g.replace(bq,""))===""){c.removeAttribute("filter");if(d&&!d.filter)return}c.filter=bq.test(g)?g.replace(bq,e):g+" "+e}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){var c;f.swap(a,{display:"inline-block"},function(){b?c=bz(a,"margin-right","marginRight"):c=a.style.marginRight});return c}})}),c.defaultView&&c.defaultView.getComputedStyle&&(bA=function(a,b){var c,d,e;b=b.replace(bs,"-$1").toLowerCase(),(d=a.ownerDocument.defaultView)&&(e=d.getComputedStyle(a,null))&&(c=e.getPropertyValue(b),c===""&&!f.contains(a.ownerDocument.documentElement,a)&&(c=f.style(a,b)));return c}),c.documentElement.currentStyle&&(bB=function(a,b){var c,d,e,f=a.currentStyle&&a.currentStyle[b],g=a.style;f===null&&g&&(e=g[b])&&(f=e),!bt.test(f)&&bu.test(f)&&(c=g.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),g.left=b==="fontSize"?"1em":f||0,f=g.pixelLeft+"px",g.left=c,d&&(a.runtimeStyle.left=d));return f===""?"auto":f}),bz=bA||bB,f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return b===0&&c===0||!f.support.reliableHiddenOffsets&&(a.style&&a.style.display||f.css(a,"display"))==="none"},f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)});var bD=/%20/g,bE=/\[\]$/,bF=/\r?\n/g,bG=/#.*$/,bH=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,bI=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bJ=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,bK=/^(?:GET|HEAD)$/,bL=/^\/\//,bM=/\?/,bN=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bO=/^(?:select|textarea)/i,bP=/\s+/,bQ=/([?&])_=[^&]*/,bR=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bS=f.fn.load,bT={},bU={},bV,bW,bX=["*/"]+["*"];try{bV=e.href}catch(bY){bV=c.createElement("a"),bV.href="",bV=bV.href}bW=bR.exec(bV.toLowerCase())||[],f.fn.extend({load:function(a,c,d){if(typeof a!="string"&&bS)return bS.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var g=a.slice(e,a.length);a=a.slice(0,e)}var h="GET";c&&(f.isFunction(c)?(d=c,c=b):typeof c=="object"&&(c=f.param(c,f.ajaxSettings.traditional),h="POST"));var i=this;f.ajax({url:a,type:h,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),i.html(g?f("<div>").append(c.replace(bN,"")).find(g):c)),d&&i.each(d,[c,b,a])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bO.test(this.nodeName)||bI.test(this.type))}).map(function(a,b){var c=f(this).val();return c==null?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,value:a.replace(bF,"\r\n")}}):{name:b.name,value:c.replace(bF,"\r\n")}}).get()}}),f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.on(b,a)}}),f.each(["get","post"],function(a,c){f[c]=function(a,d,e,g){f.isFunction(d)&&(g=g||e,e=d,d=b);return f.ajax({type:c,url:a,data:d,success:e,dataType:g})}}),f.extend({getScript:function(a,c){return f.get(a,b,c,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){b?b_(a,f.ajaxSettings):(b=a,a=f.ajaxSettings),b_(a,b);return a},ajaxSettings:{url:bV,isLocal:bJ.test(bW[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":bX},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:bZ(bT),ajaxTransport:bZ(bU),ajax:function(a,c){function w(a,c,l,m){if(s!==2){s=2,q&&clearTimeout(q),p=b,n=m||"",v.readyState=a>0?4:0;var o,r,u,w=c,x=l?cb(d,v,l):b,y,z;if(a>=200&&a<300||a===304){if(d.ifModified){if(y=v.getResponseHeader("Last-Modified"))f.lastModified[k]=y;if(z=v.getResponseHeader("Etag"))f.etag[k]=z}if(a===304)w="notmodified",o=!0;else try{r=cc(d,x),w="success",o=!0}catch(A){w="parsererror",u=A}}else{u=w;if(!w||a)w="error",a<0&&(a=0)}v.status=a,v.statusText=""+(c||w),o?h.resolveWith(e,[r,w,v]):h.rejectWith(e,[v,w,u]),v.statusCode(j),j=b,t&&g.trigger("ajax"+(o?"Success":"Error"),[v,d,o?r:u]),i.fireWith(e,[v,w]),t&&(g.trigger("ajaxComplete",[v,d]),--f.active||f.event.trigger("ajaxStop"))}}typeof a=="object"&&(c=a,a=b),c=c||{};var d=f.ajaxSetup({},c),e=d.context||d,g=e!==d&&(e.nodeType||e instanceof f)?f(e):f.event,h=f.Deferred(),i=f.Callbacks("once memory"),j=d.statusCode||{},k,l={},m={},n,o,p,q,r,s=0,t,u,v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},getAllResponseHeaders:function(){return s===2?n:null},getResponseHeader:function(a){var c;if(s===2){if(!o){o={};while(c=bH.exec(n))o[c[1].toLowerCase()]=c[2]}c=o[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){s||(d.mimeType=a);return this},abort:function(a){a=a||"abort",p&&p.abort(a),w(0,a);return this}};h.promise(v),v.success=v.done,v.error=v.fail,v.complete=i.add,v.statusCode=function(a){if(a){var b;if(s<2)for(b in a)j[b]=[j[b],a[b]];else b=a[v.status],v.then(b,b)}return this},d.url=((a||d.url)+"").replace(bG,"").replace(bL,bW[1]+"//"),d.dataTypes=f.trim(d.dataType||"*").toLowerCase().split(bP),d.crossDomain==null&&(r=bR.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]==bW[1]&&r[2]==bW[2]&&(r[3]||(r[1]==="http:"?80:443))==(bW[3]||(bW[1]==="http:"?80:443)))),d.data&&d.processData&&typeof d.data!="string"&&(d.data=f.param(d.data,d.traditional)),b$(bT,d,c,v);if(s===2)return!1;t=d.global,d.type=d.type.toUpperCase(),d.hasContent=!bK.test(d.type),t&&f.active++===0&&f.event.trigger("ajaxStart");if(!d.hasContent){d.data&&(d.url+=(bM.test(d.url)?"&":"?")+d.data,delete d.data),k=d.url;if(d.cache===!1){var x=f.now(),y=d.url.replace(bQ,"$1_="+x);d.url=y+(y===d.url?(bM.test(d.url)?"&":"?")+"_="+x:"")}}(d.data&&d.hasContent&&d.contentType!==!1||c.contentType)&&v.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(k=k||d.url,f.lastModified[k]&&v.setRequestHeader("If-Modified-Since",f.lastModified[k]),f.etag[k]&&v.setRequestHeader("If-None-Match",f.etag[k])),v.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", "+bX+"; q=0.01":""):d.accepts["*"]);for(u in d.headers)v.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(e,v,d)===!1||s===2)){v.abort();return!1}for(u in{success:1,error:1,complete:1})v[u](d[u]);p=b$(bU,d,c,v);if(!p)w(-1,"No Transport");else{v.readyState=1,t&&g.trigger("ajaxSend",[v,d]),d.async&&d.timeout>0&&(q=setTimeout(function(){v.abort("timeout")},d.timeout));try{s=1,p.send(l,w)}catch(z){if(s<2)w(-1,z);else throw z}}return v},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=f.ajaxSettings.traditional);if(f.isArray(a)||a.jquery&&!f.isPlainObject(a))f.each(a,function(){e(this.name,this.value)});else for(var g in a)ca(g,a[g],c,e);return d.join("&").replace(bD,"+")}}),f.extend({active:0,lastModified:{},etag:{}});var cd=f.now(),ce=/(\=)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return f.expando+"_"+cd++}}),f.ajaxPrefilter("json jsonp",function(b,c,d){var e=b.contentType==="application/x-www-form-urlencoded"&&typeof b.data=="string";if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(ce.test(b.url)||e&&ce.test(b.data))){var g,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i=a[h],j=b.url,k=b.data,l="$1"+h+"$2";b.jsonp!==!1&&(j=j.replace(ce,l),b.url===j&&(e&&(k=k.replace(ce,l)),b.data===k&&(j+=(/\?/.test(j)?"&":"?")+b.jsonp+"="+h))),b.url=j,b.data=k,a[h]=function(a){g=[a]},d.always(function(){a[h]=i,g&&f.isFunction(i)&&a[h](g[0])}),b.converters["script json"]=function(){g||f.error(h+" was not called");return g[0]},b.dataTypes[0]="json";return"script"}}),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){f.globalEval(a);return a}}}),f.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),f.ajaxTransport("script",function(a){if(a.crossDomain){var d,e=c.head||c.getElementsByTagName("head")[0]||c.documentElement;return{send:function(f,g){d=c.createElement("script"),d.async="async",a.scriptCharset&&(d.charset=a.scriptCharset),d.src=a.url,d.onload=d.onreadystatechange=function(a,c){if(c||!d.readyState||/loaded|complete/.test(d.readyState))d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=b,c||g(200,"success")},e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var cf=a.ActiveXObject?function(){for(var a in ch)ch[a](0,1)}:!1,cg=0,ch;f.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&ci()||cj()}:ci,function(a){f.extend(f.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||f.support.cors){var d;return{send:function(e,g){var h=c.xhr(),i,j;c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields)for(j in c.xhrFields)h[j]=c.xhrFields[j];c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e)h.setRequestHeader(j,e[j])}catch(k){}h.send(c.hasContent&&c.data||null),d=function(a,e){var j,k,l,m,n;try{if(d&&(e||h.readyState===4)){d=b,i&&(h.onreadystatechange=f.noop,cf&&delete ch[i]);if(e)h.readyState!==4&&h.abort();else{j=h.status,l=h.getAllResponseHeaders(),m={},n=h.responseXML,n&&n.documentElement&&(m.xml=n),m.text=h.responseText;try{k=h.statusText}catch(o){k=""}!j&&c.isLocal&&!c.crossDomain?j=m.text?200:404:j===1223&&(j=204)}}}catch(p){e||g(-1,p)}m&&g(j,k,m,l)},!c.async||h.readyState===4?d():(i=++cg,cf&&(ch||(ch={},f(a).unload(cf)),ch[i]=d),h.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var ck={},cl,cm,cn=/^(?:toggle|show|hide)$/,co=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,cp,cq=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],cr;f.fn.extend({show:function(a,b,c){var d,e;if(a||a===0)return this.animate(cu("show",3),a,b,c);for(var g=0,h=this.length;g<h;g++)d=this[g],d.style&&(e=d.style.display,!f._data(d,"olddisplay")&&e==="none"&&(e=d.style.display=""),e===""&&f.css(d,"display")==="none"&&f._data(d,"olddisplay",cv(d.nodeName)));for(g=0;g<h;g++){d=this[g];if(d.style){e=d.style.display;if(e===""||e==="none")d.style.display=f._data(d,"olddisplay")||""}}return this},hide:function(a,b,c){if(a||a===0)return this.animate(cu("hide",3),a,b,c);var d,e,g=0,h=this.length;for(;g<h;g++)d=this[g],d.style&&(e=f.css(d,"display"),e!=="none"&&!f._data(d,"olddisplay")&&f._data(d,"olddisplay",e));for(g=0;g<h;g++)this[g].style&&(this[g].style.display="none");return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d=typeof a=="boolean";f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(cu("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){function g(){e.queue===!1&&f._mark(this);var b=f.extend({},e),c=this.nodeType===1,d=c&&f(this).is(":hidden"),g,h,i,j,k,l,m,n,o;b.animatedProperties={};for(i in a){g=f.camelCase(i),i!==g&&(a[g]=a[i],delete a[i]),h=a[g],f.isArray(h)?(b.animatedProperties[g]=h[1],h=a[g]=h[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(h==="hide"&&d||h==="show"&&!d)return b.complete.call(this);c&&(g==="height"||g==="width")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],f.css(this,"display")==="inline"&&f.css(this,"float")==="none"&&(!f.support.inlineBlockNeedsLayout||cv(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1))}b.overflow!=null&&(this.style.overflow="hidden");for(i in a)j=new f.fx(this,b,i),h=a[i],cn.test(h)?(o=f._data(this,"toggle"+i)||(h==="toggle"?d?"show":"hide":0),o?(f._data(this,"toggle"+i,o==="show"?"hide":"show"),j[o]()):j[h]()):(k=co.exec(h),l=j.cur(),k?(m=parseFloat(k[2]),n=k[3]||(f.cssNumber[i]?"":"px"),n!=="px"&&(f.style(this,i,(m||1)+n),l=(m||1)/j.cur()*l,f.style(this,i,l+n)),k[1]&&(m=(k[1]==="-="?-1:1)*m+l),j.custom(l,m,n)):j.custom(l,h,""));return!0}var e=f.speed(b,c,d);if(f.isEmptyObject(a))return this.each(e.complete,[!1]);a=f.extend({},a);return e.queue===!1?this.each(g):this.queue(e.queue,g)},stop:function(a,c,d){typeof a!="string"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]);return this.each(function(){function h(a,b,c){var e=b[c];f.removeData(a,c,!0),e.stop(d)}var b,c=!1,e=f.timers,g=f._data(this);d||f._unmark(!0,this);if(a==null)for(b in g)g[b]&&g[b].stop&&b.indexOf(".run")===b.length-4&&h(this,g,b);else g[b=a+".run"]&&g[b].stop&&h(this,g,b);for(b=e.length;b--;)e[b].elem===this&&(a==null||e[b].queue===a)&&(d?e[b](!0):e[b].saveState(),c=!0,e.splice(b,1));(!d||!c)&&f.dequeue(this,a)})}}),f.each({slideDown:cu("show",1),slideUp:cu("hide",1),slideToggle:cu("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default;if(d.queue==null||d.queue===!0)d.queue="fx";d.old=d.complete,d.complete=function(a){f.isFunction(d.old)&&d.old.call(this),d.queue?f.dequeue(this,d.queue):a!==!1&&f._unmark(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(a,c,d){function h(a){return e.step(a)}var e=this,g=f.fx;this.startTime=cr||cs(),this.end=c,this.now=this.start=a,this.pos=this.state=0,this.unit=d||this.unit||(f.cssNumber[this.prop]?"":"px"),h.queue=this.options.queue,h.elem=this.elem,h.saveState=function(){e.options.hide&&f._data(e.elem,"fxshow"+e.prop)===b&&f._data(e.elem,"fxshow"+e.prop,e.start)},h()&&f.timers.push(h)&&!cp&&(cp=setInterval(g.tick,g.interval))},show:function(){var a=f._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=a||f.style(this.elem,this.prop),this.options.show=!0,a!==b?this.custom(this.cur(),a):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f._data(this.elem,"fxshow"+this.prop)||f.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b,c,d,e=cr||cs(),g=!0,h=this.elem,i=this.options;if(a||e>=i.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),i.animatedProperties[this.prop]=!0;for(b in i.animatedProperties)i.animatedProperties[b]!==!0&&(g=!1);if(g){i.overflow!=null&&!f.support.shrinkWrapBlocks&&f.each(["","X","Y"],function(a,b){h.style["overflow"+b]=i.overflow[a]}),i.hide&&f(h).hide();if(i.hide||i.show)for(b in i.animatedProperties)f.style(h,b,i.orig[b]),f.removeData(h,"fxshow"+b,!0),f.removeData(h,"toggle"+b,!0);d=i.complete,d&&(i.complete=!1,d.call(h))}return!1}i.duration==Infinity?this.now=e:(c=e-this.startTime,this.state=c/i.duration,this.pos=f.easing[i.animatedProperties[this.prop]](this.state,c,0,1,i.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return!0}},f.extend(f.fx,{tick:function(){var a,b=f.timers,c=0;for(;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||f.fx.stop()},interval:13,stop:function(){clearInterval(cp),cp=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}}),f.each(["width","height"],function(a,b){f.fx.step[b]=function(a){f.style(a.elem,b,Math.max(0,a.now)+a.unit)}}),f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var cw=/^t(?:able|d|h)$/i,cx=/^(?:body|html)$/i;"getBoundingClientRect"in c.documentElement?f.fn.offset=function(a){var b=this[0],c;if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);try{c=b.getBoundingClientRect()}catch(d){}var e=b.ownerDocument,g=e.documentElement;if(!c||!f.contains(g,b))return c?{top:c.top,left:c.left}:{top:0,left:0};var h=e.body,i=cy(e),j=g.clientTop||h.clientTop||0,k=g.clientLeft||h.clientLeft||0,l=i.pageYOffset||f.support.boxModel&&g.scrollTop||h.scrollTop,m=i.pageXOffset||f.support.boxModel&&g.scrollLeft||h.scrollLeft,n=c.top+l-j,o=c.left+m-k;return{top:n,left:o}}:f.fn.offset=function(a){var b=this[0];if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);var c,d=b.offsetParent,e=b,g=b.ownerDocument,h=g.documentElement,i=g.body,j=g.defaultView,k=j?j.getComputedStyle(b,null):b.currentStyle,l=b.offsetTop,m=b.offsetLeft;while((b=b.parentNode)&&b!==i&&b!==h){if(f.support.fixedPosition&&k.position==="fixed")break;c=j?j.getComputedStyle(b,null):b.currentStyle,l-=b.scrollTop,m-=b.scrollLeft,b===d&&(l+=b.offsetTop,m+=b.offsetLeft,f.support.doesNotAddBorder&&(!f.support.doesAddBorderForTableAndCells||!cw.test(b.nodeName))&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),e=d,d=b.offsetParent),f.support.subtractsBorderForOverflowNotVisible&&c.overflow!=="visible"&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),k=c}if(k.position==="relative"||k.position==="static")l+=i.offsetTop,m+=i.offsetLeft;f.support.fixedPosition&&k.position==="fixed"&&(l+=Math.max(h.scrollTop,i.scrollTop),m+=Math.max(h.scrollLeft,i.scrollLeft));return{top:l,left:m}},f.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;f.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,"position");d==="static"&&(a.style.position="relative");var e=f(a),g=e.offset(),h=f.css(a,"top"),i=f.css(a,"left"),j=(d==="absolute"||d==="fixed")&&f.inArray("auto",[h,i])>-1,k={},l={},m,n;j?(l=e.position(),m=l.top,n=l.left):(m=parseFloat(h)||0,n=parseFloat(i)||0),f.isFunction(b)&&(b=b.call(a,c,g)),b.top!=null&&(k.top=b.top-g.top+m),b.left!=null&&(k.left=b.left-g.left+n),"using"in b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=cx.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f.css(a,"marginTop"))||0,c.left-=parseFloat(f.css(a,"marginLeft"))||0,d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(f.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||c.body;while(a&&!cx.test(a.nodeName)&&f.css(a,"position")==="static")a=a.offsetParent;return a})}}),f.each(["Left","Top"],function(a,c){var d="scroll"+c;f.fn[d]=function(c){var e,g;if(c===b){e=this[0];if(!e)return null;g=cy(e);return g?"pageXOffset"in g?g[a?"pageYOffset":"pageXOffset"]:f.support.boxModel&&g.document.documentElement[d]||g.document.body[d]:e[d]}return this.each(function(){g=cy(this),g?g.scrollTo(a?f(g).scrollLeft():c,a?c:f(g).scrollTop()):this[d]=c})}}),f.each(["Height","Width"],function(a,c){var d=c.toLowerCase();f.fn["inner"+c]=function(){var a=this[0];return a?a.style?parseFloat(f.css(a,d,"padding")):this[d]():null},f.fn["outer"+c]=function(a){var b=this[0];return b?b.style?parseFloat(f.css(b,d,a?"margin":"border")):this[d]():null},f.fn[d]=function(a){var e=this[0];if(!e)return a==null?null:this;if(f.isFunction(a))return this.each(function(b){var c=f(this);c[d](a.call(this,b,c[d]()))});if(f.isWindow(e)){var g=e.document.documentElement["client"+c],h=e.document.body;return e.document.compatMode==="CSS1Compat"&&g||h&&h["client"+c]||g}if(e.nodeType===9)return Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]);if(a===b){var i=f.css(e,d),j=parseFloat(i);return f.isNumeric(j)?j:i}return this.css(d,typeof a=="string"?a:a+"px")}}),a.jQuery=a.$=f,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return f})})(window);(function(){function q(a,c,d){if(a===c)return a!==0||1/a==1/c;if(a==null||c==null)return a===c;if(a._chain)a=a._wrapped;if(c._chain)c=c._wrapped;if(a.isEqual&&b.isFunction(a.isEqual))return a.isEqual(c);if(c.isEqual&&b.isFunction(c.isEqual))return c.isEqual(a);var e=l.call(a);if(e!=l.call(c))return false;switch(e){case"[object String]":return a==String(c);case"[object Number]":return a!=+a?c!=+c:a==0?1/a==1/c:a==+c;case"[object Date]":case"[object Boolean]":return+a==+c;case"[object RegExp]":return a.source==c.source&&a.global==c.global&&a.multiline==c.multiline&&a.ignoreCase==c.ignoreCase}if(typeof a!="object"||typeof c!="object")return false;for(var f=d.length;f--;)if(d[f]==a)return true;d.push(a);var f=0,g=true;if(e=="[object Array]"){if(f=a.length,g=f==c.length)for(;f--;)if(!(g=f in a==f in c&&q(a[f],c[f],d)))break}else{if("constructor"in a!="constructor"in c||a.constructor!=c.constructor)return false;for(var h in a)if(b.has(a,h)&&(f++,!(g=b.has(c,h)&&q(a[h],c[h],d))))break;if(g){for(h in c)if(b.has(c,h)&&!f--)break;g=!f}}d.pop();return g}var r=this,G=r._,n={},k=Array.prototype,o=Object.prototype,i=k.slice,H=k.unshift,l=o.toString,I=o.hasOwnProperty,w=k.forEach,x=k.map,y=k.reduce,z=k.reduceRight,A=k.filter,B=k.every,C=k.some,p=k.indexOf,D=k.lastIndexOf,o=Array.isArray,J=Object.keys,s=Function.prototype.bind,b=function(a){return new m(a)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=b;exports._=b}else r._=b;b.VERSION="1.3.1";var j=b.each=b.forEach=function(a,c,d){if(a!=null)if(w&&a.forEach===w)a.forEach(c,d);else if(a.length===+a.length)for(var e=0,f=a.length;e<f;e++){if(e in a&&c.call(d,a[e],e,a)===n)break}else for(e in a)if(b.has(a,e)&&c.call(d,a[e],e,a)===n)break};b.map=b.collect=function(a,c,b){var e=[];if(a==null)return e;if(x&&a.map===x)return a.map(c,b);j(a,function(a,g,h){e[e.length]=c.call(b,a,g,h)});if(a.length===+a.length)e.length=a.length;return e};b.reduce=b.foldl=b.inject=function(a,c,d,e){var f=arguments.length>2;a==null&&(a=[]);if(y&&a.reduce===y)return e&&(c=b.bind(c,e)),f?a.reduce(c,d):a.reduce(c);j(a,function(a,b,i){f?d=c.call(e,d,a,b,i):(d=a,f=true)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return d};b.reduceRight=b.foldr=function(a,c,d,e){var f=arguments.length>2;a==null&&(a=[]);if(z&&a.reduceRight===z)return e&&(c=b.bind(c,e)),f?a.reduceRight(c,d):a.reduceRight(c);var g=b.toArray(a).reverse();e&&!f&&(c=b.bind(c,e));return f?b.reduce(g,c,d,e):b.reduce(g,c)};b.find=b.detect=function(a,c,b){var e;E(a,function(a,g,h){if(c.call(b,a,g,h))return e=a,true});return e};b.filter=b.select=function(a,c,b){var e=[];if(a==null)return e;if(A&&a.filter===A)return a.filter(c,b);j(a,function(a,g,h){c.call(b,a,g,h)&&(e[e.length]=a)});return e};b.reject=function(a,c,b){var e=[];if(a==null)return e;j(a,function(a,g,h){c.call(b,a,g,h)||(e[e.length]=a)});return e};b.every=b.all=function(a,c,b){var e=true;if(a==null)return e;if(B&&a.every===B)return a.every(c,b);j(a,function(a,g,h){if(!(e=e&&c.call(b,a,g,h)))return n});return e};var E=b.some=b.any=function(a,c,d){c||(c=b.identity);var e=false;if(a==null)return e;if(C&&a.some===C)return a.some(c,d);j(a,function(a,b,h){if(e||(e=c.call(d,a,b,h)))return n});return!!e};b.include=b.contains=function(a,c){var b=false;if(a==null)return b;return p&&a.indexOf===p?a.indexOf(c)!=-1:b=E(a,function(a){return a===c})};b.invoke=function(a,c){var d=i.call(arguments,2);return b.map(a,function(a){return(b.isFunction(c)?c||a:a[c]).apply(a,d)})};b.pluck=function(a,c){return b.map(a,function(a){return a[c]})};b.max=function(a,c,d){if(!c&&b.isArray(a))return Math.max.apply(Math,a);if(!c&&b.isEmpty(a))return-Infinity;var e={computed:-Infinity};j(a,function(a,b,h){b=c?c.call(d,a,b,h):a;b>=e.computed&&(e={value:a,computed:b})});return e.value};b.min=function(a,c,d){if(!c&&b.isArray(a))return Math.min.apply(Math,a);if(!c&&b.isEmpty(a))return Infinity;var e={computed:Infinity};j(a,function(a,b,h){b=c?c.call(d,a,b,h):a;b<e.computed&&(e={value:a,computed:b})});return e.value};b.shuffle=function(a){var b=[],d;j(a,function(a,f){f==0?b[0]=a:(d=Math.floor(Math.random()*(f+1)),b[f]=b[d],b[d]=a)});return b};b.sortBy=function(a,c,d){return b.pluck(b.map(a,function(a,b,g){return{value:a,criteria:c.call(d,a,b,g)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")};b.groupBy=function(a,c){var d={},e=b.isFunction(c)?c:function(a){return a[c]};j(a,function(a,b){var c=e(a,b);(d[c]||(d[c]=[])).push(a)});return d};b.sortedIndex=function(a,c,d){d||(d=b.identity);for(var e=0,f=a.length;e<f;){var g=e+f>>1;d(a[g])<d(c)?e=g+1:f=g}return e};b.toArray=function(a){return!a?[]:a.toArray?a.toArray():b.isArray(a)?i.call(a):b.isArguments(a)?i.call(a):b.values(a)};b.size=function(a){return b.toArray(a).length};b.first=b.head=function(a,b,d){return b!=null&&!d?i.call(a,0,b):a[0]};b.initial=function(a,b,d){return i.call(a,0,a.length-(b==null||d?1:b))};b.last=function(a,b,d){return b!=null&&!d?i.call(a,Math.max(a.length-b,0)):a[a.length-1]};b.rest=b.tail=function(a,b,d){return i.call(a,b==null||d?1:b)};b.compact=function(a){return b.filter(a,function(a){return!!a})};b.flatten=function(a,c){return b.reduce(a,function(a,e){if(b.isArray(e))return a.concat(c?e:b.flatten(e));a[a.length]=e;return a},[])};b.without=function(a){return b.difference(a,i.call(arguments,1))};b.uniq=b.unique=function(a,c,d){var d=d?b.map(a,d):a,e=[];b.reduce(d,function(d,g,h){if(0==h||(c===true?b.last(d)!=g:!b.include(d,g)))d[d.length]=g,e[e.length]=a[h];return d},[]);return e};b.union=function(){return b.uniq(b.flatten(arguments,true))};b.intersection=b.intersect=function(a){var c=i.call(arguments,1);return b.filter(b.uniq(a),function(a){return b.every(c,function(c){return b.indexOf(c,a)>=0})})};b.difference=function(a){var c=b.flatten(i.call(arguments,1));return b.filter(a,function(a){return!b.include(c,a)})};b.zip=function(){for(var a=i.call(arguments),c=b.max(b.pluck(a,"length")),d=Array(c),e=0;e<c;e++)d[e]=b.pluck(a,""+e);return d};b.indexOf=function(a,c,d){if(a==null)return-1;var e;if(d)return d=b.sortedIndex(a,c),a[d]===c?d:-1;if(p&&a.indexOf===p)return a.indexOf(c);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===c)return d;return-1};b.lastIndexOf=function(a,b){if(a==null)return-1;if(D&&a.lastIndexOf===D)return a.lastIndexOf(b);for(var d=a.length;d--;)if(d in a&&a[d]===b)return d;return-1};b.range=function(a,b,d){arguments.length<=1&&(b=a||0,a=0);for(var d=arguments[2]||1,e=Math.max(Math.ceil((b-a)/d),0),f=0,g=Array(e);f<e;)g[f++]=a,a+=d;return g};var F=function(){};b.bind=function(a,c){var d,e;if(a.bind===s&&s)return s.apply(a,i.call(arguments,1));if(!b.isFunction(a))throw new TypeError;e=i.call(arguments,2);return d=function(){if(!(this instanceof d))return a.apply(c,e.concat(i.call(arguments)));F.prototype=a.prototype;var b=new F,g=a.apply(b,e.concat(i.call(arguments)));return Object(g)===g?g:b}};b.bindAll=function(a){var c=i.call(arguments,1);c.length==0&&(c=b.functions(a));j(c,function(c){a[c]=b.bind(a[c],a)});return a};b.memoize=function(a,c){var d={};c||(c=b.identity);return function(){var e=c.apply(this,arguments);return b.has(d,e)?d[e]:d[e]=a.apply(this,arguments)}};b.delay=function(a,b){var d=i.call(arguments,2);return setTimeout(function(){return a.apply(a,d)},b)};b.defer=function(a){return b.delay.apply(b,[a,1].concat(i.call(arguments,1)))};b.throttle=function(a,c){var d,e,f,g,h,i=b.debounce(function(){h=g=false},c);return function(){d=this;e=arguments;var b;f||(f=setTimeout(function(){f=null;h&&a.apply(d,e);i()},c));g?h=true:a.apply(d,e);i();g=true}};b.debounce=function(a,b){var d;return function(){var e=this,f=arguments;clearTimeout(d);d=setTimeout(function(){d=null;a.apply(e,f)},b)}};b.once=function(a){var b=false,d;return function(){if(b)return d;b=true;return d=a.apply(this,arguments)}};b.wrap=function(a,b){return function(){var d=[a].concat(i.call(arguments,0));return b.apply(this,d)}};b.compose=function(){var a=arguments;return function(){for(var b=arguments,d=a.length-1;d>=0;d--)b=[a[d].apply(this,b)];return b[0]}};b.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}};b.keys=J||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var c=[],d;for(d in a)b.has(a,d)&&(c[c.length]=d);return c};b.values=function(a){return b.map(a,b.identity)};b.functions=b.methods=function(a){var c=[],d;for(d in a)b.isFunction(a[d])&&c.push(d);return c.sort()};b.extend=function(a){j(i.call(arguments,1),function(b){for(var d in b)a[d]=b[d]});return a};b.defaults=function(a){j(i.call(arguments,1),function(b){for(var d in b)a[d]==null&&(a[d]=b[d])});return a};b.clone=function(a){return!b.isObject(a)?a:b.isArray(a)?a.slice():b.extend({},a)};b.tap=function(a,b){b(a);return a};b.isEqual=function(a,b){return q(a,b,[])};b.isEmpty=function(a){if(b.isArray(a)||b.isString(a))return a.length===0;for(var c in a)if(b.has(a,c))return false;return true};b.isElement=function(a){return!!(a&&a.nodeType==1)};b.isArray=o||function(a){return l.call(a)=="[object Array]"};b.isObject=function(a){return a===Object(a)};b.isArguments=function(a){return l.call(a)=="[object Arguments]"};if(!b.isArguments(arguments))b.isArguments=function(a){return!(!a||!b.has(a,"callee"))};b.isFunction=function(a){return l.call(a)=="[object Function]"};b.isString=function(a){return l.call(a)=="[object String]"};b.isNumber=function(a){return l.call(a)=="[object Number]"};b.isNaN=function(a){return a!==a};b.isBoolean=function(a){return a===true||a===false||l.call(a)=="[object Boolean]"};b.isDate=function(a){return l.call(a)=="[object Date]"};b.isRegExp=function(a){return l.call(a)=="[object RegExp]"};b.isNull=function(a){return a===null};b.isUndefined=function(a){return a===void 0};b.has=function(a,b){return I.call(a,b)};b.noConflict=function(){r._=G;return this};b.identity=function(a){return a};b.times=function(a,b,d){for(var e=0;e<a;e++)b.call(d,e)};b.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};b.mixin=function(a){j(b.functions(a),function(c){K(c,b[c]=a[c])})};var L=0;b.uniqueId=function(a){var b=L++;return a?a+b:b};b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var t=/.^/,u=function(a){return a.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};b.template=function(a,c){var d=b.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(d.escape||t,function(a,b){return"',_.escape("+u(b)+"),'"}).replace(d.interpolate||t,function(a,b){return"',"+u(b)+",'"}).replace(d.evaluate||t,function(a,b){return"');"+u(b).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",d);return c?e(c,b):function(a){return e.call(this,a,b)}};b.chain=function(a){return b(a).chain()};var m=function(a){this._wrapped=a};b.prototype=m.prototype;var v=function(a,c){return c?b(a).chain():a},K=function(a,c){m.prototype[a]=function(){var a=i.call(arguments);H.call(a,this._wrapped);return v(c.apply(b,a),this._chain)}};b.mixin(b);j("pop,push,reverse,shift,sort,splice,unshift".split(","),function(a){var b=k[a];m.prototype[a]=function(){var d=this._wrapped;b.apply(d,arguments);var e=d.length;(a=="shift"||a=="splice")&&e===0&&delete d[0];return v(d,this._chain)}});j(["concat","join","slice"],function(a){var b=k[a];m.prototype[a]=function(){return v(b.apply(this._wrapped,arguments),this._chain)}});m.prototype.chain=function(){this._chain=true;return this};m.prototype.value=function(){return this._wrapped}}).call(this);(function(){var i=this,r=i.Backbone,s=Array.prototype.slice,t=Array.prototype.splice,g;g="undefined"!==typeof exports?exports:i.Backbone={};g.VERSION="0.9.1";var f=i._;!f&&"undefined"!==typeof require&&(f=require("underscore"));var h=i.jQuery||i.Zepto||i.ender;g.setDomLibrary=function(a){h=a};g.noConflict=function(){i.Backbone=r;return this};g.emulateHTTP=!1;g.emulateJSON=!1;g.Events={on:function(a,b,c){for(var d,a=a.split(/\s+/),e=this._callbacks||(this._callbacks={});d=a.shift();){d=e[d]||(e[d]={});var f=d.tail||(d.tail=d.next={});f.callback=b;f.context=c;d.tail=f.next={}}return this},off:function(a,b,c){var d,e,f;if(a){if(e=this._callbacks)for(a=a.split(/\s+/);d=a.shift();)if(f=e[d],delete e[d],b&&f)for(;(f=f.next)&&f.next;)if(!(f.callback===b&&(!c||f.context===c)))this.on(d,f.callback,f.context)}else delete this._callbacks;return this},trigger:function(a){var b,c,d,e;if(!(d=this._callbacks))return this;e=d.all;for((a=a.split(/\s+/)).push(null);b=a.shift();)e&&a.push({next:e.next,tail:e.tail,event:b}),(c=d[b])&&a.push({next:c.next,tail:c.tail});for(e=s.call(arguments,1);c=a.pop();){b=c.tail;for(d=c.event?[c.event].concat(e):e;(c=c.next)!==b;)c.callback.apply(c.context||this,d)}return this}};g.Events.bind=g.Events.on;g.Events.unbind=g.Events.off;g.Model=function(a,b){var c;a||(a={});b&&b.parse&&(a=this.parse(a));if(c=j(this,"defaults"))a=f.extend({},c,a);b&&b.collection&&(this.collection=b.collection);this.attributes={};this._escapedAttributes={};this.cid=f.uniqueId("c");if(!this.set(a,{silent:!0}))throw Error("Can't create an invalid model");delete this._changed;this._previousAttributes=f.clone(this.attributes);this.initialize.apply(this,arguments)};f.extend(g.Model.prototype,g.Events,{idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;b=this.attributes[a];return this._escapedAttributes[a]=f.escape(null==b?"":""+b)},has:function(a){return null!=this.attributes[a]},set:function(a,b,c){var d,e;f.isObject(a)||null==a?(d=a,c=b):(d={},d[a]=b);c||(c={});if(!d)return this;d instanceof g.Model&&(d=d.attributes);if(c.unset)for(e in d)d[e]=void 0;if(!this._validate(d,c))return!1;this.idAttribute in d&&(this.id=d[this.idAttribute]);var b=this.attributes,k=this._escapedAttributes,n=this._previousAttributes||{},h=this._setting;this._changed||(this._changed={});this._setting=!0;for(e in d)if(a=d[e],f.isEqual(b[e],a)||delete k[e],c.unset?delete b[e]:b[e]=a,this._changing&&!f.isEqual(this._changed[e],a)&&(this.trigger("change:"+e,this,a,c),this._moreChanges=!0),delete this._changed[e],!f.isEqual(n[e],a)||f.has(b,e)!=f.has(n,e))this._changed[e]=a;h||(!c.silent&&this.hasChanged()&&this.change(c),this._setting=!1);return this},unset:function(a,b){(b||(b={})).unset=!0;return this.set(a,null,b)},clear:function(a){(a||(a={})).unset=!0;return this.set(f.clone(this.attributes),a)},fetch:function(a){var a=a?f.clone(a):{},b=this,c=a.success;a.success=function(d,e,f){if(!b.set(b.parse(d,f),a))return!1;c&&c(b,d)};a.error=g.wrapError(a.error,b,a);return(this.sync||g.sync).call(this,"read",this,a)},save:function(a,b,c){var d,e;f.isObject(a)||null==a?(d=a,c=b):(d={},d[a]=b);c=c?f.clone(c):{};c.wait&&(e=f.clone(this.attributes));a=f.extend({},c,{silent:!0});if(d&&!this.set(d,c.wait?a:c))return!1;var k=this,h=c.success;c.success=function(a,b,e){b=k.parse(a,e);c.wait&&(b=f.extend(d||{},b));if(!k.set(b,c))return!1;h?h(k,a):k.trigger("sync",k,a,c)};c.error=g.wrapError(c.error,k,c);b=this.isNew()?"create":"update";b=(this.sync||g.sync).call(this,b,this,c);c.wait&&this.set(e,a);return b},destroy:function(a){var a=a?f.clone(a):{},b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};if(this.isNew())return d();a.success=function(e){a.wait&&d();c?c(b,e):b.trigger("sync",b,e,a)};a.error=g.wrapError(a.error,b,a);var e=(this.sync||g.sync).call(this,"delete",this,a);a.wait||d();return e},url:function(){var a=j(this.collection,"url")||j(this,"urlRoot")||o();return this.isNew()?a:a+("/"==a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(a){if(this._changing||!this.hasChanged())return this;this._moreChanges=this._changing=!0;for(var b in this._changed)this.trigger("change:"+b,this,this._changed[b],a);for(;this._moreChanges;)this._moreChanges=!1,this.trigger("change",this,a);this._previousAttributes=f.clone(this.attributes);delete this._changed;this._changing=!1;return this},hasChanged:function(a){return!arguments.length?!f.isEmpty(this._changed):this._changed&&f.has(this._changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?f.clone(this._changed):!1;var b,c=!1,d=this._previousAttributes,e;for(e in a)if(!f.isEqual(d[e],b=a[e]))(c||(c={}))[e]=b;return c},previous:function(a){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return f.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(a,b){if(b.silent||!this.validate)return!0;var a=f.extend({},this.attributes,a),c=this.validate(a,b);if(!c)return!0;b&&b.error?b.error(this,c,b):this.trigger("error",this,c,b);return!1}});g.Collection=function(a,b){b||(b={});b.comparator&&(this.comparator=b.comparator);this._reset();this.initialize.apply(this,arguments);a&&this.reset(a,{silent:!0,parse:b.parse})};f.extend(g.Collection.prototype,g.Events,{model:g.Model,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(a,b){var c,d,e,g,h,i={},j={};b||(b={});a=f.isArray(a)?a.slice():[a];for(c=0,d=a.length;c<d;c++){if(!(e=a[c]=this._prepareModel(a[c],b)))throw Error("Can't add an invalid model to a collection");if(i[g=e.cid]||this._byCid[g]||null!=(h=e.id)&&(j[h]||this._byId[h]))throw Error("Can't add the same model to a collection twice");i[g]=j[h]=e}for(c=0;c<d;c++)(e=a[c]).on("all",this._onModelEvent,this),this._byCid[e.cid]=e,null!=e.id&&(this._byId[e.id]=e);this.length+=d;t.apply(this.models,[null!=b.at?b.at:this.models.length,0].concat(a));this.comparator&&this.sort({silent:!0});if(b.silent)return this;for(c=0,d=this.models.length;c<d;c++)if(i[(e=this.models[c]).cid])b.index=c,e.trigger("add",e,this,b);return this},remove:function(a,b){var c,d,e,g;b||(b={});a=f.isArray(a)?a.slice():[a];for(c=0,d=a.length;c<d;c++)if(g=this.getByCid(a[c])||this.get(a[c]))delete this._byId[g.id],delete this._byCid[g.cid],e=this.indexOf(g),this.models.splice(e,1),this.length--,b.silent||(b.index=e,g.trigger("remove",g,this,b)),this._removeReference(g);return this},get:function(a){return null==a?null:this._byId[null!=a.id?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a||(a={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");var b=f.bind(this.comparator,this);1==this.comparator.length?this.models=this.sortBy(b):this.models.sort(b);a.silent||this.trigger("reset",this,a);return this},pluck:function(a){return f.map(this.models,function(b){return b.get(a)})},reset:function(a,b){a||(a=[]);b||(b={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);this._reset();this.add(a,{silent:!0,parse:b.parse});b.silent||this.trigger("reset",this,b);return this},fetch:function(a){a=a?f.clone(a):{};void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;a.success=function(d,e,f){b[a.add?"add":"reset"](b.parse(d,f),a);c&&c(b,d)};a.error=g.wrapError(a.error,b,a);return(this.sync||g.sync).call(this,"read",this,a)},create:function(a,b){var c=this,b=b?f.clone(b):{},a=this._prepareModel(a,b);if(!a)return!1;b.wait||c.add(a,b);var d=b.success;b.success=function(e,f){b.wait&&c.add(e,b);d?d(e,f):e.trigger("sync",a,f,b)};a.save(null,b);return a},parse:function(a){return a},chain:function(){return f(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(a,b){a instanceof g.Model?a.collection||(a.collection=this):(b.collection=this,a=new this.model(a,b),a._validate(a.attributes,b)||(a=!1));return a},_removeReference:function(a){this==a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"==a||"remove"==a)&&c!=this||("destroy"==a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,arguments))}});f.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,initial,rest,last,without,indexOf,shuffle,lastIndexOf,isEmpty,groupBy".split(","),function(a){g.Collection.prototype[a]=function(){return f[a].apply(f,[this.models].concat(f.toArray(arguments)))}});g.Router=function(a){a||(a={});a.routes&&(this.routes=a.routes);this._bindRoutes();this.initialize.apply(this,arguments)};var u=/:\w+/g,v=/\*\w+/g,w=/[-[\]{}()+?.,\\^$|#\s]/g;f.extend(g.Router.prototype,g.Events,{initialize:function(){},route:function(a,b,c){g.history||(g.history=new g.History);f.isRegExp(a)||(a=this._routeToRegExp(a));c||(c=this[b]);g.history.route(a,f.bind(function(d){d=this._extractParameters(a,d);c&&c.apply(this,d);this.trigger.apply(this,["route:"+b].concat(d));g.history.trigger("route",this,b,d)},this));return this},navigate:function(a,b){g.history.navigate(a,b)},_bindRoutes:function(){if(this.routes){var a=[],b;for(b in this.routes)a.unshift([b,this.routes[b]]);b=0;for(var c=a.length;b<c;b++)this.route(a[b][0],a[b][1],this[a[b][1]])}},_routeToRegExp:function(a){a=a.replace(w,"\\$&").replace(u,"([^/]+)").replace(v,"(.*?)");return RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}});g.History=function(){this.handlers=[];f.bindAll(this,"checkUrl")};var m=/^[#\/]/,x=/msie [\w.]+/,l=!1;f.extend(g.History.prototype,g.Events,{interval:50,getFragment:function(a,b){if(null==a)if(this._hasPushState||b){var a=window.location.pathname,c=window.location.search;c&&(a+=c)}else a=window.location.hash;a=decodeURIComponent(a);a.indexOf(this.options.root)||(a=a.substr(this.options.root.length));return a.replace(m,"")},start:function(a){if(l)throw Error("Backbone.history has already been started");this.options=f.extend({},{root:"/"},this.options,a);this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);var a=this.getFragment(),b=document.documentMode;if(b=x.exec(navigator.userAgent.toLowerCase())&&(!b||7>=b))this.iframe=h('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(a);this._hasPushState?h(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!b?h(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));this.fragment=a;l=!0;a=window.location;b=a.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!b)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&b&&a.hash&&(this.fragment=a.hash.replace(m,""),window.history.replaceState({},document.title,a.protocol+"//"+a.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){h(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);l=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a==this.fragment&&this.iframe&&(a=this.getFragment(this.iframe.location.hash));if(a==this.fragment||a==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(a);this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(a){var b=this.fragment=this.getFragment(a);return f.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),!0})},navigate:function(a,b){if(!l)return!1;if(!b||!0===b)b={trigger:b};var c=(a||"").replace(m,"");this.fragment==c||this.fragment==decodeURIComponent(c)||(this._hasPushState?(0!=c.indexOf(this.options.root)&&(c=this.options.root+c),this.fragment=c,window.history[b.replace?"replaceState":"pushState"]({},document.title,c)):this._wantsHashChange?(this.fragment=c,this._updateHash(window.location,c,b.replace),this.iframe&&c!=this.getFragment(this.iframe.location.hash)&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,c,b.replace))):window.location.assign(this.options.root+a),b.trigger&&this.loadUrl(a))},_updateHash:function(a,b,c){c?a.replace(a.toString().replace(/(javascript:|#).*$/,"")+"#"+b):a.hash=b}});g.View=function(a){this.cid=f.uniqueId("view");this._configure(a||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var y=/^(\S+)\s*(.*)$/,p="model,collection,el,id,attributes,className,tagName".split(",");f.extend(g.View.prototype,g.Events,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(a,b,c){a=document.createElement(a);b&&h(a).attr(b);c&&h(a).html(c);return a},setElement:function(a,b){this.$el=h(a);this.el=this.$el[0];!1!==b&&this.delegateEvents();return this},delegateEvents:function(a){if(a||(a=j(this,"events"))){this.undelegateEvents();for(var b in a){var c=a[b];f.isFunction(c)||(c=this[a[b]]);if(!c)throw Error('Event "'+a[b]+'" does not exist');var d=b.match(y),e=d[1],d=d[2],c=f.bind(c,this),e=e+(".delegateEvents"+this.cid);""===d?this.$el.bind(e,c):this.$el.delegate(d,e,c)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=f.extend({},this.options,a));for(var b=0,c=p.length;b<c;b++){var d=p[b];a[d]&&(this[d]=a[d])}this.options=a},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var a=j(this,"attributes")||{};this.id&&(a.id=this.id);this.className&&(a["class"]=this.className);this.setElement(this.make(this.tagName,a),!1)}}});g.Model.extend=g.Collection.extend=g.Router.extend=g.View.extend=function(a,b){var c=z(this,a,b);c.extend=this.extend;return c};var A={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};g.sync=function(a,b,c){var d=A[a],e={type:d,dataType:"json"};c.url||(e.url=j(b,"url")||o());if(!c.data&&b&&("create"==a||"update"==a))e.contentType="application/json",e.data=JSON.stringify(b.toJSON());g.emulateJSON&&(e.contentType="application/x-www-form-urlencoded",e.data=e.data?{model:e.data}:{});if(g.emulateHTTP&&("PUT"===d||"DELETE"===d))g.emulateJSON&&(e.data._method=d),e.type="POST",e.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",d)};"GET"!==e.type&&!g.emulateJSON&&(e.processData=!1);return h.ajax(f.extend(e,c))};g.wrapError=function(a,b,c){return function(d,e){e=d===b?e:d;a?a(b,e,c):b.trigger("error",b,e,c)}};var q=function(){},z=function(a,b,c){var d;d=b&&b.hasOwnProperty("constructor")?b.constructor:function(){a.apply(this,arguments)};f.extend(d,a);q.prototype=a.prototype;d.prototype=new q;b&&f.extend(d.prototype,b);c&&f.extend(d,c);d.prototype.constructor=d;d.__super__=a.prototype;return d},j=function(a,b){return!a||!a[b]?null:f.isFunction(a[b])?a[b]():a[b]},o=function(){throw Error('A "url" property or function must be specified')}}).call(this);(function($,undefined){$.ui=$.ui||{};if($.ui.version){return}$.extend($.ui,{version:"1.8.13",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});$.fn.extend({_focus:$.fn.focus,focus:function(delay,fn){return typeof delay==="number"?this.each(function(){var elem=this;setTimeout(function(){$(elem).focus();if(fn){fn.call(elem)}},delay)}):this._focus.apply(this,arguments)},scrollParent:function(){var scrollParent;if($.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))){scrollParent=this.parents().filter(function(){return/(relative|absolute|fixed)/.test($.curCSS(this,"position",1))&&/(auto|scroll)/.test($.curCSS(this,"overflow",1)+$.curCSS(this,"overflow-y",1)+$.curCSS(this,"overflow-x",1))}).eq(0)}else{scrollParent=this.parents().filter(function(){return/(auto|scroll)/.test($.curCSS(this,"overflow",1)+$.curCSS(this,"overflow-y",1)+$.curCSS(this,"overflow-x",1))}).eq(0)}return/fixed/.test(this.css("position"))||!scrollParent.length?$(document):scrollParent},zIndex:function(zIndex){if(zIndex!==undefined){return this.css("zIndex",zIndex)}if(this.length){var elem=$(this[0]),position,value;while(elem.length&&elem[0]!==document){position=elem.css("position");if(position==="absolute"||position==="relative"||position==="fixed"){value=parseInt(elem.css("zIndex"),10);if(!isNaN(value)&&value!==0){return value}}elem=elem.parent()}}return 0},disableSelection:function(){return this.bind(($.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(event){event.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});$.each(["Width","Height"],function(i,name){var side=name==="Width"?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};function reduce(elem,size,border,margin){$.each(side,function(){size-=parseFloat($.curCSS(elem,"padding"+this,true))||0;if(border){size-=parseFloat($.curCSS(elem,"border"+this+"Width",true))||0}if(margin){size-=parseFloat($.curCSS(elem,"margin"+this,true))||0}});return size}$.fn["inner"+name]=function(size){if(size===undefined){return orig["inner"+name].call(this)}return this.each(function(){$(this).css(type,reduce(this,size)+"px")})};$.fn["outer"+name]=function(size,margin){if(typeof size!=="number"){return orig["outer"+name].call(this,size)}return this.each(function(){$(this).css(type,reduce(this,size,true,margin)+"px")})}});function focusable(element,isTabIndexNotNaN){var nodeName=element.nodeName.toLowerCase();if("area"===nodeName){var map=element.parentNode,mapName=map.name,img;if(!element.href||!mapName||map.nodeName.toLowerCase()!=="map"){return false}img=$("img[usemap=#"+mapName+"]")[0];return!!img&&visible(img)}return(/input|select|textarea|button|object/.test(nodeName)?!element.disabled:"a"==nodeName?element.href||isTabIndexNotNaN:isTabIndexNotNaN)&&visible(element)}function visible(element){return!$(element).parents().andSelf().filter(function(){return $.curCSS(this,"visibility")==="hidden"||$.expr.filters.hidden(this)}).length}$.extend($.expr[":"],{data:function(elem,i,match){return!!$.data(elem,match[3])},focusable:function(element){return focusable(element,!isNaN($.attr(element,"tabindex")))},tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),isTabIndexNaN=isNaN(tabIndex);return(isTabIndexNaN||tabIndex>=0)&&focusable(element,!isTabIndexNaN)}});$(function(){var body=document.body,div=body.appendChild(div=document.createElement("div"));$.extend(div.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});$.support.minHeight=div.offsetHeight===100;$.support.selectstart="onselectstart"in div;body.removeChild(div).style.display="none"});$.extend($.ui,{plugin:{add:function(module,option,set){var proto=$.ui[module].prototype;for(var i in set){proto.plugins[i]=proto.plugins[i]||[];proto.plugins[i].push([option,set[i]])}},call:function(instance,name,args){var set=instance.plugins[name];if(!set||!instance.element[0].parentNode){return}for(var i=0;i<set.length;i++){if(instance.options[set[i][0]]){set[i][1].apply(instance.element,args)}}}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(el,a){if($(el).css("overflow")==="hidden"){return false}var scroll=a&&a==="left"?"scrollLeft":"scrollTop",has=false;if(el[scroll]>0){return true}el[scroll]=1;has=el[scroll]>0;el[scroll]=0;return has},isOverAxis:function(x,reference,size){return x>reference&&x<reference+size},isOver:function(y,x,top,left,height,width){return $.ui.isOverAxis(y,top,height)&&$.ui.isOverAxis(x,left,width)}})})(jQuery);(function($,undefined){if($.cleanData){var _cleanData=$.cleanData;$.cleanData=function(elems){for(var i=0,elem;(elem=elems[i])!=null;i++){$(elem).triggerHandler("remove")}_cleanData(elems)}}else{var _remove=$.fn.remove;$.fn.remove=function(selector,keepData){return this.each(function(){if(!keepData){if(!selector||$.filter(selector,[this]).length){$("*",this).add([this]).each(function(){$(this).triggerHandler("remove")})}}return _remove.call($(this),selector,keepData)})}}$.widget=function(name,base,prototype){var namespace=name.split(".")[0],fullName;name=name.split(".")[1];fullName=namespace+"-"+name;if(!prototype){prototype=base;base=$.Widget}$.expr[":"][fullName]=function(elem){return!!$.data(elem,name)};$[namespace]=$[namespace]||{};$[namespace][name]=function(options,element){if(arguments.length){this._createWidget(options,element)}};var basePrototype=new base;basePrototype.options=$.extend(true,{},basePrototype.options);$[namespace][name].prototype=$.extend(true,basePrototype,{namespace:namespace,widgetName:name,widgetEventPrefix:$[namespace][name].prototype.widgetEventPrefix||name,widgetBaseClass:fullName},prototype);$.widget.bridge(name,$[namespace][name])};$.widget.bridge=function(name,object){$.fn[name]=function(options){var isMethodCall=typeof options==="string",args=Array.prototype.slice.call(arguments,1),returnValue=this;options=!isMethodCall&&args.length?$.extend.apply(null,[true,options].concat(args)):options;if(isMethodCall&&options.charAt(0)==="_"){return returnValue}if(isMethodCall){this.each(function(){var instance=$.data(this,name),methodValue=instance&&$.isFunction(instance[options])?instance[options].apply(instance,args):instance;if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue;return false}})}else{this.each(function(){var instance=$.data(this,name);if(instance){instance.option(options||{})._init()}else{$.data(this,name,new object(options,this))}})}return returnValue}};$.Widget=function(options,element){if(arguments.length){this._createWidget(options,element)}};$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(options,element){$.data(element,this.widgetName,this);this.element=$(element);this.options=$.extend(true,{},this.options,this._getCreateOptions(),options);var self=this;this.element.bind("remove."+this.widgetName,function(){self.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return $.metadata&&$.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled "+"ui-state-disabled")},widget:function(){return this.element},option:function(key,value){var options=key;if(arguments.length===0){return $.extend({},this.options)}if(typeof key==="string"){if(value===undefined){return this.options[key]}options={};options[key]=value}this._setOptions(options);return this},_setOptions:function(options){var self=this;$.each(options,function(key,value){self._setOption(key,value)});return this},_setOption:function(key,value){this.options[key]=value;if(key==="disabled"){this.widget()[value?"addClass":"removeClass"](this.widgetBaseClass+"-disabled"+" "+"ui-state-disabled").attr("aria-disabled",value)}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(type,event,data){var callback=this.options[type];event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();data=data||{};if(event.originalEvent){for(var i=$.event.props.length,prop;i;){prop=$.event.props[--i];event[prop]=event.originalEvent[prop]}}this.element.trigger(event,data);return!($.isFunction(callback)&&callback.call(this.element[0],event,data)===false||event.isDefaultPrevented())}}})(jQuery);(function($,undefined){var mouseHandled=false;$(document).mouseup(function(e){mouseHandled=false});$.widget("ui.mouse",{version:"@VERSION",options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var self=this;this.element.bind("mousedown."+this.widgetName,function(event){return self._mouseDown(event)}).bind("click."+this.widgetName,function(event){if(true===$.data(event.target,self.widgetName+".preventClickEvent")){$.removeData(event.target,self.widgetName+".preventClickEvent");event.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(event){if(mouseHandled){return}this._mouseStarted&&this._mouseUp(event);this._mouseDownEvent=event;var self=this,btnIsLeft=event.which==1,elIsCancel=typeof this.options.cancel=="string"&&event.target.nodeName?$(event.target).closest(this.options.cancel).length:false;if(!btnIsLeft||elIsCancel||!this._mouseCapture(event)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){self.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=this._mouseStart(event)!==false;if(!this._mouseStarted){event.preventDefault();return true}}if(true===$.data(event.target,this.widgetName+".preventClickEvent")){$.removeData(event.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(event){return self._mouseMove(event)};this._mouseUpDelegate=function(event){return self._mouseUp(event)};$(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);event.preventDefault();mouseHandled=true;return true},_mouseMove:function(event){if($.browser.msie&&!(document.documentMode>=9)&&!event.button){return this._mouseUp(event)}if(this._mouseStarted){this._mouseDrag(event);return event.preventDefault()}if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=this._mouseStart(this._mouseDownEvent,event)!==false;this._mouseStarted?this._mouseDrag(event):this._mouseUp(event)}return!this._mouseStarted},_mouseUp:function(event){$(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(event.target==this._mouseDownEvent.target){$.data(event.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(event)}return false},_mouseDistanceMet:function(event){return Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance},_mouseDelayMet:function(event){return this.mouseDelayMet},_mouseStart:function(event){},_mouseDrag:function(event){},_mouseStop:function(event){},_mouseCapture:function(event){return true}})})(jQuery);(function($,undefined){var requestIndex=0;$.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var self=this,doc=this.element[0].ownerDocument,suppressKeyPress;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(event){if(self.options.disabled||self.element.attr("readonly")){return}suppressKeyPress=false;var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:self._move("previousPage",event);break;case keyCode.PAGE_DOWN:self._move("nextPage",event);break;case keyCode.UP:self._move("previous",event);event.preventDefault();break;case keyCode.DOWN:self._move("next",event);event.preventDefault();break;case keyCode.ENTER:case keyCode.NUMPAD_ENTER:if(self.menu.active){suppressKeyPress=true;event.preventDefault()}case keyCode.TAB:if(!self.menu.active){return}self.menu.select(event);break;case keyCode.ESCAPE:self.element.val(self.term);self.close(event);break;default:clearTimeout(self.searching);self.searching=setTimeout(function(){if(self.term!=self.element.val()){self.selectedItem=null;self.search(null,event)}},self.options.delay);break}}).bind("keypress.autocomplete",function(event){if(suppressKeyPress){suppressKeyPress=false;event.preventDefault()}}).bind("focus.autocomplete",function(){if(self.options.disabled){return}self.selectedItem=null;self.previous=self.element.val()}).bind("blur.autocomplete",function(event){if(self.options.disabled){return}clearTimeout(self.searching);self.closing=setTimeout(function(){self.close(event);self._change(event)},150)});this._initSource();this.response=function(){return self._response.apply(self,arguments)};this.menu=$("<ul></ul>").addClass("ui-autocomplete").appendTo($(this.options.appendTo||"body",doc)[0]).mousedown(function(event){var menuElement=self.menu.element[0];if(!$(event.target).closest(".ui-menu-item").length){setTimeout(function(){$(document).one("mousedown",function(event){if(event.target!==self.element[0]&&event.target!==menuElement&&!$.ui.contains(menuElement,event.target)){self.close()}})},1)}setTimeout(function(){clearTimeout(self.closing)},13)}).menu({focus:function(event,ui){var item=ui.item.data("item.autocomplete");if(false!==self._trigger("focus",event,{item:item})){if(/^key/.test(event.originalEvent.type)){self.element.val(item.value)}}},selected:function(event,ui){var item=ui.item.data("item.autocomplete"),previous=self.previous;if(self.element[0]!==doc.activeElement){self.element.focus();self.previous=previous;setTimeout(function(){self.previous=previous;self.selectedItem=item},1)}if(false!==self._trigger("select",event,{item:item})){self.element.val(item.value)}self.term=self.element.val();self.close(event);self.selectedItem=item},blur:function(event,ui){if(self.menu.element.is(":visible")&&self.element.val()!==self.term){self.element.val(self.term)}}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");if($.fn.bgiframe){this.menu.element.bgiframe()}},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove();$.Widget.prototype.destroy.call(this)},_setOption:function(key,value){$.Widget.prototype._setOption.apply(this,arguments);if(key==="source"){this._initSource()}if(key==="appendTo"){this.menu.element.appendTo($(value||"body",this.element[0].ownerDocument)[0])}if(key==="disabled"&&value&&this.xhr){this.xhr.abort()}},_initSource:function(){var self=this,array,url;if($.isArray(this.options.source)){array=this.options.source;this.source=function(request,response){response($.ui.autocomplete.filter(array,request.term))}}else if(typeof this.options.source==="string"){url=this.options.source;this.source=function(request,response){if(self.xhr){self.xhr.abort()}self.xhr=$.ajax({url:url,data:request,dataType:"json",autocompleteRequest:++requestIndex,success:function(data,status){if(this.autocompleteRequest===requestIndex){response(data)}},error:function(){if(this.autocompleteRequest===requestIndex){response([])}}})}}else{this.source=this.options.source}},search:function(value,event){value=value!=null?value:this.element.val();this.term=this.element.val();if(value.length<this.options.minLength){return this.close(event)}clearTimeout(this.closing);if(this._trigger("search",event)===false){return}return this._search(value)},_search:function(value){this.pending++;this.element.addClass("ui-autocomplete-loading");this.source({term:value},this.response)},_response:function(content){if(!this.options.disabled&&content&&content.length){content=this._normalize(content);this._suggest(content);this._trigger("open")}else{this.close()}this.pending--;if(!this.pending){this.element.removeClass("ui-autocomplete-loading")}},close:function(event){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.deactivate();this._trigger("close",event)}},_change:function(event){if(this.previous!==this.element.val()){this._trigger("change",event,{item:this.selectedItem})}},_normalize:function(items){if(items.length&&items[0].label&&items[0].value){return items}return $.map(items,function(item){if(typeof item==="string"){return{label:item,value:item}}return $.extend({label:item.label||item.value,value:item.value||item.label},item)})},_suggest:function(items){var ul=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(ul,items);this.menu.deactivate();this.menu.refresh();ul.show();this._resizeMenu();ul.position($.extend({of:this.element},this.options.position));if(this.options.autoFocus){this.menu.next(new $.Event("mouseover"))}},_resizeMenu:function(){var ul=this.menu.element;ul.outerWidth(Math.max(ul.width("").outerWidth(),this.element.outerWidth()))},_renderMenu:function(ul,items){var self=this;$.each(items,function(index,item){self._renderItem(ul,item)})},_renderItem:function(ul,item){return $("<li></li>").data("item.autocomplete",item).append($("<a></a>").text(item.label)).appendTo(ul)},_move:function(direction,event){if(!this.menu.element.is(":visible")){this.search(null,event);return}if(this.menu.first()&&/^previous/.test(direction)||this.menu.last()&&/^next/.test(direction)){this.element.val(this.term);this.menu.deactivate();return}this.menu[direction](event)},widget:function(){return this.menu.element}});$.extend($.ui.autocomplete,{escapeRegex:function(value){return value.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(array,term){var matcher=new RegExp($.ui.autocomplete.escapeRegex(term),"i");return $.grep(array,function(value){return matcher.test(value.label||value.value||value)})}})})(jQuery);(function($){$.widget("ui.menu",{_create:function(){var self=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(event){if(!$(event.target).closest(".ui-menu-item a").length){return}event.preventDefault();self.select(event)});this.refresh()},refresh:function(){var self=this;var items=this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem");items.children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(event){self.activate(event,$(this).parent())}).mouseleave(function(){self.deactivate()})},activate:function(event,item){this.deactivate();if(this.hasScroll()){var offset=item.offset().top-this.element.offset().top,scroll=this.element.scrollTop(),elementHeight=this.element.height();if(offset<0){this.element.scrollTop(scroll+offset)}else if(offset>=elementHeight){this.element.scrollTop(scroll+offset-elementHeight+item.height())}}this.active=item.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",event,{item:item})},deactivate:function(){if(!this.active){return}this.active.children("a").removeClass("ui-state-hover").removeAttr("id");this._trigger("blur");this.active=null},next:function(event){this.move("next",".ui-menu-item:first",event)},previous:function(event){this.move("prev",".ui-menu-item:last",event)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(direction,edge,event){if(!this.active){this.activate(event,this.element.children(edge));return}var next=this.active[direction+"All"](".ui-menu-item").eq(0);if(next.length){this.activate(event,next)}else{this.activate(event,this.element.children(edge))}},nextPage:function(event){if(this.hasScroll()){if(!this.active||this.last()){this.activate(event,this.element.children(".ui-menu-item:first"));return}var base=this.active.offset().top,height=this.element.height(),result=this.element.children(".ui-menu-item").filter(function(){var close=$(this).offset().top-base-height+$(this).height();return close<10&&close>-10});if(!result.length){result=this.element.children(".ui-menu-item:last")}this.activate(event,result)}else{this.activate(event,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))}},previousPage:function(event){if(this.hasScroll()){if(!this.active||this.first()){this.activate(event,this.element.children(".ui-menu-item:last"));return}var base=this.active.offset().top,height=this.element.height();result=this.element.children(".ui-menu-item").filter(function(){var close=$(this).offset().top-base+height-$(this).height();return close<10&&close>-10});if(!result.length){result=this.element.children(".ui-menu-item:first")}this.activate(event,result)}else{this.activate(event,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))}},hasScroll:function(){return this.element.height()<this.element[$.fn.prop?"prop":"attr"]("scrollHeight")},select:function(event){this._trigger("selected",event,{item:this.active})}})})(jQuery);(function($,undefined){$.widget("ui.draggable",$.ui.mouse,{version:"@VERSION",widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position")))this.element[0].style.position="relative";this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(!this.element.data("draggable"))return;this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable"+" ui-draggable-dragging"+" ui-draggable-disabled");this._mouseDestroy();return this},_mouseCapture:function(event){var o=this.options;if(this.helper||o.disabled||$(event.target).is(".ui-resizable-handle"))return false;this.handle=this._getHandle(event);if(!this.handle)return false;$(o.iframeFix===true?"iframe":o.iframeFix).each(function(){$('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css($(this).offset()).appendTo("body")});return true},_mouseStart:function(event){var o=this.options;this.helper=this._createHelper(event);this._cacheHelperProportions();if($.ui.ddmanager)$.ui.ddmanager.current=this;this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(event);this.originalPageX=event.pageX;this.originalPageY=event.pageY;o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt);if(o.containment)this._setContainment();if(this._trigger("start",event)===false){this._clear();return false}this._cacheHelperProportions();if($.ui.ddmanager&&!o.dropBehaviour)$.ui.ddmanager.prepareOffsets(this,event);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(event,true);if($.ui.ddmanager)$.ui.ddmanager.dragStart(this,event);return true},_mouseDrag:function(event,noPropagation){this.position=this._generatePosition(event);this.positionAbs=this._convertPositionTo("absolute");if(!noPropagation){var ui=this._uiHash();if(this._trigger("drag",event,ui)===false){this._mouseUp({});return false}this.position=ui.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";if($.ui.ddmanager)$.ui.ddmanager.drag(this,event);return false},_mouseStop:function(event){var dropped=false;if($.ui.ddmanager&&!this.options.dropBehaviour)dropped=$.ui.ddmanager.drop(this,event);if(this.dropped){dropped=this.dropped;this.dropped=false}if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper==="original")return false;if(this.options.revert=="invalid"&&!dropped||this.options.revert=="valid"&&dropped||this.options.revert===true||$.isFunction(this.options.revert)&&this.options.revert.call(this.element,dropped)){var self=this;$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(self._trigger("stop",event)!==false){self._clear()}})}else{if(this._trigger("stop",event)!==false){this._clear()}}return false},_mouseUp:function(event){if(this.options.iframeFix===true){$("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}if($.ui.ddmanager)$.ui.ddmanager.dragStop(this,event);return $.ui.mouse.prototype._mouseUp.call(this,event)},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp({})}else{this._clear()}return this},_getHandle:function(event){var handle=!this.options.handle||!$(this.options.handle,this.element).length?true:false;$(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==event.target)handle=true});return handle},_createHelper:function(event){var o=this.options;var helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event])):o.helper=="clone"?this.element.clone().removeAttr("id"):this.element;if(!helper.parents("body").length)helper.appendTo(o.appendTo=="parent"?this.element[0].parentNode:o.appendTo);if(helper[0]!=this.element[0]&&!/(fixed|absolute)/.test(helper.css("position")))helper.css("position","absolute");return helper},_adjustOffsetFromHelper:function(obj){if(typeof obj=="string"){obj=obj.split(" ")}if($.isArray(obj)){obj={left:+obj[0],top:+obj[1]||0}}if("left"in obj){this.offset.click.left=obj.left+this.margins.left}if("right"in obj){this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left}if("top"in obj){this.offset.click.top=obj.top+this.margins.top}if("bottom"in obj){this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var po=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&$.contains(this.scrollParent[0],this.offsetParent[0])){po.left+=this.scrollParent.scrollLeft();po.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&$.browser.msie)po={top:0,left:0};return{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var p=this.element.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var o=this.options;if(o.containment=="parent")o.containment=this.helper[0].parentNode;if(o.containment=="document"||o.containment=="window")this.containment=[o.containment=="document"?0:$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,o.containment=="document"?0:$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(o.containment=="document"?0:$(window).scrollLeft())+$(o.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(o.containment=="document"?0:$(window).scrollTop())+($(o.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(o.containment)&&o.containment.constructor!=Array){var c=$(o.containment);var ce=c[0];if(!ce)return;var co=c.offset();var over=$(ce).css("overflow")!="hidden";this.containment=[(parseInt($(ce).css("borderLeftWidth"),10)||0)+(parseInt($(ce).css("paddingLeft"),10)||0),(parseInt($(ce).css("borderTopWidth"),10)||0)+(parseInt($(ce).css("paddingTop"),10)||0),(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt($(ce).css("borderLeftWidth"),10)||0)-(parseInt($(ce).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt($(ce).css("borderTopWidth"),10)||0)-(parseInt($(ce).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=c}else if(o.containment.constructor==Array){this.containment=o.containment}},_convertPositionTo:function(d,pos){if(!pos)pos=this.position;var mod=d=="absolute"?1:-1;var o=this.options,scroll=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=/(html|body)/i.test(scroll[0].tagName);return{top:pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():scrollIsRootNode?0:scroll.scrollTop())*mod),left:pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())*mod)}},_generatePosition:function(event){var o=this.options,scroll=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=/(html|body)/i.test(scroll[0].tagName);var pageX=event.pageX;var pageY=event.pageY;if(this.originalPosition){var containment;if(this.containment){if(this.relative_container){var co=this.relative_container.offset();containment=[this.containment[0]+co.left,this.containment[1]+co.top,this.containment[2]+co.left,this.containment[3]+co.top]}else{containment=this.containment}if(event.pageX-this.offset.click.left<containment[0])pageX=containment[0]+this.offset.click.left;if(event.pageY-this.offset.click.top<containment[1])pageY=containment[1]+this.offset.click.top;if(event.pageX-this.offset.click.left>containment[2])pageX=containment[2]+this.offset.click.left;if(event.pageY-this.offset.click.top>containment[3])pageY=containment[3]+this.offset.click.top}if(o.grid){var top=o.grid[1]?this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY;pageY=containment?!(top-this.offset.click.top<containment[1]||top-this.offset.click.top>containment[3])?top:!(top-this.offset.click.top<containment[1])?top-o.grid[1]:top+o.grid[1]:top;var left=o.grid[0]?this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX;pageX=containment?!(left-this.offset.click.left<containment[0]||left-this.offset.click.left>containment[2])?left:!(left-this.offset.click.left<containment[0])?left-o.grid[0]:left+o.grid[0]:left}}return{top:pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():scrollIsRootNode?0:scroll.scrollTop()),left:pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval)this.helper.remove();this.helper=null;this.cancelHelperRemoval=false},_trigger:function(type,event,ui){ui=ui||this._uiHash();$.ui.plugin.call(this,type,[event,ui]);if(type=="drag")this.positionAbs=this._convertPositionTo("absolute");return $.Widget.prototype._trigger.call(this,type,event,ui)},plugins:{},_uiHash:function(event){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});$.ui.plugin.add("draggable","connectToSortable",{start:function(event,ui){var inst=$(this).data("draggable"),o=inst.options,uiSortable=$.extend({},ui,{item:inst.element});inst.sortables=[];$(o.connectToSortable).each(function(){var sortable=$.data(this,"sortable");if(sortable&&!sortable.options.disabled){inst.sortables.push({instance:sortable,shouldRevert:sortable.options.revert});sortable.refreshPositions();sortable._trigger("activate",event,uiSortable)}})},stop:function(event,ui){var inst=$(this).data("draggable"),uiSortable=$.extend({},ui,{item:inst.element});$.each(inst.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;inst.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert)this.instance.options.revert=true;this.instance._mouseStop(event);this.instance.options.helper=this.instance.options._helper;if(inst.options.helper=="original")this.instance.currentItem.css({top:"auto",left:"auto"})}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",event,uiSortable)}})},drag:function(event,ui){var inst=$(this).data("draggable"),self=this;var checkPos=function(o){var dyClick=this.offset.click.top,dxClick=this.offset.click.left;var helperTop=this.positionAbs.top,helperLeft=this.positionAbs.left;var itemHeight=o.height,itemWidth=o.width;var itemTop=o.top,itemLeft=o.left;return $.ui.isOver(helperTop+dyClick,helperLeft+dxClick,itemTop,itemLeft,itemHeight,itemWidth)};$.each(inst.sortables,function(i){this.instance.positionAbs=inst.positionAbs;this.instance.helperProportions=inst.helperProportions;this.instance.offset.click=inst.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=$(self).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return ui.helper[0]};event.target=this.instance.currentItem[0];this.instance._mouseCapture(event,true);this.instance._mouseStart(event,true,true);this.instance.offset.click.top=inst.offset.click.top;this.instance.offset.click.left=inst.offset.click.left;this.instance.offset.parent.left-=inst.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=inst.offset.parent.top-this.instance.offset.parent.top;inst._trigger("toSortable",event);inst.dropped=this.instance.element;inst.currentItem=inst.element;this.instance.fromOutside=inst}if(this.instance.currentItem)this.instance._mouseDrag(event)}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",event,this.instance._uiHash(this.instance));this.instance._mouseStop(event,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();if(this.instance.placeholder)this.instance.placeholder.remove();inst._trigger("fromSortable",event);inst.dropped=false}}})}});$.ui.plugin.add("draggable","cursor",{start:function(event,ui){var t=$("body"),o=$(this).data("draggable").options;if(t.css("cursor"))o._cursor=t.css("cursor");t.css("cursor",o.cursor)},stop:function(event,ui){var o=$(this).data("draggable").options;if(o._cursor)$("body").css("cursor",o._cursor)}});$.ui.plugin.add("draggable","opacity",{start:function(event,ui){var t=$(ui.helper),o=$(this).data("draggable").options;if(t.css("opacity"))o._opacity=t.css("opacity");t.css("opacity",o.opacity)},stop:function(event,ui){var o=$(this).data("draggable").options;if(o._opacity)$(ui.helper).css("opacity",o._opacity)}});$.ui.plugin.add("draggable","scroll",{start:function(event,ui){var i=$(this).data("draggable");if(i.scrollParent[0]!=document&&i.scrollParent[0].tagName!="HTML")i.overflowOffset=i.scrollParent.offset()},drag:function(event,ui){var i=$(this).data("draggable"),o=i.options,scrolled=false;if(i.scrollParent[0]!=document&&i.scrollParent[0].tagName!="HTML"){if(!o.axis||o.axis!="x"){if(i.overflowOffset.top+i.scrollParent[0].offsetHeight-event.pageY<o.scrollSensitivity)i.scrollParent[0].scrollTop=scrolled=i.scrollParent[0].scrollTop+o.scrollSpeed;else if(event.pageY-i.overflowOffset.top<o.scrollSensitivity)i.scrollParent[0].scrollTop=scrolled=i.scrollParent[0].scrollTop-o.scrollSpeed}if(!o.axis||o.axis!="y"){if(i.overflowOffset.left+i.scrollParent[0].offsetWidth-event.pageX<o.scrollSensitivity)i.scrollParent[0].scrollLeft=scrolled=i.scrollParent[0].scrollLeft+o.scrollSpeed;else if(event.pageX-i.overflowOffset.left<o.scrollSensitivity)i.scrollParent[0].scrollLeft=scrolled=i.scrollParent[0].scrollLeft-o.scrollSpeed}}else{if(!o.axis||o.axis!="x"){if(event.pageY-$(document).scrollTop()<o.scrollSensitivity)scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed);else if($(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity)scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed)}if(!o.axis||o.axis!="y"){if(event.pageX-$(document).scrollLeft()<o.scrollSensitivity)scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed);else if($(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity)scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed)}}if(scrolled!==false&&$.ui.ddmanager&&!o.dropBehaviour)$.ui.ddmanager.prepareOffsets(i,event)}});$.ui.plugin.add("draggable","snap",{start:function(event,ui){var i=$(this).data("draggable"),o=i.options;i.snapElements=[];$(o.snap.constructor!=String?o.snap.items||":data(draggable)":o.snap).each(function(){var $t=$(this);var $o=$t.offset();if(this!=i.element[0])i.snapElements.push({item:this,width:$t.outerWidth(),height:$t.outerHeight(),top:$o.top,left:$o.left})})},drag:function(event,ui){var inst=$(this).data("draggable"),o=inst.options;var d=o.snapTolerance;var x1=ui.offset.left,x2=x1+inst.helperProportions.width,y1=ui.offset.top,y2=y1+inst.helperProportions.height;for(var i=inst.snapElements.length-1;i>=0;i--){var l=inst.snapElements[i].left,r=l+inst.snapElements[i].width,t=inst.snapElements[i].top,b=t+inst.snapElements[i].height;if(!(l-d<x1&&x1<r+d&&t-d<y1&&y1<b+d||l-d<x1&&x1<r+d&&t-d<y2&&y2<b+d||l-d<x2&&x2<r+d&&t-d<y1&&y1<b+d||l-d<x2&&x2<r+d&&t-d<y2&&y2<b+d)){if(inst.snapElements[i].snapping)inst.options.snap.release&&inst.options.snap.release.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item}));inst.snapElements[i].snapping=false;continue}if(o.snapMode!="inner"){var ts=Math.abs(t-y2)<=d;var bs=Math.abs(b-y1)<=d;var ls=Math.abs(l-x2)<=d;var rs=Math.abs(r-x1)<=d;if(ts)ui.position.top=inst._convertPositionTo("relative",{top:t-inst.helperProportions.height,left:0}).top-inst.margins.top;if(bs)ui.position.top=inst._convertPositionTo("relative",{top:b,left:0}).top-inst.margins.top;if(ls)ui.position.left=inst._convertPositionTo("relative",{top:0,left:l-inst.helperProportions.width}).left-inst.margins.left;if(rs)ui.position.left=inst._convertPositionTo("relative",{top:0,left:r}).left-inst.margins.left}var first=ts||bs||ls||rs;if(o.snapMode!="outer"){var ts=Math.abs(t-y1)<=d;var bs=Math.abs(b-y2)<=d;var ls=Math.abs(l-x1)<=d;var rs=Math.abs(r-x2)<=d;if(ts)ui.position.top=inst._convertPositionTo("relative",{top:t,left:0}).top-inst.margins.top;if(bs)ui.position.top=inst._convertPositionTo("relative",{top:b-inst.helperProportions.height,left:0}).top-inst.margins.top;if(ls)ui.position.left=inst._convertPositionTo("relative",{top:0,left:l}).left-inst.margins.left;if(rs)ui.position.left=inst._convertPositionTo("relative",{top:0,left:r-inst.helperProportions.width}).left-inst.margins.left}if(!inst.snapElements[i].snapping&&(ts||bs||ls||rs||first))inst.options.snap.snap&&inst.options.snap.snap.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item}));inst.snapElements[i].snapping=ts||bs||ls||rs||first}}});$.ui.plugin.add("draggable","stack",{start:function(event,ui){var o=$(this).data("draggable").options;var group=$.makeArray($(o.stack)).sort(function(a,b){return(parseInt($(a).css("zIndex"),10)||0)-(parseInt($(b).css("zIndex"),10)||0)});if(!group.length){return}var min=parseInt(group[0].style.zIndex)||0;$(group).each(function(i){this.style.zIndex=min+i});this[0].style.zIndex=min+group.length}});$.ui.plugin.add("draggable","zIndex",{start:function(event,ui){var t=$(ui.helper),o=$(this).data("draggable").options;if(t.css("zIndex"))o._zIndex=t.css("zIndex");t.css("zIndex",o.zIndex)},stop:function(event,ui){var o=$(this).data("draggable").options;if(o._zIndex)$(ui.helper).css("zIndex",o._zIndex)}})})(jQuery);(function($,undefined){$.ui=$.ui||{};var horizontalPositions=/left|center|right/,verticalPositions=/top|center|bottom/,center="center",_position=$.fn.position,_offset=$.fn.offset;$.fn.position=function(options){if(!options||!options.of){return _position.apply(this,arguments)}options=$.extend({},options);var target=$(options.of),targetElem=target[0],collision=(options.collision||"flip").split(" "),offset=options.offset?options.offset.split(" "):[0,0],targetWidth,targetHeight,basePosition;if(targetElem.nodeType===9){targetWidth=target.width();targetHeight=target.height();basePosition={top:0,left:0}}else if(targetElem.setTimeout){targetWidth=target.width();targetHeight=target.height();basePosition={top:target.scrollTop(),left:target.scrollLeft()}}else if(targetElem.preventDefault){options.at="left top";targetWidth=targetHeight=0;basePosition={top:options.of.pageY,left:options.of.pageX}}else{targetWidth=target.outerWidth();targetHeight=target.outerHeight();basePosition=target.offset()}$.each(["my","at"],function(){var pos=(options[this]||"").split(" ");if(pos.length===1){pos=horizontalPositions.test(pos[0])?pos.concat([center]):verticalPositions.test(pos[0])?[center].concat(pos):[center,center]}pos[0]=horizontalPositions.test(pos[0])?pos[0]:center;pos[1]=verticalPositions.test(pos[1])?pos[1]:center;options[this]=pos});if(collision.length===1){collision[1]=collision[0]}offset[0]=parseInt(offset[0],10)||0;if(offset.length===1){offset[1]=offset[0]}offset[1]=parseInt(offset[1],10)||0;if(options.at[0]==="right"){basePosition.left+=targetWidth}else if(options.at[0]===center){basePosition.left+=targetWidth/2}if(options.at[1]==="bottom"){basePosition.top+=targetHeight}else if(options.at[1]===center){basePosition.top+=targetHeight/2}basePosition.left+=offset[0];basePosition.top+=offset[1];return this.each(function(){var elem=$(this),elemWidth=elem.outerWidth(),elemHeight=elem.outerHeight(),marginLeft=parseInt($.curCSS(this,"marginLeft",true))||0,marginTop=parseInt($.curCSS(this,"marginTop",true))||0,collisionWidth=elemWidth+marginLeft+(parseInt($.curCSS(this,"marginRight",true))||0),collisionHeight=elemHeight+marginTop+(parseInt($.curCSS(this,"marginBottom",true))||0),position=$.extend({},basePosition),collisionPosition;if(options.my[0]==="right"){position.left-=elemWidth}else if(options.my[0]===center){position.left-=elemWidth/2}if(options.my[1]==="bottom"){position.top-=elemHeight}else if(options.my[1]===center){position.top-=elemHeight/2}position.left=Math.round(position.left);position.top=Math.round(position.top);collisionPosition={left:position.left-marginLeft,top:position.top-marginTop};$.each(["left","top"],function(i,dir){if($.ui.position[collision[i]]){$.ui.position[collision[i]][dir](position,{targetWidth:targetWidth,targetHeight:targetHeight,elemWidth:elemWidth,elemHeight:elemHeight,collisionPosition:collisionPosition,collisionWidth:collisionWidth,collisionHeight:collisionHeight,offset:offset,my:options.my,at:options.at})}});if($.fn.bgiframe){elem.bgiframe()}elem.offset($.extend(position,{using:options.using}))})};$.ui.position={fit:{left:function(position,data){var win=$(window),over=data.collisionPosition.left+data.collisionWidth-win.width()-win.scrollLeft();position.left=over>0?position.left-over:Math.max(position.left-data.collisionPosition.left,position.left)},top:function(position,data){var win=$(window),over=data.collisionPosition.top+data.collisionHeight-win.height()-win.scrollTop();position.top=over>0?position.top-over:Math.max(position.top-data.collisionPosition.top,position.top)}},flip:{left:function(position,data){if(data.at[0]===center){return}var win=$(window),over=data.collisionPosition.left+data.collisionWidth-win.width()-win.scrollLeft(),myOffset=data.my[0]==="left"?-data.elemWidth:data.my[0]==="right"?data.elemWidth:0,atOffset=data.at[0]==="left"?data.targetWidth:-data.targetWidth,offset=-2*data.offset[0];position.left+=data.collisionPosition.left<0?myOffset+atOffset+offset:over>0?myOffset+atOffset+offset:0},top:function(position,data){if(data.at[1]===center){return}var win=$(window),over=data.collisionPosition.top+data.collisionHeight-win.height()-win.scrollTop(),myOffset=data.my[1]==="top"?-data.elemHeight:data.my[1]==="bottom"?data.elemHeight:0,atOffset=data.at[1]==="top"?data.targetHeight:-data.targetHeight,offset=-2*data.offset[1];position.top+=data.collisionPosition.top<0?myOffset+atOffset+offset:over>0?myOffset+atOffset+offset:0}}};if(!$.offset.setOffset){$.offset.setOffset=function(elem,options){if(/static/.test($.curCSS(elem,"position"))){elem.style.position="relative"}var curElem=$(elem),curOffset=curElem.offset(),curTop=parseInt($.curCSS(elem,"top",true),10)||0,curLeft=parseInt($.curCSS(elem,"left",true),10)||0,props={top:options.top-curOffset.top+curTop,left:options.left-curOffset.left+curLeft};if("using"in options){options.using.call(elem,props)}else{curElem.css(props)}};$.fn.offset=function(options){var elem=this[0];if(!elem||!elem.ownerDocument){return null}if(options){return this.each(function(){$.offset.setOffset(this,options)})}return _offset.call(this)}}})(jQuery);(function($,undefined){$.widget("ui.selectable",$.ui.mouse,{version:"@VERSION",options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch"},_create:function(){var self=this;this.element.addClass("ui-selectable");this.dragged=false;var selectees;this.refresh=function(){selectees=$(self.options.filter,self.element[0]);selectees.addClass("ui-selectee");selectees.each(function(){var $this=$(this);var pos=$this.offset();$.data(this,"selectable-item",{element:this,$element:$this,left:pos.left,top:pos.top,right:pos.left+$this.outerWidth(),bottom:pos.top+$this.outerHeight(),startselected:false,selected:$this.hasClass("ui-selected"),selecting:$this.hasClass("ui-selecting"),unselecting:$this.hasClass("ui-unselecting")})})};this.refresh();this.selectees=selectees.addClass("ui-selectee");this._mouseInit();this.helper=$("<div class='ui-selectable-helper'></div>")},destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable");this._mouseDestroy();return this},_mouseStart:function(event){var self=this;this.opos=[event.pageX,event.pageY];if(this.options.disabled)return;var options=this.options;this.selectees=$(options.filter,this.element[0]);this._trigger("start",event);$(options.appendTo).append(this.helper);this.helper.css({left:event.clientX,top:event.clientY,width:0,height:0});if(options.autoRefresh){this.refresh()}this.selectees.filter(".ui-selected").each(function(){var selectee=$.data(this,"selectable-item");selectee.startselected=true;if(!event.metaKey&&!event.ctrlKey){selectee.$element.removeClass("ui-selected");selectee.selected=false;selectee.$element.addClass("ui-unselecting");selectee.unselecting=true;self._trigger("unselecting",event,{unselecting:selectee.element})}});$(event.target).parents().andSelf().each(function(){var selectee=$.data(this,"selectable-item");if(selectee){var doSelect=!event.metaKey&&!event.ctrlKey||!selectee.$element.hasClass("ui-selected");selectee.$element.removeClass(doSelect?"ui-unselecting":"ui-selected").addClass(doSelect?"ui-selecting":"ui-unselecting");selectee.unselecting=!doSelect;selectee.selecting=doSelect;selectee.selected=doSelect;if(doSelect){self._trigger("selecting",event,{selecting:selectee.element})}else{self._trigger("unselecting",event,{unselecting:selectee.element})}return false}})},_mouseDrag:function(event){var self=this;this.dragged=true;if(this.options.disabled)return;var options=this.options;var x1=this.opos[0],y1=this.opos[1],x2=event.pageX,y2=event.pageY;if(x1>x2){var tmp=x2;x2=x1;x1=tmp}if(y1>y2){var tmp=y2;y2=y1;y1=tmp}this.helper.css({left:x1,top:y1,width:x2-x1,height:y2-y1});this.selectees.each(function(){var selectee=$.data(this,"selectable-item");if(!selectee||selectee.element==self.element[0])return;var hit=false;if(options.tolerance=="touch"){hit=!(selectee.left>x2||selectee.right<x1||selectee.top>y2||selectee.bottom<y1)}else if(options.tolerance=="fit"){hit=selectee.left>x1&&selectee.right<x2&&selectee.top>y1&&selectee.bottom<y2}if(hit){if(selectee.selected){selectee.$element.removeClass("ui-selected");selectee.selected=false}if(selectee.unselecting){selectee.$element.removeClass("ui-unselecting");selectee.unselecting=false}if(!selectee.selecting){selectee.$element.addClass("ui-selecting");selectee.selecting=true;self._trigger("selecting",event,{selecting:selectee.element})}}else{if(selectee.selecting){if((event.metaKey||event.ctrlKey)&&selectee.startselected){selectee.$element.removeClass("ui-selecting");selectee.selecting=false;selectee.$element.addClass("ui-selected");selectee.selected=true}else{selectee.$element.removeClass("ui-selecting");selectee.selecting=false;if(selectee.startselected){selectee.$element.addClass("ui-unselecting");selectee.unselecting=true}self._trigger("unselecting",event,{unselecting:selectee.element})}}if(selectee.selected){if(!event.metaKey&&!event.ctrlKey&&!selectee.startselected){selectee.$element.removeClass("ui-selected");selectee.selected=false;selectee.$element.addClass("ui-unselecting");selectee.unselecting=true;self._trigger("unselecting",event,{unselecting:selectee.element})}}}});return false},_mouseStop:function(event){var self=this;this.dragged=false;var options=this.options;$(".ui-unselecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");selectee.$element.removeClass("ui-unselecting");selectee.unselecting=false;selectee.startselected=false;self._trigger("unselected",event,{unselected:selectee.element})});$(".ui-selecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");selectee.$element.removeClass("ui-selecting").addClass("ui-selected");selectee.selecting=false;selectee.selected=true;selectee.startselected=true;self._trigger("selected",event,{selected:selectee.element})});this._trigger("stop",event);this.helper.remove();return false}})})(jQuery);!function($){"use strict";var Tooltip=function(element,options){this.init("tooltip",element,options)};Tooltip.prototype={constructor:Tooltip,init:function(type,element,options){var eventIn,eventOut;this.type=type;this.$element=$(element);this.options=this.getOptions(options);this.enabled=true;if(this.options.trigger!="manual"){eventIn=this.options.trigger=="hover"?"mouseenter":"focus";eventOut=this.options.trigger=="hover"?"mouseleave":"blur";this.$element.on(eventIn,this.options.selector,$.proxy(this.enter,this));this.$element.on(eventOut,this.options.selector,$.proxy(this.leave,this))}this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(options){options=$.extend({},$.fn[this.type].defaults,options,this.$element.data());if(options.delay&&typeof options.delay=="number"){options.delay={show:options.delay,hide:options.delay}}return options},enter:function(e){var self=$(e.currentTarget)[this.type](this._options).data(this.type);if(!self.options.delay||!self.options.delay.show)return self.show();clearTimeout(this.timeout);self.hoverState="in";this.timeout=setTimeout(function(){if(self.hoverState=="in")self.show()},self.options.delay.show)},leave:function(e){var self=$(e.currentTarget)[this.type](this._options).data(this.type);if(!self.options.delay||!self.options.delay.hide)return self.hide();clearTimeout(this.timeout);self.hoverState="out";this.timeout=setTimeout(function(){if(self.hoverState=="out")self.hide()},self.options.delay.hide)},show:function(){var $tip,inside,pos,actualWidth,actualHeight,placement,tp;if(this.hasContent()&&this.enabled){$tip=this.tip();this.setContent();if(this.options.animation){$tip.addClass("fade")}placement=typeof this.options.placement=="function"?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement;inside=/in/.test(placement);$tip.remove().css({top:0,left:0,display:"block"}).appendTo(inside?this.$element:document.body);pos=this.getPosition(inside);actualWidth=$tip[0].offsetWidth;actualHeight=$tip[0].offsetHeight;switch(inside?placement.split(" ")[1]:placement){case"bottom":tp={top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2};break;case"top":tp={top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2};break;case"left":tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth};break;case"right":tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width};break}$tip.css(tp).addClass(placement).addClass("in")}},isHTML:function(text){return typeof text!="string"||text.charAt(0)==="<"&&text.charAt(text.length-1)===">"&&text.length>=3||/^(?:[^<]*<[\w\W]+>[^>]*$)/.exec(text)},setContent:function(){var $tip=this.tip(),title=this.getTitle();$tip.find(".tooltip-inner")[this.isHTML(title)?"html":"text"](title);$tip.removeClass("fade in top bottom left right")},hide:function(){var that=this,$tip=this.tip();$tip.removeClass("in");function removeWithAnimation(){var timeout=setTimeout(function(){$tip.off($.support.transition.end).remove()},500);$tip.one($.support.transition.end,function(){clearTimeout(timeout);$tip.remove()})}$.support.transition&&this.$tip.hasClass("fade")?removeWithAnimation():$tip.remove()},fixTitle:function(){var $e=this.$element;if($e.attr("title")||typeof $e.attr("data-original-title")!="string"){$e.attr("data-original-title",$e.attr("title")||"").removeAttr("title")}},hasContent:function(){return this.getTitle()},getPosition:function(inside){return $.extend({},inside?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var title,$e=this.$element,o=this.options;title=$e.attr("data-original-title")||(typeof o.title=="function"?o.title.call($e[0]):o.title);return title},tip:function(){return this.$tip=this.$tip||$(this.options.template)},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}};$.fn.tooltip=function(option){return this.each(function(){var $this=$(this),data=$this.data("tooltip"),options=typeof option=="object"&&option;if(!data)$this.data("tooltip",data=new Tooltip(this,options));if(typeof option=="string")data[option]()})};$.fn.tooltip.Constructor=Tooltip;$.fn.tooltip.defaults={animation:true,placement:"top",selector:false,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0}}(window.jQuery);!function($){"use strict";var dismiss='[data-dismiss="alert"]',Alert=function(el){$(el).on("click",dismiss,this.close)};Alert.prototype={constructor:Alert,close:function(e){var $this=$(this),selector=$this.attr("data-target")||$this.attr("href"),$parent=$(selector);$parent.trigger("close");e&&e.preventDefault();$parent.length||($parent=$this.hasClass("alert")?$this:$this.parent());$parent.removeClass("in");function removeElement(){$parent.remove();$parent.trigger("closed")}$.support.transition&&$parent.hasClass("fade")?$parent.on($.support.transition.end,removeElement):removeElement()}};$.fn.alert=function(option){return this.each(function(){var $this=$(this),data=$this.data("alert");if(!data)$this.data("alert",data=new Alert(this));if(typeof option=="string")data[option].call($this)})};$.fn.alert.Constructor=Alert;$(function(){$("body").on("click.alert.data-api",dismiss,Alert.prototype.close)})}(window.jQuery);!function($){"use strict";var Button=function(element,options){this.$element=$(element);this.options=$.extend({},$.fn.button.defaults,options)};Button.prototype={constructor:Button,setState:function(state){var d="disabled",$el=this.$element,data=$el.data(),val=$el.is("input")?"val":"html";state=state+"Text";data.resetText||$el.data("resetText",$el[val]());$el[val](data[state]||this.options[state]);setTimeout(function(){state=="loadingText"?$el.addClass(d).attr(d,d):$el.removeClass(d).removeAttr(d)},0)},toggle:function(){var $parent=this.$element.parent('[data-toggle="buttons-radio"]');$parent&&$parent.find(".active").removeClass("active");this.$element.toggleClass("active")}};$.fn.button=function(option){return this.each(function(){var $this=$(this),data=$this.data("button"),options=typeof option=="object"&&option;if(!data)$this.data("button",data=new Button(this,options));if(option=="toggle")data.toggle();else if(option)data.setState(option)})};$.fn.button.defaults={loadingText:"loading..."};$.fn.button.Constructor=Button;$(function(){$("body").on("click.button.data-api","[data-toggle^=button]",function(e){$(e.target).button("toggle")})})}(window.jQuery);!function($){"use strict";var Carousel=function(element,options){this.$element=$(element);this.options=$.extend({},$.fn.carousel.defaults,options);this.options.slide&&this.slide(this.options.slide)};Carousel.prototype={cycle:function(){this.interval=setInterval($.proxy(this.next,this),this.options.interval);return this},to:function(pos){var $active=this.$element.find(".active"),children=$active.parent().children(),activePos=children.index($active),that=this;if(pos>children.length-1||pos<0)return;if(this.sliding){return this.$element.one("slid",function(){that.to(pos)})}if(activePos==pos){return this.pause().cycle()}return this.slide(pos>activePos?"next":"prev",$(children[pos]))},pause:function(){clearInterval(this.interval);return this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(type,next){var $active=this.$element.find(".active"),$next=next||$active[type](),isCycling=this.interval,direction=type=="next"?"left":"right",fallback=type=="next"?"first":"last",that=this;this.sliding=true;isCycling&&this.pause();$next=$next.length?$next:this.$element.find(".item")[fallback]();if(!$.support.transition&&this.$element.hasClass("slide")){this.$element.trigger("slide");$active.removeClass("active");$next.addClass("active");this.sliding=false;this.$element.trigger("slid")}else{$next.addClass(type);$next[0].offsetWidth;$active.addClass(direction);$next.addClass(direction);this.$element.trigger("slide");this.$element.one($.support.transition.end,function(){$next.removeClass([type,direction].join(" ")).addClass("active");$active.removeClass(["active",direction].join(" "));that.sliding=false;setTimeout(function(){that.$element.trigger("slid")},0)})}isCycling&&this.cycle();return this}};$.fn.carousel=function(option){return this.each(function(){var $this=$(this),data=$this.data("carousel"),options=typeof option=="object"&&option;if(!data)$this.data("carousel",data=new Carousel(this,options));if(typeof option=="number")data.to(option);else if(typeof option=="string"||(option=options.slide))data[option]();else data.cycle()})};$.fn.carousel.defaults={interval:5e3};$.fn.carousel.Constructor=Carousel;$(function(){$("body").on("click.carousel.data-api","[data-slide]",function(e){var $this=$(this),$target=$($this.attr("data-target")||$this.attr("href")),options=!$target.data("modal")&&$.extend({},$target.data(),$this.data());$target.carousel(options);e.preventDefault()})})}(window.jQuery);!function($){"use strict";var Collapse=function(element,options){this.$element=$(element);this.options=$.extend({},$.fn.collapse.defaults,options);if(this.options["parent"]){this.$parent=$(this.options["parent"])}this.options.toggle&&this.toggle()};Collapse.prototype={constructor:Collapse,dimension:function(){var hasWidth=this.$element.hasClass("width");return hasWidth?"width":"height"},show:function(){var dimension=this.dimension(),scroll=$.camelCase(["scroll",dimension].join("-")),actives=this.$parent&&this.$parent.find(".in"),hasData;if(actives&&actives.length){hasData=actives.data("collapse");actives.collapse("hide");hasData||actives.data("collapse",null)}this.$element[dimension](0);this.transition("addClass","show","shown");this.$element[dimension](this.$element[0][scroll])},hide:function(){var dimension=this.dimension();this.reset(this.$element[dimension]());this.transition("removeClass","hide","hidden");this.$element[dimension](0)},reset:function(size){var dimension=this.dimension();this.$element.removeClass("collapse")[dimension](size||"")[0].offsetWidth;this.$element.addClass("collapse")},transition:function(method,startEvent,completeEvent){var that=this,complete=function(){if(startEvent=="show")that.reset();that.$element.trigger(completeEvent)};this.$element.trigger(startEvent)[method]("in");$.support.transition&&this.$element.hasClass("collapse")?this.$element.one($.support.transition.end,complete):complete()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};$.fn.collapse=function(option){return this.each(function(){var $this=$(this),data=$this.data("collapse"),options=typeof option=="object"&&option;if(!data)$this.data("collapse",data=new Collapse(this,options));if(typeof option=="string")data[option]()})};$.fn.collapse.defaults={toggle:true};$.fn.collapse.Constructor=Collapse;$(function(){$("body").on("click.collapse.data-api","[data-toggle=collapse]",function(e){var $this=$(this),target=$this.attr("data-target")||e.preventDefault()||$this.attr("href"),option=$(target).data("collapse")?"toggle":$this.data();$(target).collapse(option)})})}(window.jQuery);!function($){var Datepicker=function(element,options){this.element=$(element);this.language=options.language in dates?options.language:"en";this.format=DPGlobal.parseFormat(options.format||this.element.data("date-format")||"mm/dd/yyyy");this.picker=$(DPGlobal.template).appendTo("body").on({click:$.proxy(this.click,this),mousedown:$.proxy(this.mousedown,this)});this.isInput=this.element.is("input");this.component=this.element.is(".date")?this.element.find(".add-on"):false;if(this.component&&this.component.length===0)this.component=false;if(this.isInput){this.element.on({focus:$.proxy(this.show,this),blur:$.proxy(this._hide,this),keyup:$.proxy(this.update,this),keydown:$.proxy(this.keydown,this)})}else{if(this.component){this.component.on("click",$.proxy(this.show,this))}else{this.element.on("click",$.proxy(this.show,this))}}this.autoclose=false;if("autoclose"in options){this.autoclose=options.autoclose}else if("dateAutoclose"in this.element.data()){this.autoclose=this.element.data("date-autoclose")}switch(options.startView){case 2:case"decade":this.viewMode=this.startViewMode=2;break;case 1:case"year":this.viewMode=this.startViewMode=1;break;case 0:case"month":default:this.viewMode=this.startViewMode=0;break}this.weekStart=options.weekStart||this.element.data("date-weekstart")||dates[this.language].weekStart||0;this.weekEnd=this.weekStart==0?6:this.weekStart-1;this.startDate=-Infinity;this.endDate=Infinity;this.setStartDate(options.startDate||this.element.data("date-startdate"));this.setEndDate(options.endDate||this.element.data("date-enddate"));this.fillDow();this.fillMonths();this.update();this.showMode()};Datepicker.prototype={constructor:Datepicker,show:function(e){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.place();$(window).on("resize",$.proxy(this.place,this));if(e){e.stopPropagation();e.preventDefault()}if(!this.isInput){$(document).on("mousedown",$.proxy(this.hide,this))}this.element.trigger({type:"show",date:this.date})},_hide:function(e){if($.browser.msie){var t=this,args=arguments;function cancel_hide(){clearTimeout(hide_timeout);e.target.focus();t.picker.off("click",cancel_hide)}function do_hide(){t.hide.apply(t,args);t.picker.off("click",cancel_hide)}this.picker.on("click",cancel_hide);var hide_timeout=setTimeout(do_hide,100)}else{return this.hide.apply(this,arguments)}},hide:function(e){this.picker.hide();$(window).off("resize",this.place);this.viewMode=this.startViewMode;this.showMode();if(!this.isInput){$(document).off("mousedown",this.hide)}if(e&&e.currentTarget.value)this.setValue();this.element.trigger({type:"hide",date:this.date})},setValue:function(){var formated=DPGlobal.formatDate(this.date,this.format,this.language);if(!this.isInput){if(this.component){this.element.find("input").prop("value",formated)}this.element.data("date",formated)}else{this.element.prop("value",formated)}},setStartDate:function(startDate){this.startDate=startDate||-Infinity;if(this.startDate!==-Infinity){this.startDate=DPGlobal.parseDate(this.startDate,this.format,this.language)}this.update();this.updateNavArrows()},setEndDate:function(endDate){this.endDate=endDate||Infinity;if(this.endDate!==Infinity){this.endDate=DPGlobal.parseDate(this.endDate,this.format,this.language)}this.update();this.updateNavArrows()},place:function(){var offset=this.component?this.component.offset():this.element.offset();this.picker.css({top:offset.top+this.height,left:offset.left})},update:function(){this.date=DPGlobal.parseDate(this.isInput?this.element.prop("value"):this.element.data("date"),this.format,this.language);if(this.date<this.startDate){this.viewDate=new Date(this.startDate)}else if(this.date>this.endDate){this.viewDate=new Date(this.endDate)}else{this.viewDate=new Date(this.date)}this.fill()},fillDow:function(){var dowCnt=this.weekStart;var html="<tr>";while(dowCnt<this.weekStart+7){html+='<th class="dow">'+dates[this.language].daysMin[dowCnt++%7]+"</th>"}html+="</tr>";this.picker.find(".datepicker-days thead").append(html)},fillMonths:function(){var html="";var i=0;while(i<12){html+='<span class="month">'+dates[this.language].monthsShort[i++]+"</span>"}this.picker.find(".datepicker-months td").html(html)},fill:function(){var d=new Date(this.viewDate),year=d.getFullYear(),month=d.getMonth(),startYear=this.startDate!==-Infinity?this.startDate.getFullYear():-Infinity,startMonth=this.startDate!==-Infinity?this.startDate.getMonth():-Infinity,endYear=this.endDate!==Infinity?this.endDate.getFullYear():Infinity,endMonth=this.endDate!==Infinity?this.endDate.getMonth():Infinity,currentDate=this.date.valueOf();this.picker.find(".datepicker-days th:eq(1)").text(dates[this.language].months[month]+" "+year);this.updateNavArrows();this.fillMonths();var prevMonth=new Date(year,month-1,28,0,0,0,0),day=DPGlobal.getDaysInMonth(prevMonth.getFullYear(),prevMonth.getMonth());prevMonth.setDate(day);prevMonth.setDate(day-(prevMonth.getDay()-this.weekStart+7)%7);var nextMonth=new Date(prevMonth);nextMonth.setDate(nextMonth.getDate()+42);nextMonth=nextMonth.valueOf();html=[];var clsName;while(prevMonth.valueOf()<nextMonth){if(prevMonth.getDay()==this.weekStart){html.push("<tr>")}clsName="";if(prevMonth.getFullYear()<year||prevMonth.getFullYear()==year&&prevMonth.getMonth()<month){clsName+=" old"}else if(prevMonth.getFullYear()>year||prevMonth.getFullYear()==year&&prevMonth.getMonth()>month){clsName+=" new"}if(prevMonth.valueOf()==currentDate){clsName+=" active"}if(prevMonth.valueOf()<this.startDate||prevMonth.valueOf()>this.endDate){clsName+=" disabled"}html.push('<td class="day'+clsName+'">'+prevMonth.getDate()+"</td>");if(prevMonth.getDay()==this.weekEnd){html.push("</tr>")}prevMonth.setDate(prevMonth.getDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(html.join(""));var currentYear=this.date.getFullYear();var months=this.picker.find(".datepicker-months").find("th:eq(1)").text(year).end().find("span").removeClass("active");if(currentYear==year){months.eq(this.date.getMonth()).addClass("active")}if(year<startYear||year>endYear){months.addClass("disabled")}if(year==startYear){months.slice(0,startMonth).addClass("disabled")}if(year==endYear){months.slice(endMonth+1).addClass("disabled")}html="";year=parseInt(year/10,10)*10;var yearCont=this.picker.find(".datepicker-years").find("th:eq(1)").text(year+"-"+(year+9)).end().find("td");year-=1;for(var i=-1;i<11;i++){html+='<span class="year'+(i==-1||i==10?" old":"")+(currentYear==year?" active":"")+(year<startYear||year>endYear?" disabled":"")+'">'+year+"</span>";year+=1}yearCont.html(html)},updateNavArrows:function(){var d=new Date(this.viewDate),year=d.getFullYear(),month=d.getMonth();switch(this.viewMode){case 0:if(this.startDate!==-Infinity&&year<=this.startDate.getFullYear()&&month<=this.startDate.getMonth()){this.picker.find(".prev").css({visibility:"hidden"})}else{this.picker.find(".prev").css({visibility:"visible"})}if(this.endDate!==Infinity&&year>=this.endDate.getFullYear()&&month>=this.endDate.getMonth()){this.picker.find(".next").css({visibility:"hidden"})}else{this.picker.find(".next").css({visibility:"visible"})}break;case 1:case 2:if(this.startDate!==-Infinity&&year<=this.startDate.getFullYear()){this.picker.find(".prev").css({visibility:"hidden"})}else{this.picker.find(".prev").css({visibility:"visible"})}if(this.endDate!==Infinity&&year>=this.endDate.getFullYear()){this.picker.find(".next").css({visibility:"hidden"})}else{this.picker.find(".next").css({visibility:"visible"})}break}},click:function(e){e.stopPropagation();e.preventDefault();var target=$(e.target).closest("span, td, th");if(target.length==1){switch(target[0].nodeName.toLowerCase()){case"th":switch(target[0].className){case"switch":this.showMode(1);break;case"prev":case"next":var dir=DPGlobal.modes[this.viewMode].navStep*(target[0].className=="prev"?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,dir);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,dir);break}this.fill();break}break;case"span":if(!target.is(".disabled")){if(target.is(".month")){var month=target.parent().find("span").index(target);this.viewDate.setMonth(month)}else{var year=parseInt(target.text(),10)||0;this.viewDate.setFullYear(year)}this.showMode(-1);this.fill()}break;case"td":if(target.is(".day")&&!target.is(".disabled")){var day=parseInt(target.text(),10)||1;var year=this.viewDate.getFullYear(),month=this.viewDate.getMonth();if(target.is(".old")){if(month==0){month=11;year-=1}else{month-=1}}else if(target.is(".new")){if(month==11){month=0;year+=1}else{month+=1}}this.date=new Date(year,month,day,0,0,0,0);this.viewDate=new Date(year,month,day,0,0,0,0);this.fill();this.setValue();this.element.trigger({type:"changeDate",date:this.date});var element;if(this.isInput){element=this.element}else if(this.component){element=this.element.find("input")}if(element){element.change();if(this.autoclose){element.blur()}}}break}}},mousedown:function(e){e.stopPropagation();e.preventDefault()},moveMonth:function(date,dir){if(!dir)return date;var new_date=new Date(date.valueOf()),day=new_date.getDate(),month=new_date.getMonth(),mag=Math.abs(dir),new_month,test;dir=dir>0?1:-1;if(mag==1){test=dir==-1?function(){return new_date.getMonth()==month}:function(){return new_date.getMonth()!=new_month};new_month=month+dir;new_date.setMonth(new_month);if(new_month<0||new_month>11)new_month=(new_month+12)%12}else{for(var i=0;i<mag;i++)new_date=this.moveMonth(new_date,dir);new_month=new_date.getMonth();new_date.setDate(day);test=function(){return new_month!=new_date.getMonth()}}while(test()){new_date.setDate(--day);new_date.setMonth(new_month)}return new_date},moveYear:function(date,dir){return this.moveMonth(date,dir*12)},keydown:function(e){if(this.picker.is(":not(:visible)")){if(e.keyCode==27)this.show();return}var dir,day,month;switch(e.keyCode){case 27:this.hide();e.preventDefault();break;case 37:case 39:dir=e.keyCode==37?-1:1;if(e.ctrlKey){this.date=this.moveYear(this.date,dir);this.viewDate=this.moveYear(this.viewDate,dir)}else if(e.shiftKey){this.date=this.moveMonth(this.date,dir);this.viewDate=this.moveMonth(this.viewDate,dir)}else{this.date.setDate(this.date.getDate()+dir);this.viewDate.setDate(this.viewDate.getDate()+dir)}this.setValue();this.update();e.preventDefault();break;case 38:case 40:dir=e.keyCode==38?-1:1;if(e.ctrlKey){this.date=this.moveYear(this.date,dir);this.viewDate=this.moveYear(this.viewDate,dir)}else if(e.shiftKey){this.date=this.moveMonth(this.date,dir);this.viewDate=this.moveMonth(this.viewDate,dir)}else{this.date.setDate(this.date.getDate()+dir*7);this.viewDate.setDate(this.viewDate.getDate()+dir*7)}this.setValue();this.update();e.preventDefault();break;case 13:this.hide();e.preventDefault();break}},showMode:function(dir){if(dir){this.viewMode=Math.max(0,Math.min(2,this.viewMode+dir))}this.picker.find(">div").hide().filter(".datepicker-"+DPGlobal.modes[this.viewMode].clsName).show();this.updateNavArrows()}};$.fn.datepicker=function(option){var args=Array.apply(null,arguments);args.shift();return this.each(function(){var $this=$(this),data=$this.data("datepicker"),options=typeof option=="object"&&option;if(!data){$this.data("datepicker",data=new Datepicker(this,$.extend({},$.fn.datepicker.defaults,options)))}if(typeof option=="string")data[option].apply(data,args)})};$.fn.datepicker.defaults={};$.fn.datepicker.Constructor=Datepicker;var dates=$.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}};var DPGlobal={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(year){return year%4===0&&year%100!==0||year%400===0},getDaysInMonth:function(year,month){return[31,DPGlobal.isLeapYear(year)?29:28,31,30,31,30,31,31,30,31,30,31][month]},validParts:/dd?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[-`{-~\t\n\r]+/g,parseFormat:function(format){var separators=format.split(this.validParts),parts=format.match(this.validParts);if(!separators||!separators.length||!parts||parts.length==0){throw new Error("Invalid date format.")}return{separators:separators,parts:parts}},parseDate:function(date,format,language){if(date instanceof Date)return date;if(/^[-+]\d+[dmwy]([\s,]+[-+]\d+[dmwy])*$/.test(date)){var part_re=/([-+]\d+)([dmwy])/,parts=date.match(/([-+]\d+)([dmwy])/g),part,dir;date=new Date;for(var i=0;i<parts.length;i++){part=part_re.exec(parts[i]);dir=parseInt(part[1]);switch(part[2]){case"d":date.setDate(date.getDate()+dir);break;case"m":date=Datepicker.prototype.moveMonth.call(Datepicker.prototype,date,dir);break;case"w":date.setDate(date.getDate()+dir*7);break;case"y":date=Datepicker.prototype.moveYear.call(Datepicker.prototype,date,dir);break}}return new Date(date.getFullYear(),date.getMonth(),date.getDate(),0,0,0)}var parts=date?date.match(this.nonpunctuation):[],date=new Date,val,filtered;date=new Date(date.getFullYear(),date.getMonth(),date.getDate(),0,0,0);if(parts.length==format.parts.length){for(var i=0,cnt=format.parts.length;i<cnt;i++){val=parseInt(parts[i],10)||1;switch(format.parts[i]){case"MM":filtered=$(dates[language].months).filter(function(){var m=this.slice(0,parts[i].length),p=parts[i].slice(0,m.length);return m==p});val=$.inArray(filtered[0],dates[language].months)+1;break;case"M":filtered=$(dates[language].monthsShort).filter(function(){var m=this.slice(0,parts[i].length),p=parts[i].slice(0,m.length);return m==p});val=$.inArray(filtered[0],dates[language].monthsShort)+1;break}switch(format.parts[i]){case"dd":case"d":date.setDate(val);break;case"mm":case"m":case"MM":case"M":date.setMonth(val-1);break;case"yy":date.setFullYear(2e3+val);break;case"yyyy":date.setFullYear(val);break}}}return date},formatDate:function(date,format,language){var val={d:date.getDate(),m:date.getMonth()+1,M:dates[language].monthsShort[date.getMonth()],MM:dates[language].months[date.getMonth()],yy:date.getFullYear().toString().substring(2),yyyy:date.getFullYear()};val.dd=(val.d<10?"0":"")+val.d;val.mm=(val.m<10?"0":"")+val.m;var date=[],seps=$.extend([],format.separators);for(var i=0,cnt=format.parts.length;i<cnt;i++){if(seps.length)date.push(seps.shift());date.push(val[format.parts[i]])}return date.join("")},headTemplate:"<thead>"+"<tr>"+'<th class="prev"><i class="icon-arrow-left"/></th>'+'<th colspan="5" class="switch"></th>'+'<th class="next"><i class="icon-arrow-right"/></th>'+"</tr>"+"</thead>",contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'};DPGlobal.template='<div class="datepicker dropdown-menu">'+'<div class="datepicker-days">'+'<table class=" table-condensed">'+DPGlobal.headTemplate+"<tbody></tbody>"+"</table>"+"</div>"+'<div class="datepicker-months">'+'<table class="table-condensed">'+DPGlobal.headTemplate+DPGlobal.contTemplate+"</table>"+"</div>"+'<div class="datepicker-years">'+'<table class="table-condensed">'+DPGlobal.headTemplate+DPGlobal.contTemplate+"</table>"+"</div>"+"</div>"}(window.jQuery);!function($){"use strict";var toggle='[data-toggle="dropdown"]',Dropdown=function(element){$(element).bind("click",this.toggle)};Dropdown.prototype={constructor:Dropdown,toggle:function(e){var $this=$(this),selector=$this.attr("data-target")||$this.attr("href"),$parent=$(selector),isActive;$parent.length||($parent=$this.parent());isActive=$parent.hasClass("open");clearMenus();!isActive&&$parent.toggleClass("open");return false}};function clearMenus(){$(toggle).parent().removeClass("open")}$.fn.dropdown=function(option){return this.each(function(){var $this=$(this),data=$this.data("dropdown");if(!data)$this.data("dropdown",data=new Dropdown(this));if(typeof option=="string")data[option].call($this)})};$.fn.dropdown.Constructor=Dropdown;$(function(){$(window).on("click.dropdown.data-api",clearMenus);$("body").on("click.dropdown.data-api",toggle,Dropdown.prototype.toggle)})}(window.jQuery);!function($){"use strict";var Modal=function(content,options){this.options=$.extend({},$.fn.modal.defaults,options);this.$element=$(content).delegate('[data-dismiss="modal"]',"click.dismiss.modal",$.proxy(this.hide,this))};Modal.prototype={constructor:Modal,toggle:function(){return this[!this.isShown?"show":"hide"]()},show:function(){var that=this;if(this.isShown)return;this.isShown=true;this.$element.trigger("show");escape.call(this);backdrop.call(this,function(){var transition=$.support.transition&&that.$element.hasClass("fade");!that.$element.parent().length&&that.$element.appendTo(document.body);that.$element.show();if(transition){that.$element[0].offsetWidth}that.$element.addClass("in");transition?that.$element.one($.support.transition.end,function(){that.$element.trigger("shown")}):that.$element.trigger("shown")})},hide:function(e){e&&e.preventDefault();if(!this.isShown)return;var that=this;this.isShown=false;escape.call(this);this.$element.trigger("hide").removeClass("in");$.support.transition&&this.$element.hasClass("fade")?hideWithTransition.call(this):hideModal.call(this)}};function hideWithTransition(){var that=this,timeout=setTimeout(function(){that.$element.off($.support.transition.end);hideModal.call(that)},500);this.$element.one($.support.transition.end,function(){clearTimeout(timeout);hideModal.call(that)})}function hideModal(that){this.$element.hide().trigger("hidden");backdrop.call(this)}function backdrop(callback){var that=this,animate=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var doAnimate=$.support.transition&&animate;this.$backdrop=$('<div class="modal-backdrop '+animate+'" />').appendTo(document.body);if(this.options.backdrop!="static"){this.$backdrop.click($.proxy(this.hide,this))}if(doAnimate)this.$backdrop[0].offsetWidth;this.$backdrop.addClass("in");doAnimate?this.$backdrop.one($.support.transition.end,callback):callback()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");$.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one($.support.transition.end,$.proxy(removeBackdrop,this)):removeBackdrop.call(this)}else if(callback){callback()}}function removeBackdrop(){this.$backdrop.remove();this.$backdrop=null}function escape(){var that=this;if(this.isShown&&this.options.keyboard){$(document).on("keyup.dismiss.modal",function(e){e.which==27&&that.hide()})}else if(!this.isShown){$(document).off("keyup.dismiss.modal")}}$.fn.modal=function(option){return this.each(function(){var $this=$(this),data=$this.data("modal"),options=typeof option=="object"&&option;if(!data)$this.data("modal",data=new Modal(this,options));if(typeof option=="string")data[option]();else data.show()})};$.fn.modal.defaults={backdrop:true,keyboard:true};$.fn.modal.Constructor=Modal;$(function(){$("body").on("click.modal.data-api",'[data-toggle="modal"]',function(e){var $this=$(this),$target=$($this.attr("data-target")||$this.attr("href")),option=$target.data("modal")?"toggle":$.extend({},$target.data(),$this.data());e.preventDefault();$target.modal(option)})})}(window.jQuery);!function($){"use strict";var Popover=function(element,options){this.init("popover",element,options)};Popover.prototype=$.extend({},$.fn.tooltip.Constructor.prototype,{constructor:Popover,setContent:function(){var $tip=this.tip(),title=this.getTitle(),content=this.getContent();$tip.find(".popover-title")[this.isHTML(title)?"html":"text"](title);$tip.find(".popover-content > *")[this.isHTML(content)?"html":"text"](content);$tip.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var content,$e=this.$element,o=this.options;content=$e.attr("data-content")||(typeof o.content=="function"?o.content.call($e[0]):o.content);return content},tip:function(){if(!this.$tip){this.$tip=$(this.options.template)}return this.$tip}});$.fn.popover=function(option){return this.each(function(){var $this=$(this),data=$this.data("popover"),options=typeof option=="object"&&option;if(!data)$this.data("popover",data=new Popover(this,options));if(typeof option=="string")data[option]()})};$.fn.popover.Constructor=Popover;$.fn.popover.defaults=$.extend({},$.fn.tooltip.defaults,{placement:"right",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery);!function($){"use strict";function ScrollSpy(element,options){var process=$.proxy(this.process,this),$element=$(element).is("body")?$(window):$(element);this.options=$.extend({},$.fn.scrollspy.defaults,options);this.$scrollElement=$element.on("scroll.scroll.data-api",process);this.selector=(this.options.target||$(element).attr("href")||"")+" .nav li > a";this.$body=$("body").on("click.scroll.data-api",this.selector,process);this.refresh();this.process()}ScrollSpy.prototype={constructor:ScrollSpy,refresh:function(){this.targets=this.$body.find(this.selector).map(function(){var href=$(this).attr("href");return/^#\w/.test(href)&&$(href).length?href:null});this.offsets=$.map(this.targets,function(id){return $(id).position().top})},process:function(){var scrollTop=this.$scrollElement.scrollTop()+this.options.offset,offsets=this.offsets,targets=this.targets,activeTarget=this.activeTarget,i;for(i=offsets.length;i--;){activeTarget!=targets[i]&&scrollTop>=offsets[i]&&(!offsets[i+1]||scrollTop<=offsets[i+1])&&this.activate(targets[i])}},activate:function(target){var active;this.activeTarget=target;this.$body.find(this.selector).parent(".active").removeClass("active");active=this.$body.find(this.selector+'[href="'+target+'"]').parent("li").addClass("active");if(active.parent(".dropdown-menu")){active.closest("li.dropdown").addClass("active")}}};$.fn.scrollspy=function(option){return this.each(function(){var $this=$(this),data=$this.data("scrollspy"),options=typeof option=="object"&&option;if(!data)$this.data("scrollspy",data=new ScrollSpy(this,options));if(typeof option=="string")data[option]()})};$.fn.scrollspy.Constructor=ScrollSpy;$.fn.scrollspy.defaults={offset:10};$(function(){$('[data-spy="scroll"]').each(function(){var $spy=$(this);$spy.scrollspy($spy.data())})})}(window.jQuery);!function($){"use strict";var Tab=function(element){this.element=$(element)};Tab.prototype={constructor:Tab,show:function(){var $this=this.element,$ul=$this.closest("ul:not(.dropdown-menu)"),href=$this.attr("data-target")||$this.attr("href"),previous,$href;if($this.parent("li").hasClass("active"))return;previous=$ul.find(".active a").last()[0];$this.trigger({type:"show",relatedTarget:previous});$href=$(href);this.activate($this.parent("li"),$ul);this.activate($href,$href.parent(),function(){$this.trigger({type:"shown",relatedTarget:previous})})},activate:function(element,container,callback){var $active=container.find("> .active"),transition=callback&&$.support.transition&&$active.hasClass("fade");function next(){$active.removeClass("active").find("> .dropdown-menu > .active").removeClass("active");element.addClass("active");if(transition){element[0].offsetWidth;element.addClass("in")}else{element.removeClass("fade")}if(element.parent(".dropdown-menu")){element.closest("li.dropdown").addClass("active")}callback&&callback()}transition?$active.one($.support.transition.end,next):next();$active.removeClass("in")}};$.fn.tab=function(option){return this.each(function(){var $this=$(this),data=$this.data("tab");if(!data)$this.data("tab",data=new Tab(this));if(typeof option=="string")data[option]()})};$.fn.tab.Constructor=Tab;$(function(){$("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(e){e.preventDefault();$(this).tab("show")})})}(window.jQuery);!function($){$(function(){"use strict";$.support.transition=function(){var thisBody=document.body||document.documentElement,thisStyle=thisBody.style,support=thisStyle.transition!==undefined||thisStyle.WebkitTransition!==undefined||thisStyle.MozTransition!==undefined||thisStyle.MsTransition!==undefined||thisStyle.OTransition!==undefined;return support&&{end:function(){var transitionEnd="TransitionEnd";if($.browser.webkit){transitionEnd="webkitTransitionEnd"}else if($.browser.mozilla){transitionEnd="transitionend"}else if($.browser.opera){transitionEnd="oTransitionEnd"}return transitionEnd}()}}()})}(window.jQuery);!function($){"use strict";var Twipsy=function(element,options){this.$element=$(element);this.options=options;this.enabled=true;this.fixTitle()};Twipsy.prototype={show:function(){var pos,actualWidth,actualHeight,placement,$tip,tp;if(this.hasContent()&&this.enabled){$tip=this.tip();this.setContent();if(this.options.animate){$tip.addClass("fade")}$tip.remove().css({top:0,left:0,display:"block"}).prependTo(document.body);pos=$.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight});actualWidth=$tip[0].offsetWidth;actualHeight=$tip[0].offsetHeight;placement=maybeCall(this.options.placement,this,[$tip[0],this.$element[0]]);switch(placement){case"below":tp={top:pos.top+pos.height+this.options.offset,left:pos.left+pos.width/2-actualWidth/2};break;case"above":tp={top:pos.top-actualHeight-this.options.offset,left:pos.left+pos.width/2-actualWidth/2};break;case"left":tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth-this.options.offset};break;case"right":tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width+this.options.offset};break}$tip.css(tp).addClass(placement).addClass("in")}},setContent:function(){var $tip=this.tip();$tip.find(".twipsy-inner").html(this.getTitle());$tip[0].className="twipsy"},hide:function(){var that=this,$tip=this.tip();$tip.removeClass("in");function removeElement(){$tip.remove()}$.support.transition&&this.$tip.hasClass("fade")?$tip.bind($.support.transition.end,removeElement):removeElement()},fixTitle:function(){var $e=this.$element;if($e.attr("title")||typeof $e.attr("data-original-title")!="string"){$e.attr("data-original-title",$e.attr("title")||"").removeAttr("title")}},hasContent:function(){return this.getTitle()},getTitle:function(){var title,$e=this.$element,o=this.options;this.fixTitle();if(typeof o.title=="string"){title=$e.attr(o.title=="title"?"data-original-title":o.title)}else if(typeof o.title=="function"){title=o.title.call($e[0])}title=(""+title).replace(/(^\s*|\s*$)/,"");return title},tip:function(){return this.$tip=this.$tip||$('<div class="twipsy" />').html(this.options.template)},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}};function maybeCall(thing,ctx,args){return typeof thing=="function"?thing.apply(ctx,args):thing}$.fn.twipsy=function(options){$.fn.twipsy.initWith.call(this,options,Twipsy,"twipsy");return this};$.fn.twipsy.initWith=function(options,Constructor,name){var twipsy,binder,eventIn,eventOut;if(typeof options=="string"){return this.each(function(){twipsy=$.data(this,name);if(twipsy)twipsy[options]()})}options=$.extend({},$.fn[name].defaults,options);if(options.delay&&typeof options.delay=="number"){options.delay={show:options.delay,hide:options.delay}}function get(ele){var twipsy=$.data(ele,name);if(!twipsy){twipsy=new Constructor(ele,$.fn.twipsy.elementOptions(ele,options));$.data(ele,name,twipsy)}return twipsy}function enter(){var twipsy=get(this);twipsy.hoverState="in";if(!options.delay||!options.delay.show){twipsy.show()}else{twipsy.fixTitle();setTimeout(function(){if(twipsy.hoverState=="in"){twipsy.show()}},options.delay.show)}}function leave(){var twipsy=get(this);twipsy.hoverState="out";if(!options.delay||!options.delay.hide){twipsy.hide()}else{setTimeout(function(){if(twipsy.hoverState=="out"){twipsy.hide()}},options.delay.hide)}}if(!options.live){this.each(function(){get(this)})}if(options.trigger!="manual"){binder=options.live?"live":"bind";eventIn=options.trigger=="hover"?"mouseenter":"focus";eventOut=options.trigger=="hover"?"mouseleave":"blur";this[binder](eventIn,enter)[binder](eventOut,leave)}return this};$.fn.twipsy.Twipsy=Twipsy;$.fn.twipsy.defaults={animate:true,delay:0,placement:"above",live:false,offset:0,trigger:"hover",title:"title",template:'<div class="twipsy-arrow"></div><div class="twipsy-inner"></div>'};$.fn.twipsy.rejectAttrOptions=["title"];$.fn.twipsy.elementOptions=function(ele,options){var data=$(ele).data(),rejects=$.fn.twipsy.rejectAttrOptions,i=rejects.length;while(i--){delete data[rejects[i]]}return $.extend({},options,data)}}(window.jQuery||window.ender);!function($){"use strict";var Typeahead=function(element,options){this.$element=$(element);this.options=$.extend({},$.fn.typeahead.defaults,options);this.$menu=$(this.options.menu).appendTo("body");this.data=this.options.data;this.shown=false;this.listen()};Typeahead.prototype={constructor:Typeahead,matcher:function(item,query){return~item.toLowerCase().indexOf(query)},select:function(){var val=this.$menu.find(".active").attr("data-value");this.$element.val(val);return this.hide()},show:function(){var pos=$.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});this.$menu.css({top:pos.top+pos.height,left:pos.left});this.$menu.show();this.shown=true;return this},hide:function(){this.$menu.hide();this.shown=false;return this},lookup:function(event){var that=this,items,q;this.query=this.$element.val();if(!this.query){return this.shown?this.hide():this}q=this.query.toLowerCase();items=jQuery.grep(this.data,function(item){if(that.matcher(item,q))return item});if(!items.length){return this.shown?this.hide():this}return this.render(items.slice(0,this.options.items)).show()},render:function(items){var that=this,QUERY=new RegExp("("+this.query+")","ig");items=$(items).map(function(i,item){i=$(that.options.item).attr("data-value",item);i.find("a").html(item.replace(QUERY,function($1,match){return"<strong>"+match+"</strong>"}));return i[0]});items.first().addClass("active");this.$menu.html(items);return this},next:function(event){var active=this.$menu.find(".active").removeClass("active"),next=active.next();if(!next.length){next=$(this.$menu.find("li")[0])}next.addClass("active")},prev:function(event){var active=this.$menu.find(".active").removeClass("active"),prev=active.prev();if(!prev.length){prev=this.$menu.find("li").last()}prev.addClass("active")},listen:function(){this.$element.on("blur",$.proxy(this.blur,this)).on("keypress",$.proxy(this.keypress,this)).on("keyup",$.proxy(this.keyup,this));if($.browser.webkit||$.browser.msie){this.$element.on("keydown",$.proxy(this.keypress,this))}this.$menu.on("click",$.proxy(this.click,this)).on("mouseenter","li",$.proxy(this.mouseenter,this))},keyup:function(e){e.stopPropagation();e.preventDefault();switch(e.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:this.hide();break;default:this.lookup()}},keypress:function(e){e.stopPropagation();if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault();this.prev();break;case 40:e.preventDefault();this.next();break}},blur:function(e){var that=this;e.stopPropagation();e.preventDefault();setTimeout(function(){that.hide()},150)},click:function(e){e.stopPropagation();e.preventDefault();this.select()},mouseenter:function(e){this.$menu.find(".active").removeClass("active");$(e.currentTarget).addClass("active")}};$.fn.typeahead=function(option){return this.each(function(){var $this=$(this),data=$this.data("typeahead"),options=typeof option=="object"&&option;if(!data)$this.data("typeahead",data=new Typeahead(this,options));if(typeof option=="string")data[option]()})};$.fn.typeahead.defaults={items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>'};$.fn.typeahead.Constructor=Typeahead;$(function(){$("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(e){var $this=$(this);if($this.data("typeahead"))return;e.preventDefault();$this.typeahead($this.data())})})}(window.jQuery);(function(window,$,undefined){$.fn.touchwipe=function(settings){var config={min_move_x:20,min_move_y:20,wipeLeft:function(){},wipeRight:function(){},wipeUp:function(){},wipeDown:function(){},preventDefaultEvents:true};if(settings)$.extend(config,settings);this.each(function(){var startX;var startY;var isMoving=false;function cancelTouch(){this.removeEventListener("touchmove",onTouchMove);startX=null;isMoving=false}function onTouchMove(e){if(config.preventDefaultEvents){e.preventDefault()}if(isMoving){var x=e.touches[0].pageX;var y=e.touches[0].pageY;var dx=startX-x;var dy=startY-y;if(Math.abs(dx)>=config.min_move_x){cancelTouch();if(dx>0){config.wipeLeft()}else{config.wipeRight()}}else if(Math.abs(dy)>=config.min_move_y){cancelTouch();if(dy>0){config.wipeDown()}else{config.wipeUp()}}}}function onTouchStart(e){if(e.touches.length==1){startX=e.touches[0].pageX;startY=e.touches[0].pageY;isMoving=true;this.addEventListener("touchmove",onTouchMove,false)}}if("ontouchstart"in document.documentElement){this.addEventListener("touchstart",onTouchStart,false)}});return this};$.elastislide=function(options,element){this.$el=$(element);this._init(options)};$.elastislide.defaults={speed:450,easing:"",imageW:190,margin:3,border:2,minItems:1,current:0,onClick:function(){return false},onSlide:function(){return false}};$.elastislide.prototype={_init:function(options){this.options=$.extend(true,{},$.elastislide.defaults,options);this.$slider=this.$el.find("ul");this.$items=this.$slider.children("li");this.itemsCount=this.$items.length;this.$esCarousel=this.$slider.parent();this._validateOptions();this._configure();this._addControls();this._initEvents();this.$slider.show();this._slideToCurrent(false)},_validateOptions:function(){if(this.options.speed<0)this.options.speed=450;if(this.options.margin<0)this.options.margin=4;if(this.options.border<0)this.options.border=1;if(this.options.minItems<1||this.options.minItems>this.itemsCount)this.options.minItems=1;if(this.options.current>this.itemsCount-1)this.options.current=0},_configure:function(){this.current=this.options.current;this.visibleWidth=this.$esCarousel.width();if(this.visibleWidth<this.options.minItems*(this.options.imageW+2*this.options.border)+(this.options.minItems-1)*this.options.margin){this._setDim((this.visibleWidth-(this.options.minItems-1)*this.options.margin)/this.options.minItems);this._setCurrentValues();this.fitCount=this.options.minItems}else{this._setDim();this._setCurrentValues()}this.$slider.css({width:this.sliderW})},_setDim:function(elW){this.$items.css({marginRight:this.options.margin,width:elW?elW:this.options.imageW+2*this.options.border}).children("a").css({borderWidth:this.options.border})},_setCurrentValues:function(){this.itemW=this.$items.outerWidth(true);this.sliderW=this.itemW*this.itemsCount;this.visibleWidth=this.$esCarousel.width();this.fitCount=Math.floor(this.visibleWidth/this.itemW)},_addControls:function(){this.$navNext=$('<span class="es-nav-next">Next</span>');this.$navPrev=$('<span class="es-nav-prev">Previous</span>');$('<div class="es-nav"/>').append(this.$navPrev).append(this.$navNext).appendTo(this.$el)},_toggleControls:function(dir,status){if(dir&&status){if(status===1)dir==="right"?this.$navNext.show():this.$navPrev.show();else dir==="right"?this.$navNext.hide():this.$navPrev.hide()}else if(this.current===this.itemsCount-1||this.fitCount>=this.itemsCount)this.$navNext.hide()},_initEvents:function(){var instance=this;$(window).bind("resize.elastislide",function(event){instance._reload();clearTimeout(instance.resetTimeout);instance.resetTimeout=setTimeout(function(){instance._slideToCurrent()},200)});this.$navNext.bind("click.elastislide",function(event){$(".overlay").addClass("hidden");instance._slide("right");$(".overlay").removeClass("hidden")});this.$navPrev.bind("click.elastislide",function(event){$(".overlay").addClass("hidden");instance._slide("left");$(".overlay").removeClass("hidden")});this.$items.bind("click.elastislide",function(event){instance.options.onClick($(this));return false});instance.$slider.touchwipe({wipeLeft:function(){$(".overlay").addClass("hidden");instance._slide("right");$(".overlay").removeClass("hidden")},wipeRight:function(){$(".overlay").addClass("hidden");instance._slide("left");$(".overlay").removeClass("hidden")}})},reload:function(callback){this._reload();if(callback)callback.call()},_reload:function(){var instance=this;instance._setCurrentValues();if(instance.visibleWidth<instance.options.minItems*(instance.options.imageW+2*instance.options.border)+(instance.options.minItems-1)*instance.options.margin){instance._setDim((instance.visibleWidth-(instance.options.minItems-1)*instance.options.margin)/instance.options.minItems);instance._setCurrentValues();instance.fitCount=instance.options.minItems}else{instance._setDim();instance._setCurrentValues()}instance.$slider.css({width:instance.sliderW+10})},_slide:function(dir,val,anim,callback){var ml=parseFloat(this.$slider.css("margin-left"));if(val===undefined){var amount=this.fitCount*this.itemW,val;if(amount<0)return false;if(dir==="right"&&this.sliderW-(Math.abs(ml)+amount)<this.visibleWidth){amount=this.sliderW-(Math.abs(ml)+this.visibleWidth)-this.options.margin;this._toggleControls("right",-1);this._toggleControls("left",1)}else if(dir==="left"&&Math.abs(ml)-amount<0){amount=Math.abs(ml);this._toggleControls("left",-1);this._toggleControls("right",1)}else{var fml;dir==="right"?fml=Math.abs(ml)+this.options.margin+Math.abs(amount):fml=Math.abs(ml)-this.options.margin-Math.abs(amount);if(fml>0)this._toggleControls("left",1);else this._toggleControls("left",-1);if(fml<this.sliderW-this.visibleWidth)this._toggleControls("right",1);else this._toggleControls("right",-1)}dir==="right"?val="-="+amount:val="+="+amount}else{var fml=Math.abs(val);if(Math.max(this.sliderW,this.visibleWidth)-fml<this.visibleWidth){val=-(Math.max(this.sliderW,this.visibleWidth)-this.visibleWidth);if(val!==0)val+=this.options.margin;this._toggleControls("right",-1);fml=Math.abs(val)}if(fml>0)this._toggleControls("left",1);else this._toggleControls("left",-1);if(Math.max(this.sliderW,this.visibleWidth)-this.visibleWidth>fml+this.options.margin)this._toggleControls("right",1);else this._toggleControls("right",-1)}var first;if(fml===0)first=0;else if(fml===undefined){if(this.$navPrev.is(":hidden"))first=0;else first=this.itemsCount-this.fitCount}else first=Math.round(fml/this.itemW);var last=first+this.fitCount;this.options.onSlide(first,last);$.fn.applyStyle=anim===undefined?$.fn.animate:$.fn.css;var sliderCSS={marginLeft:val};var instance=this;this.$slider.stop().applyStyle(sliderCSS,$.extend(true,[],{duration:this.options.speed,easing:this.options.easing,complete:function(){if(callback)callback.call()}}))},_slideToCurrent:function(anim){var amount=this.current*this.itemW;this._slide("",-amount,anim)},slideToIndex:function(index){var amount=index*this.itemW;this._slide("",-amount,false)},add:function($newelems,callback){this.$items=this.$items.add($newelems);this.$slider.append($newelems);this.itemsCount=this.$items.length;this._setDim();this._setCurrentValues();this.$slider.css({width:this.sliderW});this._slideToCurrent();if(callback)callback.call($newelems)},getIndex:function(){},setCurrent:function(idx,callback){this.current=idx;var ml=Math.abs(parseFloat(this.$slider.css("margin-left"))),posR=ml+this.visibleWidth,fml=Math.abs(this.current*this.itemW);if(fml+this.itemW>posR||fml<ml){this._slideToCurrent()}if(callback)callback.call()},destroy:function(callback){this._destroy(callback)},_destroy:function(callback){this.$el.unbind(".elastislide").removeData("elastislide");$(window).unbind(".elastislide");if(callback)callback.call()}};var logError=function(message){if(this.console){console.error(message)}};$.fn.elastislide=function(options){if(typeof options==="string"){var args=Array.prototype.slice.call(arguments,1);this.each(function(){var instance=$.data(this,"elastislide");if(!instance){return}if(!$.isFunction(instance[options])||options.charAt(0)==="_"){logError("no such method '"+options+"' for elastislide instance");return}instance[options].apply(instance,args)})}else{this.each(function(){var instance=$.data(this,"elastislide");if(!instance){$.data(this,"elastislide",new $.elastislide(options,this))}})}return this}})(window,jQuery);(function(factory){"use strict";if(typeof define==="function"&&define.amd){define(["jquery","./vendor/jquery.ui.widget","./jquery.iframe-transport"],factory)}else{factory(window.jQuery)}})(function($){"use strict";$.widget("blueimp.fileupload",{options:{namespace:undefined,dropZone:$(document),fileInput:undefined,replaceFileInput:true,paramName:undefined,singleFileUploads:true,limitMultiFileUploads:undefined,sequentialUploads:false,limitConcurrentUploads:undefined,forceIframeTransport:false,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:true,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:true,formData:function(form){return form.serializeArray()},add:function(e,data){data.submit()},processData:false,contentType:false,cache:false},_refreshOptionsList:["namespace","dropZone","fileInput"],_isXHRUpload:function(options){var undef="undefined";return!options.forceIframeTransport&&typeof XMLHttpRequestUpload!==undef&&typeof File!==undef&&(!options.multipart||typeof FormData!==undef)},_getFormData:function(options){var formData;if(typeof options.formData==="function"){return options.formData(options.form)}else if($.isArray(options.formData)){return options.formData}else if(options.formData){formData=[];$.each(options.formData,function(name,value){formData.push({name:name,value:value})});return formData}return[]},_getTotal:function(files){var total=0;$.each(files,function(index,file){total+=file.size||1});return total},_onProgress:function(e,data){if(e.lengthComputable){var total=data.total||this._getTotal(data.files),loaded=parseInt(e.loaded/e.total*(data.chunkSize||total),10)+(data.uploadedBytes||0);this._loaded+=loaded-(data.loaded||data.uploadedBytes||0);data.lengthComputable=true;data.loaded=loaded;data.total=total;this._trigger("progress",e,data);this._trigger("progressall",e,{lengthComputable:true,loaded:this._loaded,total:this._total})}},_initProgressListener:function(options){var that=this,xhr=options.xhr?options.xhr():$.ajaxSettings.xhr();if(xhr.upload){$(xhr.upload).bind("progress",function(e){var oe=e.originalEvent;e.lengthComputable=oe.lengthComputable;e.loaded=oe.loaded;e.total=oe.total;that._onProgress(e,options)});options.xhr=function(){return xhr}}},_initXHRData:function(options){var formData,file=options.files[0];if(!options.multipart||options.blob){options.headers=$.extend(options.headers,{"X-File-Name":file.name,"X-File-Type":file.type,"X-File-Size":file.size});if(!options.blob){options.contentType=file.type;options.data=file}else if(!options.multipart){options.contentType="application/octet-stream";options.data=options.blob}}if(options.multipart&&typeof FormData!=="undefined"){if(options.postMessage){formData=this._getFormData(options);if(options.blob){formData.push({name:options.paramName,value:options.blob})}else{$.each(options.files,function(index,file){formData.push({name:options.paramName,value:file})})}}else{if(options.formData instanceof FormData){formData=options.formData}else{formData=new FormData;$.each(this._getFormData(options),function(index,field){formData.append(field.name,field.value)})}if(options.blob){formData.append(options.paramName,options.blob,file.name)}else{$.each(options.files,function(index,file){if(file instanceof Blob){formData.append(options.paramName,file,file.name)}})}}options.data=formData}options.blob=null},_initIframeSettings:function(options){options.dataType="iframe "+(options.dataType||"");options.formData=this._getFormData(options);if(options.redirect&&$("<a></a>").prop("href",options.url).prop("host")!==location.host){options.formData.push({name:options.redirectParamName||"redirect",value:options.redirect})}},_initDataSettings:function(options){if(this._isXHRUpload(options)){if(!this._chunkedUpload(options,true)){if(!options.data){this._initXHRData(options)}this._initProgressListener(options)}if(options.postMessage){options.dataType="postmessage "+(options.dataType||"")}}else{this._initIframeSettings(options,"iframe")}},_initFormSettings:function(options){if(!options.form||!options.form.length){options.form=$(options.fileInput.prop("form"))}if(!options.paramName){options.paramName=options.fileInput.prop("name")||"files[]"}if(!options.url){options.url=options.form.prop("action")||location.href}options.type=(options.type||options.form.prop("method")||"").toUpperCase();if(options.type!=="POST"&&options.type!=="PUT"){options.type="POST"}},_getAJAXSettings:function(data){var options=$.extend({},this.options,data);this._initFormSettings(options);this._initDataSettings(options);return options},_enhancePromise:function(promise){promise.success=promise.done;promise.error=promise.fail;promise.complete=promise.always;return promise},_getXHRPromise:function(resolveOrReject,context,args){var dfd=$.Deferred(),promise=dfd.promise();context=context||this.options.context||promise;if(resolveOrReject===true){dfd.resolveWith(context,args)}else if(resolveOrReject===false){dfd.rejectWith(context,args)}promise.abort=dfd.promise;return this._enhancePromise(promise)},_chunkedUpload:function(options,testOnly){var that=this,file=options.files[0],fs=file.size,ub=options.uploadedBytes=options.uploadedBytes||0,mcs=options.maxChunkSize||fs,slice=file.webkitSlice||file.mozSlice||file.slice,upload,n,jqXHR,pipe;if(!(this._isXHRUpload(options)&&slice&&(ub||mcs<fs))||options.data){return false}if(testOnly){return true}if(ub>=fs){file.error="uploadedBytes";return this._getXHRPromise(false,options.context,[null,"error",file.error])}n=Math.ceil((fs-ub)/mcs);upload=function(i){if(!i){return that._getXHRPromise(true,options.context)}return upload(i-=1).pipe(function(){var o=$.extend({},options);o.blob=slice.call(file,ub+i*mcs,ub+(i+1)*mcs);o.chunkSize=o.blob.size;that._initXHRData(o);that._initProgressListener(o);jqXHR=($.ajax(o)||that._getXHRPromise(false,o.context)).done(function(){if(!o.loaded){that._onProgress($.Event("progress",{lengthComputable:true,loaded:o.chunkSize,total:o.chunkSize}),o)}options.uploadedBytes=o.uploadedBytes+=o.chunkSize});return jqXHR})};pipe=upload(n);pipe.abort=function(){return jqXHR.abort()};return this._enhancePromise(pipe)},_beforeSend:function(e,data){if(this._active===0){this._trigger("start")}this._active+=1;this._loaded+=data.uploadedBytes||0;this._total+=this._getTotal(data.files)},_onDone:function(result,textStatus,jqXHR,options){if(!this._isXHRUpload(options)){this._onProgress($.Event("progress",{lengthComputable:true,loaded:1,total:1}),options)}options.result=result;options.textStatus=textStatus;options.jqXHR=jqXHR;this._trigger("done",null,options)},_onFail:function(jqXHR,textStatus,errorThrown,options){options.jqXHR=jqXHR;options.textStatus=textStatus;options.errorThrown=errorThrown;this._trigger("fail",null,options);if(options.recalculateProgress){this._loaded-=options.loaded||options.uploadedBytes||0;this._total-=options.total||this._getTotal(options.files)}},_onAlways:function(jqXHRorResult,textStatus,jqXHRorError,options){this._active-=1;options.textStatus=textStatus;if(jqXHRorError&&jqXHRorError.always){options.jqXHR=jqXHRorError;options.result=jqXHRorResult}else{options.jqXHR=jqXHRorResult;options.errorThrown=jqXHRorError}this._trigger("always",null,options);if(this._active===0){this._trigger("stop");this._loaded=this._total=0}},_onSend:function(e,data){var that=this,jqXHR,slot,pipe,options=that._getAJAXSettings(data),send=function(resolve,args){that._sending+=1;jqXHR=jqXHR||(resolve!==false&&that._trigger("send",e,options)!==false&&(that._chunkedUpload(options)||$.ajax(options))||that._getXHRPromise(false,options.context,args)).done(function(result,textStatus,jqXHR){that._onDone(result,textStatus,jqXHR,options)}).fail(function(jqXHR,textStatus,errorThrown){that._onFail(jqXHR,textStatus,errorThrown,options)}).always(function(jqXHRorResult,textStatus,jqXHRorError){that._sending-=1;that._onAlways(jqXHRorResult,textStatus,jqXHRorError,options);if(options.limitConcurrentUploads&&options.limitConcurrentUploads>that._sending){var nextSlot=that._slots.shift();while(nextSlot){if(!nextSlot.isRejected()){nextSlot.resolve();break}nextSlot=that._slots.shift()}}});return jqXHR};this._beforeSend(e,options);if(this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending){if(this.options.limitConcurrentUploads>1){slot=$.Deferred();this._slots.push(slot);pipe=slot.pipe(send)}else{pipe=this._sequence=this._sequence.pipe(send,send)}pipe.abort=function(){var args=[undefined,"abort","abort"];if(!jqXHR){if(slot){slot.rejectWith(args)}return send(false,args)}return jqXHR.abort()};return this._enhancePromise(pipe)}return send()},_onAdd:function(e,data){var that=this,result=true,options=$.extend({},this.options,data),limit=options.limitMultiFileUploads,fileSet,i;if(!(options.singleFileUploads||limit)||!this._isXHRUpload(options)){fileSet=[data.files]}else if(!options.singleFileUploads&&limit){fileSet=[];for(i=0;i<data.files.length;i+=limit){fileSet.push(data.files.slice(i,i+limit))}}data.originalFiles=data.files;$.each(fileSet||data.files,function(index,element){var files=fileSet?element:[element],newData=$.extend({},data,{files:files});newData.submit=function(){newData.jqXHR=this.jqXHR=that._trigger("submit",e,this)!==false&&that._onSend(e,this);return this.jqXHR};return result=that._trigger("add",e,newData)});return result},_normalizeFile:function(index,file){if(file.name===undefined&&file.size===undefined){file.name=file.fileName;file.size=file.fileSize}},_replaceFileInput:function(input){var inputClone=input.clone(true);$("<form></form>").append(inputClone)[0].reset();input.after(inputClone).detach();$.cleanData(input.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(i,el){if(el===input[0]){return inputClone[0]}return el});if(input[0]===this.element[0]){this.element=inputClone}},_onChange:function(e){var that=e.data.fileupload,data={files:$.each($.makeArray(e.target.files),that._normalizeFile),fileInput:$(e.target),form:$(e.target.form)};if(!data.files.length){data.files=[{name:e.target.value.replace(/^.*\\/,"")}]}if(that.options.replaceFileInput){that._replaceFileInput(data.fileInput)}if(that._trigger("change",e,data)===false||that._onAdd(e,data)===false){return false}},_onPaste:function(e){var that=e.data.fileupload,cbd=e.originalEvent.clipboardData,items=cbd&&cbd.items||[],data={files:[]};$.each(items,function(index,item){var file=item.getAsFile&&item.getAsFile();if(file){data.files.push(file)}});if(that._trigger("paste",e,data)===false||that._onAdd(e,data)===false){return false}},_onDrop:function(e){var that=e.data.fileupload,dataTransfer=e.dataTransfer=e.originalEvent.dataTransfer,data={files:$.each($.makeArray(dataTransfer&&dataTransfer.files),that._normalizeFile)};if(that._trigger("drop",e,data)===false||that._onAdd(e,data)===false){return false}e.preventDefault()},_onDragOver:function(e){var that=e.data.fileupload,dataTransfer=e.dataTransfer=e.originalEvent.dataTransfer;if(that._trigger("dragover",e)===false){return false}if(dataTransfer){dataTransfer.dropEffect=dataTransfer.effectAllowed="copy"}e.preventDefault()},_initEventHandlers:function(){var ns=this.options.namespace;this.options.dropZone.bind("dragover."+ns,{fileupload:this},this._onDragOver).bind("drop."+ns,{fileupload:this},this._onDrop).bind("paste."+ns,{fileupload:this},this._onPaste);this.options.fileInput.bind("change."+ns,{fileupload:this},this._onChange)},_destroyEventHandlers:function(){var ns=this.options.namespace;this.options.dropZone.unbind("dragover."+ns,this._onDragOver).unbind("drop."+ns,this._onDrop).unbind("paste."+ns,this._onPaste);this.options.fileInput.unbind("change."+ns,this._onChange)},_setOption:function(key,value){var refresh=$.inArray(key,this._refreshOptionsList)!==-1;if(refresh){this._destroyEventHandlers()}$.Widget.prototype._setOption.call(this,key,value);if(refresh){this._initSpecialOptions();this._initEventHandlers()}},_initSpecialOptions:function(){var options=this.options;if(options.fileInput===undefined){options.fileInput=this.element.is("input:file")?this.element:this.element.find("input:file")}else if(!(options.fileInput instanceof $)){options.fileInput=$(options.fileInput)}if(!(options.dropZone instanceof $)){options.dropZone=$(options.dropZone)}},_create:function(){var options=this.options,dataOpts=$.extend({},this.element.data());dataOpts[this.widgetName]=undefined;$.extend(options,dataOpts);options.namespace=options.namespace||this.widgetName;this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(true);this._sending=this._active=this._loaded=this._total=0;this._initEventHandlers()},destroy:function(){this._destroyEventHandlers();$.Widget.prototype.destroy.call(this)},enable:function(){$.Widget.prototype.enable.call(this);this._initEventHandlers()},disable:function(){this._destroyEventHandlers();$.Widget.prototype.disable.call(this)},add:function(data){if(!data||this.options.disabled){return}data.files=$.each($.makeArray(data.files),this._normalizeFile);this._onAdd(null,data)},send:function(data){if(data&&!this.options.disabled){data.files=$.each($.makeArray(data.files),this._normalizeFile);if(data.files.length){return this._onSend(null,data)}}return this._getXHRPromise(false,data&&data.context)}})});(function(factory){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else{factory(window.jQuery)}})(function($){"use strict";var counter=0;$.ajaxTransport("iframe",function(options){if(options.async&&(options.type==="POST"||options.type==="GET")){var form,iframe;return{send:function(_,completeCallback){form=$('<form style="display:none;"></form>');iframe=$('<iframe src="javascript:false;" name="iframe-transport-'+(counter+=1)+'"></iframe>').bind("load",function(){var fileInputClones;iframe.unbind("load").bind("load",function(){var response;try{response=iframe.contents();if(!response.length||!response[0].firstChild){throw new Error}}catch(e){response=undefined}completeCallback(200,"success",{iframe:response});$('<iframe src="javascript:false;"></iframe>').appendTo(form);form.remove()});form.prop("target",iframe.prop("name")).prop("action",options.url).prop("method",options.type);if(options.formData){$.each(options.formData,function(index,field){$('<input type="hidden"/>').prop("name",field.name).val(field.value).appendTo(form)})}if(options.fileInput&&options.fileInput.length&&options.type==="POST"){fileInputClones=options.fileInput.clone();options.fileInput.after(function(index){return fileInputClones[index]});if(options.paramName){options.fileInput.each(function(){$(this).prop("name",options.paramName)})}form.append(options.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data")}form.submit();if(fileInputClones&&fileInputClones.length){options.fileInput.each(function(index,input){var clone=$(fileInputClones[index]);$(input).prop("name",clone.prop("name"));clone.replaceWith(input)})}});form.append(iframe).appendTo(document.body)},abort:function(){if(iframe){iframe.unbind("load").prop("src","javascript".concat(":false;"))}if(form){form.remove()}}}}});$.ajaxSetup({converters:{"iframe text":function(iframe){return $(iframe[0].body).text()},"iframe json":function(iframe){return $.parseJSON($(iframe[0].body).text())},"iframe html":function(iframe){return $(iframe[0].body).html()},"iframe script":function(iframe){return $.globalEval($(iframe[0].body).text())}}})});(function($){var abs=Math.abs,max=Math.max,min=Math.min,round=Math.round;function div(){return $("<div/>")}$.imgAreaSelect=function(img,options){var $img=$(img),imgLoaded,$box=div(),$area=div(),$border=div().add(div()).add(div()).add(div()),$outer=div().add(div()).add(div()).add(div()),$handles=$([]),$areaOpera,left,top,imgOfs={left:0,top:0},imgWidth,imgHeight,$parent,parOfs={left:0,top:0},zIndex=0,position="absolute",startX,startY,scaleX,scaleY,resize,minWidth,minHeight,maxWidth,maxHeight,aspectRatio,shown,x1,y1,x2,y2,selection={x1:0,y1:0,x2:0,y2:0,width:0,height:0},docElem=document.documentElement,$p,d,i,o,w,h,adjusted;function viewX(x){return x+imgOfs.left-parOfs.left}function viewY(y){return y+imgOfs.top-parOfs.top}function selX(x){return x-imgOfs.left+parOfs.left}function selY(y){return y-imgOfs.top+parOfs.top}function evX(event){return event.pageX-parOfs.left}function evY(event){return event.pageY-parOfs.top}function getSelection(noScale){var sx=noScale||scaleX,sy=noScale||scaleY;return{x1:round(selection.x1*sx),y1:round(selection.y1*sy),x2:round(selection.x2*sx),y2:round(selection.y2*sy),width:round(selection.x2*sx)-round(selection.x1*sx),height:round(selection.y2*sy)-round(selection.y1*sy)}}function setSelection(x1,y1,x2,y2,noScale){var sx=noScale||scaleX,sy=noScale||scaleY;selection={x1:round(x1/sx||0),y1:round(y1/sy||0),x2:round(x2/sx||0),y2:round(y2/sy||0)};selection.width=selection.x2-selection.x1;selection.height=selection.y2-selection.y1}function adjust(){if(!$img.width())return;imgOfs={left:round($img.offset().left),top:round($img.offset().top)};imgWidth=$img.innerWidth();imgHeight=$img.innerHeight();imgOfs.top+=$img.outerHeight()-imgHeight>>1;imgOfs.left+=$img.outerWidth()-imgWidth>>1;minWidth=round(options.minWidth/scaleX)||0;minHeight=round(options.minHeight/scaleY)||0;maxWidth=round(min(options.maxWidth/scaleX||1<<24,imgWidth));maxHeight=round(min(options.maxHeight/scaleY||1<<24,imgHeight));if($().jquery=="1.3.2"&&position=="fixed"&&!docElem["getBoundingClientRect"]){imgOfs.top+=max(document.body.scrollTop,docElem.scrollTop);imgOfs.left+=max(document.body.scrollLeft,docElem.scrollLeft)}parOfs=/absolute|relative/.test($parent.css("position"))?{left:round($parent.offset().left)-$parent.scrollLeft(),top:round($parent.offset().top)-$parent.scrollTop()}:position=="fixed"?{left:$(document).scrollLeft(),top:$(document).scrollTop()}:{left:0,top:0};left=viewX(0);top=viewY(0);if(selection.x2>imgWidth||selection.y2>imgHeight)doResize()}function update(resetKeyPress){if(!shown)return;$box.css({left:viewX(selection.x1),top:viewY(selection.y1)}).add($area).width(w=selection.width).height(h=selection.height);$area.add($border).add($handles).css({left:0,top:0});$border.width(max(w-$border.outerWidth()+$border.innerWidth(),0)).height(max(h-$border.outerHeight()+$border.innerHeight(),0));$($outer[0]).css({left:left,top:top,width:selection.x1,height:imgHeight});$($outer[1]).css({left:left+selection.x1,top:top,width:w,height:selection.y1});$($outer[2]).css({left:left+selection.x2,top:top,width:imgWidth-selection.x2,height:imgHeight});$($outer[3]).css({left:left+selection.x1,top:top+selection.y2,width:w,height:imgHeight-selection.y2});w-=$handles.outerWidth();h-=$handles.outerHeight();switch($handles.length){case 8:$($handles[4]).css({left:w>>1});$($handles[5]).css({left:w,top:h>>1});$($handles[6]).css({left:w>>1,top:h});$($handles[7]).css({top:h>>1});case 4:$handles.slice(1,3).css({left:w});$handles.slice(2,4).css({top:h})}if(resetKeyPress!==false){if($.imgAreaSelect.keyPress!=docKeyPress)$(document).unbind($.imgAreaSelect.keyPress,$.imgAreaSelect.onKeyPress);if(options.keys)$(document)[$.imgAreaSelect.keyPress]($.imgAreaSelect.onKeyPress=docKeyPress)}if($.browser.msie&&$border.outerWidth()-$border.innerWidth()==2){$border.css("margin",0);setTimeout(function(){$border.css("margin","auto")},0)}}function doUpdate(resetKeyPress){adjust();update(resetKeyPress);x1=viewX(selection.x1);y1=viewY(selection.y1);x2=viewX(selection.x2);y2=viewY(selection.y2)}function hide($elem,fn){options.fadeSpeed?$elem.fadeOut(options.fadeSpeed,fn):$elem.hide()}function areaMouseMove(event){var x=selX(evX(event))-selection.x1,y=selY(evY(event))-selection.y1;if(!adjusted){adjust();adjusted=true;$box.one("mouseout",function(){adjusted=false})}resize="";if(options.resizable){if(y<=options.resizeMargin)resize="n";else if(y>=selection.height-options.resizeMargin)resize="s";if(x<=options.resizeMargin)resize+="w";else if(x>=selection.width-options.resizeMargin)resize+="e"}$box.css("cursor",resize?resize+"-resize":options.movable?"move":"");if($areaOpera)$areaOpera.toggle()}function docMouseUp(event){$("body").css("cursor","");if(options.autoHide||selection.width*selection.height==0)hide($box.add($outer),function(){$(this).hide()});$(document).unbind("mousemove",selectingMouseMove);$box.mousemove(areaMouseMove);options.onSelectEnd(img,getSelection())}function areaMouseDown(event){if(event.which!=1)return false;adjust();if(resize){$("body").css("cursor",resize+"-resize");x1=viewX(selection[/w/.test(resize)?"x2":"x1"]);y1=viewY(selection[/n/.test(resize)?"y2":"y1"]);$(document).mousemove(selectingMouseMove).one("mouseup",docMouseUp);$box.unbind("mousemove",areaMouseMove)}else if(options.movable){startX=left+selection.x1-evX(event);startY=top+selection.y1-evY(event);$box.unbind("mousemove",areaMouseMove);$(document).mousemove(movingMouseMove).one("mouseup",function(){options.onSelectEnd(img,getSelection());$(document).unbind("mousemove",movingMouseMove);$box.mousemove(areaMouseMove)})}else $img.mousedown(event);return false}function fixAspectRatio(xFirst){if(aspectRatio)if(xFirst){x2=max(left,min(left+imgWidth,x1+abs(y2-y1)*aspectRatio*(x2>x1||-1)));y2=round(max(top,min(top+imgHeight,y1+abs(x2-x1)/aspectRatio*(y2>y1||-1))));x2=round(x2)}else{y2=max(top,min(top+imgHeight,y1+abs(x2-x1)/aspectRatio*(y2>y1||-1)));x2=round(max(left,min(left+imgWidth,x1+abs(y2-y1)*aspectRatio*(x2>x1||-1))));y2=round(y2)}}function doResize(){x1=min(x1,left+imgWidth);y1=min(y1,top+imgHeight);if(abs(x2-x1)<minWidth){x2=x1-minWidth*(x2<x1||-1);if(x2<left)x1=left+minWidth;else if(x2>left+imgWidth)x1=left+imgWidth-minWidth}if(abs(y2-y1)<minHeight){y2=y1-minHeight*(y2<y1||-1);if(y2<top)y1=top+minHeight;else if(y2>top+imgHeight)y1=top+imgHeight-minHeight}x2=max(left,min(x2,left+imgWidth));y2=max(top,min(y2,top+imgHeight));fixAspectRatio(abs(x2-x1)<abs(y2-y1)*aspectRatio);if(abs(x2-x1)>maxWidth){x2=x1-maxWidth*(x2<x1||-1);fixAspectRatio()}if(abs(y2-y1)>maxHeight){y2=y1-maxHeight*(y2<y1||-1);fixAspectRatio(true)}selection={x1:selX(min(x1,x2)),x2:selX(max(x1,x2)),y1:selY(min(y1,y2)),y2:selY(max(y1,y2)),width:abs(x2-x1),height:abs(y2-y1)};update();options.onSelectChange(img,getSelection())}function selectingMouseMove(event){x2=/w|e|^$/.test(resize)||aspectRatio?evX(event):viewX(selection.x2);y2=/n|s|^$/.test(resize)||aspectRatio?evY(event):viewY(selection.y2);doResize();return false}function doMove(newX1,newY1){x2=(x1=newX1)+selection.width;y2=(y1=newY1)+selection.height;$.extend(selection,{x1:selX(x1),y1:selY(y1),x2:selX(x2),y2:selY(y2)});update();options.onSelectChange(img,getSelection())}function movingMouseMove(event){x1=max(left,min(startX+evX(event),left+imgWidth-selection.width));y1=max(top,min(startY+evY(event),top+imgHeight-selection.height));doMove(x1,y1);event.preventDefault();return false}function startSelection(){$(document).unbind("mousemove",startSelection);adjust();x2=x1;y2=y1;doResize();resize="";if(!$outer.is(":visible"))$box.add($outer).hide().fadeIn(options.fadeSpeed||0);shown=true;$(document).unbind("mouseup",cancelSelection).mousemove(selectingMouseMove).one("mouseup",docMouseUp);$box.unbind("mousemove",areaMouseMove);options.onSelectStart(img,getSelection())}function cancelSelection(){$(document).unbind("mousemove",startSelection).unbind("mouseup",cancelSelection);hide($box.add($outer));setSelection(selX(x1),selY(y1),selX(x1),selY(y1));if(!(this instanceof $.imgAreaSelect)){options.onSelectChange(img,getSelection());options.onSelectEnd(img,getSelection())}}function imgMouseDown(event){if(event.which!=1||$outer.is(":animated"))return false;adjust();startX=x1=evX(event);startY=y1=evY(event);$(document).mousemove(startSelection).mouseup(cancelSelection);return false}function windowResize(){doUpdate(false)}function imgLoad(){imgLoaded=true;setOptions(options=$.extend({classPrefix:"imgareaselect",movable:true,parent:"body",resizable:true,resizeMargin:10,onInit:function(){},onSelectStart:function(){},onSelectChange:function(){},onSelectEnd:function(){}},options));$box.add($outer).css({visibility:""});if(options.show){shown=true;adjust();update();$box.add($outer).hide().fadeIn(options.fadeSpeed||0)}setTimeout(function(){options.onInit(img,getSelection())},0)}var docKeyPress=function(event){var k=options.keys,d,t,key=event.keyCode;d=!isNaN(k.alt)&&(event.altKey||event.originalEvent.altKey)?k.alt:!isNaN(k.ctrl)&&event.ctrlKey?k.ctrl:!isNaN(k.shift)&&event.shiftKey?k.shift:!isNaN(k.arrows)?k.arrows:10;if(k.arrows=="resize"||k.shift=="resize"&&event.shiftKey||k.ctrl=="resize"&&event.ctrlKey||k.alt=="resize"&&(event.altKey||event.originalEvent.altKey)){switch(key){case 37:d=-d;case 39:t=max(x1,x2);x1=min(x1,x2);x2=max(t+d,x1);fixAspectRatio();break;case 38:d=-d;case 40:t=max(y1,y2);y1=min(y1,y2);y2=max(t+d,y1);fixAspectRatio(true);break;default:return}doResize()}else{x1=min(x1,x2);y1=min(y1,y2);switch(key){case 37:doMove(max(x1-d,left),y1);break;case 38:doMove(x1,max(y1-d,top));break;case 39:doMove(x1+min(d,imgWidth-selX(x2)),y1);break;case 40:doMove(x1,y1+min(d,imgHeight-selY(y2)));break;default:return}}return false};function styleOptions($elem,props){for(var option in props)if(options[option]!==undefined)$elem.css(props[option],options[option])}function setOptions(newOptions){if(newOptions.parent)($parent=$(newOptions.parent)).append($box.add($outer));$.extend(options,newOptions);adjust();if(newOptions.handles!=null){$handles.remove();$handles=$([]);i=newOptions.handles?newOptions.handles=="corners"?4:8:0;while(i--)$handles=$handles.add(div());$handles.addClass(options.classPrefix+"-handle").css({position:"absolute",fontSize:0,zIndex:zIndex+1||1});if(!parseInt($handles.css("width"))>=0)$handles.width(5).height(5);if(o=options.borderWidth)$handles.css({borderWidth:o,borderStyle:"solid"});styleOptions($handles,{borderColor1:"border-color",borderColor2:"background-color",borderOpacity:"opacity"})}scaleX=options.imageWidth/imgWidth||1;scaleY=options.imageHeight/imgHeight||1;if(newOptions.x1!=null){setSelection(newOptions.x1,newOptions.y1,newOptions.x2,newOptions.y2);newOptions.show=!newOptions.hide}if(newOptions.keys)options.keys=$.extend({shift:1,ctrl:"resize"},newOptions.keys);$outer.addClass(options.classPrefix+"-outer");$area.addClass(options.classPrefix+"-selection");for(i=0;i++<4;)$($border[i-1]).addClass(options.classPrefix+"-border"+i);styleOptions($area,{selectionColor:"background-color",selectionOpacity:"opacity"});styleOptions($border,{borderOpacity:"opacity",borderWidth:"border-width"});styleOptions($outer,{outerColor:"background-color",outerOpacity:"opacity"});if(o=options.borderColor1)$($border[0]).css({borderStyle:"solid",borderColor:o});if(o=options.borderColor2)$($border[1]).css({borderStyle:"dashed",borderColor:o});$box.append($area.add($border).add($areaOpera).add($handles));if($.browser.msie){if(o=$outer.css("filter").match(/opacity=(\d+)/))$outer.css("opacity",o[1]/100);if(o=$border.css("filter").match(/opacity=(\d+)/))$border.css("opacity",o[1]/100)}if(newOptions.hide)hide($box.add($outer));else if(newOptions.show&&imgLoaded){shown=true;$box.add($outer).fadeIn(options.fadeSpeed||0);doUpdate()}aspectRatio=(d=(options.aspectRatio||"").split(/:/))[0]/d[1];$img.add($outer).unbind("mousedown",imgMouseDown);if(options.disable||options.enable===false){$box.unbind("mousemove",areaMouseMove).unbind("mousedown",areaMouseDown);$(window).unbind("resize",windowResize)}else{if(options.enable||options.disable===false){if(options.resizable||options.movable)$box.mousemove(areaMouseMove).mousedown(areaMouseDown);$(window).resize(windowResize)}if(!options.persistent)$img.add($outer).mousedown(imgMouseDown)}options.enable=options.disable=undefined}this.remove=function(){setOptions({disable:true});$box.add($outer).remove()};this.getOptions=function(){return options};this.setOptions=setOptions;this.getSelection=getSelection;this.setSelection=setSelection;this.cancelSelection=cancelSelection;this.update=doUpdate;$p=$img;while($p.length){zIndex=max(zIndex,!isNaN($p.css("z-index"))?$p.css("z-index"):zIndex);if($p.css("position")=="fixed")position="fixed";$p=$p.parent(":not(body)")}zIndex=options.zIndex||zIndex;if($.browser.msie)$img.attr("unselectable","on");$.imgAreaSelect.keyPress=$.browser.msie||$.browser.safari?"keydown":"keypress";if($.browser.opera)$areaOpera=div().css({width:"100%",height:"100%",position:"absolute",zIndex:zIndex+2||2});$box.add($outer).css({visibility:"hidden",position:position,overflow:"hidden",zIndex:zIndex||"0"});$box.css({zIndex:zIndex+2||2});$area.add($border).css({position:"absolute",fontSize:0});img.complete||img.readyState=="complete"||!$img.is("img")?imgLoad():$img.one("load",imgLoad);if(!imgLoaded&&$.browser.msie&&$.browser.version>=7)img.src=img.src};$.fn.imgAreaSelect=function(options){options=options||{};this.each(function(){if($(this).data("imgAreaSelect")){if(options.remove){$(this).data("imgAreaSelect").remove();$(this).removeData("imgAreaSelect")}else $(this).data("imgAreaSelect").setOptions(options)}else if(!options.remove){if(options.enable===undefined&&options.disable===undefined)options.enable=true;$(this).data("imgAreaSelect",new $.imgAreaSelect(this,options))}});if(options.instance)return $(this).data("imgAreaSelect");return this}})(jQuery);(function($){"use strict";var DEFAULT_SETTINGS={decelerate:true,triggerHardware:false,y:true,x:true,slowdown:.9,maxvelocity:40,throttleFPS:60,movingClass:{up:"kinetic-moving-up",down:"kinetic-moving-down",left:"kinetic-moving-left",right:"kinetic-moving-right"},deceleratingClass:{up:"kinetic-decelerating-up",down:"kinetic-decelerating-down",left:"kinetic-decelerating-left",right:"kinetic-decelerating-right"}},SETTINGS_KEY="kinetic-settings",ACTIVE_CLASS="kinetic-active";if(!window.requestAnimationFrame){window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback,element){window.setTimeout(callback,1e3/60)}}()}$.support=$.support||{};$.extend($.support,{touch:"ontouchend"in document});var selectStart=function(){return false};var decelerateVelocity=function(velocity,slowdown){return Math.floor(Math.abs(velocity))===0?0:velocity*slowdown};var capVelocity=function(velocity,max){var newVelocity=velocity;if(velocity>0){if(velocity>max){newVelocity=max}}else{if(velocity<0-max){newVelocity=0-max}}return newVelocity};var setMoveClasses=function(settings,classes){this.removeClass(settings.movingClass.up).removeClass(settings.movingClass.down).removeClass(settings.movingClass.left).removeClass(settings.movingClass.right).removeClass(settings.deceleratingClass.up).removeClass(settings.deceleratingClass.down).removeClass(settings.deceleratingClass.left).removeClass(settings.deceleratingClass.right);if(settings.velocity>0){this.addClass(classes.right)}if(settings.velocity<0){this.addClass(classes.left)}if(settings.velocityY>0){this.addClass(classes.down)}if(settings.velocityY<0){this.addClass(classes.up)}};var stop=function($scroller,settings){if(typeof settings.stopped==="function"){settings.stopped.call($scroller,settings)}};var move=function($scroller,settings){var scroller=$scroller[0];if(settings.x&&scroller.scrollWidth>0){scroller.scrollLeft=settings.scrollLeft=scroller.scrollLeft+settings.velocity;if(Math.abs(settings.velocity)>0){settings.velocity=settings.decelerate?decelerateVelocity(settings.velocity,settings.slowdown):settings.velocity}}else{settings.velocity=0}if(settings.y&&scroller.scrollHeight>0){scroller.scrollTop=settings.scrollTop=scroller.scrollTop+settings.velocityY;if(Math.abs(settings.velocityY)>0){settings.velocityY=settings.decelerate?decelerateVelocity(settings.velocityY,settings.slowdown):settings.velocityY}}else{settings.velocityY=0}setMoveClasses.call($scroller,settings,settings.deceleratingClass);if(typeof settings.moved==="function"){settings.moved.call($scroller,settings)}if(Math.abs(settings.velocity)>0||Math.abs(settings.velocityY)>0){window.requestAnimationFrame(function(){move($scroller,settings)})}else{stop($scroller,settings)}};var callOption=function(method,options){var methodFn=$.kinetic.callMethods[method],args=Array.prototype.slice.call(arguments);if(methodFn){this.each(function(){var opts=args.slice(1),settings=$(this).data(SETTINGS_KEY);opts.unshift(settings);methodFn.apply(this,opts)})}};var attachListeners=function($this,settings){var element=$this[0];if($.support.touch){element.addEventListener("touchstart",settings.events.touchStart,false);element.addEventListener("touchend",settings.events.inputEnd,false);element.addEventListener("touchmove",settings.events.touchMove,false)}else{$this.mousedown(settings.events.inputDown).mouseup(settings.events.inputEnd).mousemove(settings.events.inputMove)}$this.click(settings.events.inputClick).bind("selectstart",selectStart);$this.bind("dragstart",settings.events.dragStart)};var detachListeners=function($this,settings){var element=$this[0];if($.support.touch){element.removeEventListener("touchstart",settings.events.touchStart,false);element.removeEventListener("touchend",settings.events.inputEnd,false);element.removeEventListener("touchmove",settings.events.touchMove,false)}else{$this.unbind("mousedown",settings.events.inputDown).unbind("mouseup",settings.events.inputEnd).unbind("mousemove",settings.events.inputMove)}$this.unbind("click",settings.events.inputClick).unbind("selectstart",selectStart);$this.unbind("dragstart",settings.events.dragStart)};var initElements=function(options){this.addClass(ACTIVE_CLASS).each(function(){var settings=$.extend({},DEFAULT_SETTINGS,options);var self=this,$this=$(this),xpos,prevXPos=false,ypos,prevYPos=false,mouseDown=false,scrollLeft,scrollTop,throttleTimeout=1e3/settings.throttleFPS,lastMove,elementFocused;settings.velocity=0;settings.velocityY=0;var resetMouse=function(){xpos=false;ypos=false;mouseDown=false};$(document).mouseup(resetMouse).click(resetMouse);var calculateVelocities=function(){settings.velocity=capVelocity(prevXPos-xpos,settings.maxvelocity);settings.velocityY=capVelocity(prevYPos-ypos,settings.maxvelocity)};var useTarget=function(target){if($.isFunction(settings.filterTarget)){return settings.filterTarget.call(self,target)!==false}return true};var start=function(clientX,clientY){mouseDown=true;settings.velocity=prevXPos=0;settings.velocityY=prevYPos=0;xpos=clientX;ypos=clientY};var end=function(){if(xpos&&prevXPos&&settings.decelerate===false){settings.decelerate=true;calculateVelocities();xpos=prevXPos=mouseDown=false;move($this,settings)}};var inputmove=function(clientX,clientY){if(!lastMove||new Date>new Date(lastMove.getTime()+throttleTimeout)){lastMove=new Date;if(mouseDown&&(xpos||ypos)){if(elementFocused){$(elementFocused).blur();elementFocused=null;$this.focus()}settings.decelerate=false;settings.velocity=settings.velocityY=0;$this[0].scrollLeft=settings.scrollLeft=settings.x?$this[0].scrollLeft-(clientX-xpos):$this[0].scrollLeft;$this[0].scrollTop=settings.scrollTop=settings.y?$this[0].scrollTop-(clientY-ypos):$this[0].scrollTop;prevXPos=xpos;prevYPos=ypos;xpos=clientX;ypos=clientY;calculateVelocities();setMoveClasses.call($this,settings,settings.movingClass);if(typeof settings.moved==="function"){settings.moved.call($this,settings)}}}};settings.events={touchStart:function(e){if(useTarget(e.target)){start(e.touches[0].clientX,e.touches[0].clientY);e.stopPropagation()}},touchMove:function(e){if(mouseDown){inputmove(e.touches[0].clientX,e.touches[0].clientY);if(e.preventDefault){e.preventDefault()}}},inputDown:function(e){if(useTarget(e.target)){start(e.clientX,e.clientY);elementFocused=e.target;if(e.target.nodeName==="IMG"){e.preventDefault()}e.stopPropagation()}},inputEnd:function(e){end();elementFocused=null;if(e.preventDefault){e.preventDefault()}},inputMove:function(e){if(mouseDown){inputmove(e.clientX,e.clientY);if(e.preventDefault){e.preventDefault()}}},inputClick:function(e){if(Math.abs(settings.velocity)>0){e.preventDefault();return false}},dragStart:function(e){if(elementFocused){return false}}};attachListeners($this,settings);$this.data(SETTINGS_KEY,settings).css("cursor","move");if(settings.triggerHardware){$this.css("-webkit-transform","translate3d(0,0,0)")}})};$.kinetic={settingsKey:SETTINGS_KEY,callMethods:{start:function(settings,options){var $this=$(this);settings=$.extend(settings,options);if(settings){settings.decelerate=false;move($this,settings)}},end:function(settings,options){var $this=$(this);if(settings){settings.decelerate=true}},stop:function(settings,options){settings.velocity=0;settings.velocityY=0;settings.decelerate=true},detach:function(settings,options){var $this=$(this);detachListeners($this,settings);$this.removeClass(ACTIVE_CLASS).css("cursor","")},attach:function(settings,options){var $this=$(this);attachListeners($this,settings);$this.addClass(ACTIVE_CLASS).css("cursor","move")}}};$.fn.kinetic=function(options){if(typeof options==="string"){callOption.apply(this,arguments)}else{initElements.call(this,options)}return this}})(window.jQuery||window.Zepto);(function(){var $=jQuery;if(!window.VS)window.VS={};if(!VS.app)VS.app={};if(!VS.ui)VS.ui={};if(!VS.model)VS.model={};if(!VS.utils)VS.utils={};VS.VERSION="0.2.1";VS.VisualSearch=function(options){var defaults={container:"",query:"",unquotable:[],callbacks:{search:$.noop,focus:$.noop,blur:$.noop,facetMatches:$.noop,valueMatches:$.noop}};this.options=_.extend({},defaults,options);this.options.callbacks=_.extend({},defaults.callbacks,options.callbacks);VS.app.hotkeys.initialize();this.searchQuery=new VS.model.SearchQuery;this.searchBox=new VS.ui.SearchBox({app:this});if(options.container){var searchBox=this.searchBox.render().el;$(this.options.container).html(searchBox)}this.searchBox.value(this.options.query||"");$(window).bind("unload",function(e){});return this};VS.init=function(options){return new VS.VisualSearch(options)}})();(function(){var $=jQuery;VS.ui.SearchBox=Backbone.View.extend({id:"search",events:{"click .VS-cancel-search-box":"clearSearch","mousedown .VS-search-box":"maybeFocusSearch","dblclick .VS-search-box":"highlightSearch","click .VS-search-box":"maybeTripleClick"},initialize:function(){this.app=this.options.app;this.flags={allSelected:false};this.facetViews=[];this.inputViews=[];_.bindAll(this,"renderFacets","_maybeDisableFacets","disableFacets","deselectAllFacets");this.app.searchQuery.bind("reset",this.renderFacets);$(document).bind("keydown",this._maybeDisableFacets)},render:function(){$(this.el).append(JST["search_box"]({}));$(document.body).setMode("no","search");return this},value:function(query){if(query==null)return this.serialize();return this.setQuery(query)},serialize:function(){var query=[];var inputViewsCount=this.inputViews.length;this.app.searchQuery.each(_.bind(function(facet,i){query.push(this.inputViews[i].value());query.push(facet.serialize())},this));if(inputViewsCount){query.push(this.inputViews[inputViewsCount-1].value())}return _.compact(query).join(" ")},setQuery:function(query){this.currentQuery=query;VS.app.SearchParser.parse(this.app,query)},viewPosition:function(view){var views=view.type=="facet"?this.facetViews:this.inputViews;var position=_.indexOf(views,view);if(position==-1)position=0;return position},searchEvent:function(e){var query=this.value();this.focusSearch(e);this.value(query);this.app.options.callbacks.search(query,this.app.searchQuery)},addFacet:function(category,initialQuery,position){category=VS.utils.inflector.trim(category);initialQuery=VS.utils.inflector.trim(initialQuery||"");if(!category)return;var model=new VS.model.SearchFacet({category:category,value:initialQuery||"",app:this.app});this.app.searchQuery.add(model,{at:position});this.renderFacets();var facetView=_.detect(this.facetViews,function(view){if(view.model==model)return true});_.defer(function(){facetView.enableEdit()})},renderFacets:function(){this.facetViews=[];this.inputViews=[];this.$(".VS-search-inner").empty();this.app.searchQuery.each(_.bind(function(facet,i){this.renderFacet(facet,i)},this));this.renderSearchInput()},renderFacet:function(facet,position){var view=new VS.ui.SearchFacet({app:this.app,model:facet,order:position});this.renderSearchInput();this.facetViews.push(view);this.$(".VS-search-inner").children().eq(position*2).after(view.render().el);view.calculateSize();_.defer(_.bind(view.calculateSize,view));return view},renderSearchInput:function(){var input=new VS.ui.SearchInput({position:this.inputViews.length,app:this.app});this.$(".VS-search-inner").append(input.render().el);this.inputViews.push(input)},clearSearch:function(e){var actualClearSearch=_.bind(function(){this.disableFacets();this.value("");this.flags.allSelected=false;this.searchEvent(e);this.focusSearch(e)},this);if(this.app.options.callbacks.clearSearch){this.app.options.callbacks.clearSearch(actualClearSearch)}else{actualClearSearch()}},selectAllFacets:function(){this.flags.allSelected=true;$(document).one("click.selectAllFacets",this.deselectAllFacets);_.each(this.facetViews,function(facetView,i){facetView.selectFacet()});_.each(this.inputViews,function(inputView,i){inputView.selectText()})},allSelected:function(deselect){if(deselect)this.flags.allSelected=false;return this.flags.allSelected},deselectAllFacets:function(e){this.disableFacets();if(this.$(e.target).is(".category,input")){var el=$(e.target).closest(".search_facet,.search_input");var view=_.detect(this.facetViews.concat(this.inputViews),function(v){return v.el==el[0]});if(view.type=="facet"){view.selectFacet()}else if(view.type=="input"){_.defer(function(){view.enableEdit(true)})}}},disableFacets:function(keepView){_.each(this.inputViews,function(view){if(view&&view!=keepView&&(view.modes.editing=="is"||view.modes.selected=="is")){view.disableEdit()}});_.each(this.facetViews,function(view){if(view&&view!=keepView&&(view.modes.editing=="is"||view.modes.selected=="is")){view.disableEdit();view.deselectFacet()}});this.flags.allSelected=false;this.removeFocus();$(document).unbind("click.selectAllFacets")},resizeFacets:function(view){_.each(this.facetViews,function(facetView,i){if(!view||facetView==view){facetView.resize()}})},_maybeDisableFacets:function(e){if(this.flags.allSelected&&VS.app.hotkeys.key(e)=="backspace"){e.preventDefault();this.clearSearch(e);return false}else if(this.flags.allSelected&&VS.app.hotkeys.printable(e)){this.clearSearch(e)}},focusNextFacet:function(currentView,direction,options){options=options||{};var viewCount=this.facetViews.length;var viewPosition=options.viewPosition||this.viewPosition(currentView);if(!options.skipToFacet){if(currentView.type=="text"&&direction>0)direction-=1;if(currentView.type=="facet"&&direction<0)direction+=1}else if(options.skipToFacet&&currentView.type=="text"&&viewCount==viewPosition&&direction>=0){viewPosition=0;direction=0}var view,next=Math.min(viewCount,viewPosition+direction);if(currentView.type=="text"){if(next>=0&&next<viewCount){view=this.facetViews[next]}else if(next==viewCount){view=this.inputViews[this.inputViews.length-1]}if(view&&options.selectFacet&&view.type=="facet"){view.selectFacet()}else if(view){view.enableEdit();view.setCursorAtEnd(direction||options.startAtEnd)}}else if(currentView.type=="facet"){if(options.skipToFacet){if(next>=viewCount||next<0){view=_.last(this.inputViews);view.enableEdit()}else{view=this.facetViews[next];view.enableEdit();view.setCursorAtEnd(direction||options.startAtEnd)}}else{view=this.inputViews[next];view.enableEdit()}}if(options.selectText)view.selectText();this.resizeFacets()},maybeFocusSearch:function(e){if($(e.target).is(".VS-search-box")||$(e.target).is(".VS-search-inner")||e.type=="keydown"){this.focusSearch(e)}},focusSearch:function(e,selectText){var view=this.inputViews[this.inputViews.length-1];view.enableEdit(selectText);if(!selectText)view.setCursorAtEnd(-1);if(e.type=="keydown"){view.keydown(e);view.box.trigger("keydown")}_.defer(_.bind(function(){if(!this.$("input:focus").length){view.enableEdit(selectText)}},this))},highlightSearch:function(e){if($(e.target).is(".VS-search-box")||$(e.target).is(".VS-search-inner")||e.type=="keydown"){var lastinput=this.inputViews[this.inputViews.length-1];lastinput.startTripleClickTimer();this.focusSearch(e,true)}},maybeTripleClick:function(e){var lastinput=this.inputViews[this.inputViews.length-1];return lastinput.maybeTripleClick(e)},addFocus:function(){this.app.options.callbacks.focus();this.$(".VS-search-box").addClass("VS-focus")},removeFocus:function(){this.app.options.callbacks.blur();var focus=_.any(this.facetViews.concat(this.inputViews),function(view){return view.isFocused()});if(!focus)this.$(".VS-search-box").removeClass("VS-focus")},showFacetCategoryMenu:function(e){e.preventDefault();e.stopPropagation();if(this.facetCategoryMenu&&this.facetCategoryMenu.modes.open=="is"){return this.facetCategoryMenu.close()}var items=[{title:"Account",onClick:_.bind(this.addFacet,this,"account","")},{title:"Project",onClick:_.bind(this.addFacet,this,"project","")},{title:"Filter",onClick:_.bind(this.addFacet,this,"filter","")},{title:"Access",onClick:_.bind(this.addFacet,this,"access","")}];var menu=this.facetCategoryMenu||(this.facetCategoryMenu=new dc.ui.Menu({items:items,standalone:true}));this.$(".VS-icon-search").after(menu.render().open().content);return false}})})();(function(){var $=jQuery;VS.ui.SearchFacet=Backbone.View.extend({type:"facet",className:"search_facet",events:{"click .category":"selectFacet","keydown input":"keydown","mousedown input":"enableEdit","mouseover .VS-icon-cancel":"showDelete","mouseout .VS-icon-cancel":"hideDelete","click .VS-icon-cancel":"remove"},initialize:function(options){this.flags={canClose:false};_.bindAll(this,"set","keydown","deselectFacet","deferDisableEdit")},render:function(){$(this.el).html(JST["search_facet"]({model:this.model}));this.setMode("not","editing");this.setMode("not","selected");this.box=this.$("input");this.box.val(this.model.get("value"));this.box.bind("blur",this.deferDisableEdit);this.box.bind("input propertychange",this.keydown);this.setupAutocomplete();return this},calculateSize:function(){this.box.autoGrowInput();this.box.unbind("updated.autogrow");this.box.bind("updated.autogrow",_.bind(this.moveAutocomplete,this))},resize:function(e){this.box.trigger("resize.autogrow",e)},setupAutocomplete:function(){this.box.autocomplete({source:_.bind(this.autocompleteValues,this),minLength:0,delay:0,autoFocus:true,position:{offset:"0 5"},select:_.bind(function(e,ui){e.preventDefault();var originalValue=this.model.get("value");this.set(ui.item.value);if(originalValue!=ui.item.value||this.box.val()!=ui.item.value){this.search(e)}return false},this),open:_.bind(function(e,ui){var box=this.box;this.box.autocomplete("widget").find(".ui-menu-item").each(function(){var $value=$(this);if($value.data("item.autocomplete")["value"]==box.val()){box.data("autocomplete").menu.activate(new $.Event("mouseover"),$value)}})},this)});this.box.autocomplete("widget").addClass("VS-interface")},moveAutocomplete:function(){var autocomplete=this.box.data("autocomplete");if(autocomplete){autocomplete.menu.element.position({my:"left top",at:"left bottom",of:this.box.data("autocomplete").element,collision:"flip",offset:"0 5"})}},searchAutocomplete:function(e){var autocomplete=this.box.data("autocomplete");if(autocomplete){var menu=autocomplete.menu.element;autocomplete.search();menu.outerWidth(Math.max(menu.width("").outerWidth(),autocomplete.element.outerWidth()))}},closeAutocomplete:function(){var autocomplete=this.box.data("autocomplete");if(autocomplete)autocomplete.close()},autocompleteValues:function(req,resp){var category=this.model.get("category");var value=this.model.get("value");var searchTerm=req.term;this.options.app.options.callbacks.valueMatches(category,searchTerm,function(matches,options){options=options||{};matches=matches||[];if(searchTerm&&value!=searchTerm){var re=VS.utils.inflector.escapeRegExp(searchTerm||"");var matcher=new RegExp("\\b"+re,"i");matches=$.grep(matches,function(item){return matcher.test(item)||matcher.test(item.value)||matcher.test(item.label)})}if(options.preserveOrder){resp(matches)}else{resp(_.sortBy(matches,function(match){if(match==value||match.value==value)return"";else return match}))}})},set:function(value){if(!value)return;this.model.set({value:value})},search:function(e,direction){if(!direction)direction=1;this.closeAutocomplete();this.options.app.searchBox.searchEvent(e);_.defer(_.bind(function(){this.options.app.searchBox.focusNextFacet(this,direction,{viewPosition:this.options.order})},this))},enableEdit:function(){if(this.modes.editing!="is"){this.setMode("is","editing");this.deselectFacet();if(this.box.val()==""){this.box.val(this.model.get("value"))}}this.flags.canClose=false;this.options.app.searchBox.disableFacets(this);this.options.app.searchBox.addFocus();_.defer(_.bind(function(){this.options.app.searchBox.addFocus()},this));this.resize();this.searchAutocomplete();this.box.focus()},deferDisableEdit:function(){this.flags.canClose=true;_.delay(_.bind(function(){if(this.flags.canClose&&!this.box.is(":focus")&&this.modes.editing=="is"&&this.modes.selected!="is"){this.disableEdit()}},this),250)},disableEdit:function(){var newFacetQuery=VS.utils.inflector.trim(this.box.val());if(newFacetQuery!=this.model.get("value")){this.set(newFacetQuery)}this.flags.canClose=false;this.box.selectRange(0,0);this.box.blur();this.setMode("not","editing");this.closeAutocomplete();this.options.app.searchBox.removeFocus()},selectFacet:function(e){if(e)e.preventDefault();var allSelected=this.options.app.searchBox.allSelected();if(this.modes.selected=="is")return;if(this.box.is(":focus")){this.box.setCursorPosition(0);this.box.blur()}this.flags.canClose=false;this.closeAutocomplete();this.setMode("is","selected");this.setMode("not","editing");if(!allSelected||e){$(document).unbind("keydown.facet",this.keydown);$(document).unbind("click.facet",this.deselectFacet);_.defer(_.bind(function(){$(document).unbind("keydown.facet").bind("keydown.facet",this.keydown);$(document).unbind("click.facet").one("click.facet",this.deselectFacet)},this));this.options.app.searchBox.disableFacets(this);this.options.app.searchBox.addFocus()}return false},deselectFacet:function(e){if(e)e.preventDefault();if(this.modes.selected=="is"){this.setMode("not","selected");this.closeAutocomplete();this.options.app.searchBox.removeFocus()}$(document).unbind("keydown.facet",this.keydown);$(document).unbind("click.facet",this.deselectFacet);return false},isFocused:function(){return this.box.is(":focus")},showDelete:function(){$(this.el).addClass("search_facet_maybe_delete")},hideDelete:function(){$(this.el).removeClass("search_facet_maybe_delete")},setCursorAtEnd:function(direction){if(direction==-1){this.box.setCursorPosition(this.box.val().length)}else{this.box.setCursorPosition(0)}},remove:function(e){var committed=this.model.get("value");this.deselectFacet();this.disableEdit();this.options.app.searchQuery.remove(this.model);if(committed){this.search(e,-1)}else{this.options.app.searchBox.renderFacets();this.options.app.searchBox.focusNextFacet(this,-1,{viewPosition:this.options.order})}},selectText:function(){this.box.selectRange(0,this.box.val().length)},keydown:function(e){var key=VS.app.hotkeys.key(e);if(key=="enter"&&this.box.val()){this.disableEdit();this.search(e)}else if(key=="left"){if(this.modes.selected=="is"){this.deselectFacet();this.options.app.searchBox.focusNextFacet(this,-1,{startAtEnd:-1})}else if(this.box.getCursorPosition()==0&&!this.box.getSelection().length){this.selectFacet()}}else if(key=="right"){if(this.modes.selected=="is"){e.preventDefault();this.deselectFacet();this.setCursorAtEnd(0);this.enableEdit()}else if(this.box.getCursorPosition()==this.box.val().length){e.preventDefault();this.disableEdit();this.options.app.searchBox.focusNextFacet(this,1)}}else if(VS.app.hotkeys.shift&&key=="tab"){e.preventDefault();this.options.app.searchBox.focusNextFacet(this,-1,{startAtEnd:-1,skipToFacet:true,selectText:true})}else if(key=="tab"){e.preventDefault();this.options.app.searchBox.focusNextFacet(this,1,{skipToFacet:true,selectText:true})}else if(VS.app.hotkeys.command&&(e.which==97||e.which==65)){e.preventDefault();this.options.app.searchBox.selectAllFacets();return false}else if(VS.app.hotkeys.printable(e)&&this.modes.selected=="is"){this.options.app.searchBox.focusNextFacet(this,-1,{startAtEnd:-1});this.remove(e)}else if(key=="backspace"){if(this.modes.selected=="is"){e.preventDefault();this.remove(e)}else if(this.box.getCursorPosition()==0&&!this.box.getSelection().length){e.preventDefault();this.selectFacet()}}this.resize(e);if(e.which==null){this.searchAutocomplete(e);_.defer(_.bind(this.resize,this,e))}}})})();(function(){var $=jQuery;VS.ui.SearchInput=Backbone.View.extend({type:"text",className:"search_input",events:{"keypress input":"keypress","keydown input":"keydown","click input":"maybeTripleClick","dblclick input":"startTripleClickTimer"},initialize:function(){this.app=this.options.app;this.flags={canClose:false};_.bindAll(this,"removeFocus","addFocus","moveAutocomplete","deferDisableEdit")},render:function(){$(this.el).html(JST["search_input"]({}));this.setMode("not","editing");this.setMode("not","selected");this.box=this.$("input");this.box.autoGrowInput();this.box.bind("updated.autogrow",this.moveAutocomplete);this.box.bind("blur",this.deferDisableEdit);this.box.bind("focus",this.addFocus);this.setupAutocomplete();return this},setupAutocomplete:function(){this.box.autocomplete({minLength:1,delay:50,autoFocus:true,position:{offset:"0 -1"},source:_.bind(this.autocompleteValues,this),select:_.bind(function(e,ui){e.preventDefault();e.stopPropagation();var remainder=this.addTextFacetRemainder(ui.item.value);var position=this.options.position+(remainder?1:0);this.app.searchBox.addFacet(ui.item.value,"",position);return false},this)});this.box.data("autocomplete")._renderMenu=function(ul,items){var category="";_.each(items,_.bind(function(item,i){if(item.category&&item.category!=category){ul.append('<li class="ui-autocomplete-category">'+item.category+"</li>");category=item.category}this._renderItem(ul,item)},this))};this.box.autocomplete("widget").addClass("VS-interface")},autocompleteValues:function(req,resp){var searchTerm=req.term;var lastWord=searchTerm.match(/\w+$/);var re=VS.utils.inflector.escapeRegExp(lastWord&&lastWord[0]||" ");this.app.options.callbacks.facetMatches(function(prefixes,options){options=options||{};prefixes=prefixes||[];var matcher=new RegExp("^"+re,"i");var matches=$.grep(prefixes,function(item){return item&&matcher.test(item.label||item)});if(options.preserveOrder){resp(matches)}else{resp(_.sortBy(matches,function(match){if(match.label)return match.category+"-"+match.label;else return match}))}})},closeAutocomplete:function(){var autocomplete=this.box.data("autocomplete");if(autocomplete)autocomplete.close()},moveAutocomplete:function(){var autocomplete=this.box.data("autocomplete");if(autocomplete){autocomplete.menu.element.position({my:"left top",at:"left bottom",of:this.box.data("autocomplete").element,collision:"none",offset:"0 -1"})}},searchAutocomplete:function(e){var autocomplete=this.box.data("autocomplete");if(autocomplete){var menu=autocomplete.menu.element;autocomplete.search();menu.outerWidth(Math.max(menu.width("").outerWidth(),autocomplete.element.outerWidth()))}},addTextFacetRemainder:function(facetValue){var boxValue=this.box.val();var lastWord=boxValue.match(/\b(\w+)$/);var matcher=new RegExp(lastWord[0],"i");if(lastWord&&facetValue.search(matcher)==0){boxValue=boxValue.replace(/\b(\w+)$/,"")}boxValue=boxValue.replace("^s+|s+$","");if(boxValue){this.app.searchBox.addFacet("text",boxValue,this.options.position)}return boxValue},enableEdit:function(selectText){this.addFocus();if(selectText){this.selectText()}this.box.focus()},addFocus:function(){this.flags.canClose=false;if(!this.app.searchBox.allSelected()){this.app.searchBox.disableFacets(this)}this.app.searchBox.addFocus();this.setMode("is","editing");this.setMode("not","selected");this.searchAutocomplete()},disableEdit:function(){this.box.blur();this.removeFocus()},removeFocus:function(){this.flags.canClose=false;this.app.searchBox.removeFocus();this.setMode("not","editing");this.setMode("not","selected");this.closeAutocomplete()},deferDisableEdit:function(){this.flags.canClose=true;_.delay(_.bind(function(){if(this.flags.canClose&&!this.box.is(":focus")&&this.modes.editing=="is"){this.disableEdit()}},this),250)},startTripleClickTimer:function(){this.tripleClickTimer=setTimeout(_.bind(function(){this.tripleClickTimer=null},this),500)},maybeTripleClick:function(e){if(!!this.tripleClickTimer){e.preventDefault();this.app.searchBox.selectAllFacets();return false}},isFocused:function(){return this.box.is(":focus")},value:function(){return this.box.val()},setCursorAtEnd:function(direction){if(direction==-1){this.box.setCursorPosition(this.box.val().length)}else{this.box.setCursorPosition(0)}},selectText:function(){this.box.selectRange(0,this.box.val().length);if(!this.app.searchBox.allSelected()){this.box.focus()}else{this.setMode("is","selected")}},search:function(e,direction){if(!direction)direction=0;this.closeAutocomplete();this.app.searchBox.searchEvent(e);_.defer(_.bind(function(){this.app.searchBox.focusNextFacet(this,direction)},this))},keypress:function(e){var key=VS.app.hotkeys.key(e);if(key=="enter"){return this.search(e,100)}else if(VS.app.hotkeys.colon(e)){this.box.trigger("resize.autogrow",e);var query=this.box.val();var prefixes=[];if(this.app.options.callbacks.facetMatches){this.app.options.callbacks.facetMatches(function(p){prefixes=p})}var labels=_.map(prefixes,function(prefix){if(prefix.label)return prefix.label;else return prefix});if(_.contains(labels,query)){e.preventDefault();var remainder=this.addTextFacetRemainder(query);var position=this.options.position+(remainder?1:0);this.app.searchBox.addFacet(query,"",position);return false}}else if(key=="backspace"){if(this.box.getCursorPosition()==0&&!this.box.getSelection().length){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();this.app.searchBox.resizeFacets();return false}}},keydown:function(e){var key=VS.app.hotkeys.key(e);if(key=="left"){if(this.box.getCursorPosition()==0){e.preventDefault();this.app.searchBox.focusNextFacet(this,-1,{startAtEnd:-1})}}else if(key=="right"){if(this.box.getCursorPosition()==this.box.val().length){e.preventDefault();this.app.searchBox.focusNextFacet(this,1,{selectFacet:true})}}else if(VS.app.hotkeys.shift&&key=="tab"){e.preventDefault();this.app.searchBox.focusNextFacet(this,-1,{selectText:true})}else if(key=="tab"){e.preventDefault();var value=this.box.val();if(value.length){var remainder=this.addTextFacetRemainder(value);var position=this.options.position+(remainder?1:0);this.app.searchBox.addFacet(value,"",position)}else{this.app.searchBox.focusNextFacet(this,0,{skipToFacet:true,selectText:true})}}else if(VS.app.hotkeys.command&&String.fromCharCode(e.which).toLowerCase()=="a"){e.preventDefault();this.app.searchBox.selectAllFacets();return false}else if(key=="backspace"&&!this.app.searchBox.allSelected()){if(this.box.getCursorPosition()==0&&!this.box.getSelection().length){e.preventDefault();this.app.searchBox.focusNextFacet(this,-1,{backspace:true});return false}}this.box.trigger("resize.autogrow",e)}})})();(function(){var $=jQuery;Backbone.View.prototype.setMode=function(mode,group){this.modes||(this.modes={});if(this.modes[group]===mode)return;$(this.el).setMode(mode,group);this.modes[group]=mode}})();(function(){var $=jQuery;VS.app.hotkeys={KEYS:{16:"shift",17:"command",91:"command",93:"command",224:"command",13:"enter",37:"left",38:"upArrow",39:"right",40:"downArrow",46:"delete",8:"backspace",9:"tab",188:"comma"},initialize:function(){_.bindAll(this,"down","up","blur");$(document).bind("keydown",this.down);$(document).bind("keyup",this.up);$(window).bind("blur",this.blur)},down:function(e){var key=this.KEYS[e.which];if(key)this[key]=true},up:function(e){var key=this.KEYS[e.which];if(key)this[key]=false},blur:function(e){for(var key in this.KEYS)this[this.KEYS[key]]=false},key:function(e){return this.KEYS[e.which]},colon:function(e){var charCode=e.which;return charCode&&String.fromCharCode(charCode)==":"},printable:function(e){var code=e.which;if(e.type=="keydown"){if(code==32||code>=48&&code<=90||code>=96&&code<=111||code>=186&&code<=192||code>=219&&code<=222){return true}}else{if(code>=32&&code<=126||code>=160&&code<=500||String.fromCharCode(code)==":"){return true}}return false}}})();(function(){var $=jQuery;VS.utils.inflector={trim:function(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")},escapeRegExp:function(s){return s.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")}}})();(function(){var $=jQuery;$.fn.extend({setMode:function(state,group){group=group||"mode";var re=new RegExp("\\w+_"+group+"(\\s|$)","g");var mode=state===null?"":state+"_"+group;this.each(function(){this.className=(this.className.replace(re,"")+" "+mode).replace(/\s\s/g," ")});return mode},autoGrowInput:function(){return this.each(function(){var $input=$(this);var $tester=$("<div />").css({opacity:0,top:-9999,left:-9999,position:"absolute",whiteSpace:"nowrap"}).addClass("VS-input-width-tester").addClass("VS-interface");var events="keydown.autogrow keypress.autogrow "+"resize.autogrow change.autogrow";$input.next(".VS-input-width-tester").remove();$input.after($tester);$input.unbind(events).bind(events,function(e,realEvent){if(realEvent)e=realEvent;var value=$input.val();if(VS.app.hotkeys.key(e)=="backspace"){var position=$input.getCursorPosition();if(position>0)value=value.slice(0,position-1)+value.slice(position,value.length)}else if(VS.app.hotkeys.printable(e)&&!VS.app.hotkeys.command){value+=String.fromCharCode(e.which)}value=value.replace(/&/g,"&amp;").replace(/\s/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");$tester.html(value);$input.width($tester.width()+3);$input.trigger("updated.autogrow")});$input.trigger("resize.autogrow")})},getCursorPosition:function(){var position=0;var input=this.get(0);if(document.selection){input.focus();var sel=document.selection.createRange();var selLen=document.selection.createRange().text.length;sel.moveStart("character",-input.value.length);position=sel.text.length-selLen}else if(input&&$(input).is(":visible")&&input.selectionStart!=null){position=input.selectionStart}return position},setCursorPosition:function(position){return this.each(function(){return $(this).selectRange(position,position)})},selectRange:function(start,end){return this.each(function(){if(this.setSelectionRange){this.focus();this.setSelectionRange(start,end)}else if(this.createTextRange){var range=this.createTextRange();range.collapse(true);range.moveEnd("character",end);range.moveStart("character",start);if(end-start>=0)range.select()}})},getSelection:function(){var input=this[0];if(input.selectionStart!=null){var start=input.selectionStart;var end=input.selectionEnd;return{start:start,end:end,length:end-start,text:input.value.substr(start,end-start)}}else if(document.selection){var range=document.selection.createRange();if(range){var textRange=input.createTextRange();var copyRange=textRange.duplicate();textRange.moveToBookmark(range.getBookmark());copyRange.setEndPoint("EndToStart",textRange);var start=copyRange.text.length;var end=start+range.text.length;return{start:start,end:end,length:end-start,text:range.text}}}return{start:0,end:0,length:0}}});if($.browser.msie&&false){window.console={};var _$ied;window.console.log=function(msg){if(_.isArray(msg)){var message=msg[0];var vars=_.map(msg.slice(1),function(arg){return JSON.stringify(arg)}).join(" - ")}if(!_$ied){_$ied=$("<div><ol></ol></div>").css({position:"fixed",bottom:10,left:10,zIndex:2e4,width:$("body").width()-80,border:"1px solid #000",padding:"10px",backgroundColor:"#fff",fontFamily:"arial,helvetica,sans-serif",fontSize:"11px"});$("body").append(_$ied)}var $message=$("<li>"+message+" - "+vars+"</li>").css({borderBottom:"1px solid #999999"});_$ied.find("ol").append($message);_.delay(function(){$message.fadeOut(500)},5e3)}}})();(function(){var $=jQuery;VS.app.SearchParser={ALL_FIELDS:/('.+?'|".+?"|[^'"\s]{2}\S*):\s*('.+?'|".+?"|[^'"\s]\S*)/g,CATEGORY:/('.+?'|".+?"|[^'"\s]{2}\S*):\s*/,parse:function(instance,query){var searchFacets=this._extractAllFacets(instance,query);instance.searchQuery.reset(searchFacets);return searchFacets},_extractAllFacets:function(instance,query){var facets=[];var originalQuery=query;while(query){var category,value;originalQuery=query;var field=this._extractNextField(query);if(!field){category="text";value=this._extractSearchText(query);query=VS.utils.inflector.trim(query.replace(value,""))}else if(field.indexOf(":")!=-1){category=field.match(this.CATEGORY)[1].replace(/(^['"]|['"]$)/g,"");value=field.replace(this.CATEGORY,"").replace(/(^['"]|['"]$)/g,"");query=VS.utils.inflector.trim(query.replace(field,""))}else if(field.indexOf(":")==-1){category="text";value=field;query=VS.utils.inflector.trim(query.replace(value,""))}if(category&&value){var searchFacet=new VS.model.SearchFacet({category:category,value:VS.utils.inflector.trim(value),app:instance});facets.push(searchFacet)}if(originalQuery==query)break}return facets},_extractNextField:function(query){var textRe=/^\s*(\S+)\s+(?=\w+:\s?(('.+?'|".+?")|([^'"]{2}\S*)))/;var textMatch=query.match(textRe);if(textMatch&&textMatch.length>=1){return textMatch[1]}else{return this._extractFirstField(query)}},_extractFirstField:function(query){var fields=query.match(this.ALL_FIELDS);return fields&&fields.length&&fields[0]},_extractSearchText:function(query){query=query||"";var text=VS.utils.inflector.trim(query.replace(this.ALL_FIELDS,""));return text}}})();(function(){var $=jQuery;VS.model.SearchFacet=Backbone.Model.extend({serialize:function(){var category=this.quoteCategory(this.get("category"));var value=VS.utils.inflector.trim(this.get("value"));if(!value)return"";if(!_.contains(this.get("app").options.unquotable||[],category)&&category!="text"){value=this.quoteValue(value)}if(category!="text"){category=category+": "}else{category=""}return category+value},quoteCategory:function(category){var hasDoubleQuote=/"/.test(category);var hasSingleQuote=/'/.test(category);var hasSpace=/\s/.test(category);if(hasDoubleQuote&&!hasSingleQuote){return"'"+category+"'"}else if(hasSpace||hasSingleQuote&&!hasDoubleQuote){return'"'+category+'"'}else{return category}},quoteValue:function(value){var hasDoubleQuote=/"/.test(value);var hasSingleQuote=/'/.test(value);if(hasDoubleQuote&&!hasSingleQuote){return"'"+value+"'"}else{return'"'+value+'"'}}})})();(function(){var $=jQuery;VS.model.SearchQuery=Backbone.Collection.extend({model:VS.model.SearchFacet,serialize:function(){return this.map(function(facet){return facet.serialize()}).join(" ")},facets:function(){return this.map(function(facet){var value={};value[facet.get("category")]=facet.get("value");return value})},find:function(category){var facet=this.detect(function(facet){return facet.get("category")==category});return facet&&facet.get("value")},count:function(category){return this.select(function(facet){return facet.get("category")==category}).length},values:function(category){var facets=this.select(function(facet){return facet.get("category")==category});return _.map(facets,function(facet){return facet.get("value")})},has:function(category,value){return this.any(function(facet){var categoryMatched=facet.get("category")==category;if(!value)return categoryMatched;return categoryMatched&&facet.get("value")==value})},withoutCategory:function(category){return this.map(function(facet){if(facet.get("category")!=category)return facet.serialize()}).join(" ")}})})();(function(){window.JST=window.JST||{};window.JST["search_box"]=_.template('<div class="VS-search">\n  <div class="VS-search-box-wrapper VS-search-box">\n    <div class="VS-icon VS-icon-search"></div>\n    <div class="VS-search-inner"></div>\n    <div class="VS-icon VS-icon-cancel VS-cancel-search-box" title="clear search"></div>\n  </div>\n</div>');window.JST["search_facet"]=_.template('<% if (model.has(\'category\')) { %>\n  <div class="category"><%= model.get(\'category\') %>:</div>\n<% } %>\n\n<div class="search_facet_input_container">\n  <input type="text" class="search_facet_input VS-interface" value="" />\n</div>\n\n<div class="search_facet_remove VS-icon VS-icon-cancel"></div>');window.JST["search_input"]=_.template('<input type="text" />')})();var relativeDate=function(undefined){var SECOND=1e3,MINUTE=60*SECOND,HOUR=60*MINUTE,DAY=24*HOUR,WEEK=7*DAY,YEAR=DAY*365,MONTH=YEAR/12;var formats=[[.7*MINUTE,"seconds ago",SECOND],[1.5*MINUTE,"a minute ago"],[60*MINUTE,"minutes ago",MINUTE],[1.5*HOUR,"an hour ago"],[DAY,"hours ago",HOUR],[2*DAY,"yesterday"],[7*DAY,"days ago",DAY],[1.5*WEEK,"a week ago"],[MONTH,"weeks ago",WEEK],[1.5*MONTH,"a month ago"],[YEAR,"months ago",MONTH],[1.5*YEAR,"a year ago"],[Number.MAX_VALUE,"years ago",YEAR]];function relativeDate(input,reference){!reference&&(reference=(new Date).getTime());reference instanceof Date&&(reference=reference.getTime());input instanceof Date&&(input=input.getTime());var delta=reference-input,format,i,len;for(i=-1,len=formats.length;++i<len;){format=formats[i];if(delta<format[0]){return format[2]==undefined?format[1]:Math.round(delta/format[2])+" "+format[1]}}}return relativeDate}();if(typeof module!="undefined"&&module.exports){module.exports=relativeDate}(function(a,b){function r(a){this._d=a}function s(a,b){var c=a+"";while(c.length<b)c="0"+c;return c}function t(b,c,d,e){var f=typeof c=="string",g=f?{}:c,h,i,j,k;return f&&e&&(g[c]=+e),h=(g.ms||g.milliseconds||0)+(g.s||g.seconds||0)*1e3+(g.m||g.minutes||0)*6e4+(g.h||g.hours||0)*36e5,i=(g.d||g.days||0)+(g.w||g.weeks||0)*7,j=(g.M||g.months||0)+(g.y||g.years||0)*12,h&&b.setTime(+b+h*d),i&&b.setDate(b.getDate()+i*d),j&&(k=b.getDate(),b.setDate(1),b.setMonth(b.getMonth()+j*d),b.setDate(Math.min(new a(b.getFullYear(),b.getMonth()+1,0).getDate(),k))),b}function u(a){return Object.prototype.toString.call(a)==="[object Array]"}function v(b){return new a(b[0],b[1]||0,b[2]||1,b[3]||0,b[4]||0,b[5]||0,b[6]||0)}function w(b,d){function u(d){var e,j;switch(d){case"M":return f+1;case"Mo":return f+1+q(f+1);case"MM":return s(f+1,2);case"MMM":return c.monthsShort[f];case"MMMM":return c.months[f];case"D":return g;case"Do":return g+q(g);case"DD":return s(g,2);case"DDD":return e=new a(h,f,g),j=new a(h,0,1),~~((e-j)/864e5+1.5);case"DDDo":return e=u("DDD"),e+q(e);case"DDDD":return s(u("DDD"),3);case"d":return i;case"do":return i+q(i);case"ddd":return c.weekdaysShort[i];case"dddd":return c.weekdays[i];case"w":return e=new a(h,f,g-i+5),j=new a(e.getFullYear(),0,4),~~((e-j)/864e5/7+1.5);case"wo":return e=u("w"),e+q(e);case"ww":return s(u("w"),2);case"YY":return s(h%100,2);case"YYYY":return h;case"a":return m>11?t.pm:t.am;case"A":return m>11?t.PM:t.AM;case"H":return m;case"HH":return s(m,2);case"h":return m%12||12;case"hh":return s(m%12||12,2);case"m":return n;case"mm":return s(n,2);case"s":return o;case"ss":return s(o,2);case"zz":case"z":return(b.toString().match(l)||[""])[0].replace(k,"");case"Z":return(p>0?"+":"-")+s(~~(Math.abs(p)/60),2)+":"+s(~~(Math.abs(p)%60),2);case"ZZ":return(p>0?"+":"-")+s(~~(10*Math.abs(p)/6),4);case"L":case"LL":case"LLL":case"LLLL":case"LT":return w(b,c.longDateFormat[d]);default:return d.replace(/(^\[)|(\\)|\]$/g,"")}}var e=new r(b),f=e.month(),g=e.date(),h=e.year(),i=e.day(),m=e.hours(),n=e.minutes(),o=e.seconds(),p=-e.zone(),q=c.ordinal,t=c.meridiem;return d.replace(j,u)}function x(b,d){function p(a,b){var d;switch(a){case"M":case"MM":e[1]=~~b-1;break;case"MMM":case"MMMM":for(d=0;d<12;d++)if(c.monthsParse[d].test(b)){e[1]=d;break}break;case"D":case"DD":case"DDD":case"DDDD":e[2]=~~b;break;case"YY":b=~~b,e[0]=b+(b>70?1900:2e3);break;case"YYYY":e[0]=~~Math.abs(b);break;case"a":case"A":l=b.toLowerCase()==="pm";break;case"H":case"HH":case"h":case"hh":e[3]=~~b;break;case"m":case"mm":e[4]=~~b;break;case"s":case"ss":e[5]=~~b;break;case"Z":case"ZZ":h=!0,d=(b||"").match(o),d&&d[1]&&(f=~~d[1]),d&&d[2]&&(g=~~d[2]),d&&d[0]==="+"&&(f=-f,g=-g)}}var e=[0,0,1,0,0,0,0],f=0,g=0,h=!1,i=b.match(n),j=d.match(m),k,l;for(k=0;k<j.length;k++)p(j[k],i[k]);return l&&e[3]<12&&(e[3]+=12),l===!1&&e[3]===12&&(e[3]=0),e[3]+=f,e[4]+=g,h?new a(a.UTC.apply({},e)):v(e)}function y(a,b){var c=Math.min(a.length,b.length),d=Math.abs(a.length-b.length),e=0,f;for(f=0;f<c;f++)~~a[f]!==~~b[f]&&e++;return e+d}function z(a,b){var c,d=a.match(n),e=[],f=99,g,h,i;for(g=0;g<b.length;g++)h=x(a,b[g]),i=y(d,w(h,b[g]).match(n)),i<f&&(f=i,c=h);return c}function A(a,b,d){var e=c.relativeTime[a];return typeof e=="function"?e(b||1,!!d,a):e.replace(/%d/i,b||1)}function B(a,b){var c=d(Math.abs(a)/1e3),e=d(c/60),f=d(e/60),g=d(f/24),h=d(g/365),i=c<45&&["s",c]||e===1&&["m"]||e<45&&["mm",e]||f===1&&["h"]||f<22&&["hh",f]||g===1&&["d"]||g<=25&&["dd",g]||g<=45&&["M"]||g<345&&["MM",d(g/30)]||h===1&&["y"]||["yy",h];return i[2]=b,A.apply({},i)}function C(a,b){c.fn[a]=function(a){return a!=null?(this._d["set"+b](a),this):this._d["get"+b]()}}var c,d=Math.round,e={},f=typeof module!="undefined",g="months|monthsShort|monthsParse|weekdays|weekdaysShort|longDateFormat|calendar|relativeTime|ordinal|meridiem".split("|"),h,i=/^\/?Date\((\d+)/i,j=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|dddd?|do?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|zz?|ZZ?|LT|LL?L?L?)/g,k=/[^A-Z]/g,l=/\([A-Za-z ]+\)|:[0-9]{2} [A-Z]{3} /g,m=/(\\)?(MM?M?M?|dd?d?d|DD?D?D?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|ZZ?|T)/g,n=/(\\)?([0-9]+|([a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+|([\+\-]\d\d:?\d\d))/gi,o=/([\+\-]|\d\d)/gi,p="1.4.0",q="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|");c=function(c,d){if(c===null)return null;var e,f;return c&&c._d instanceof a?e=new a(+c._d):d?u(d)?e=z(c,d):e=x(c,d):(f=i.exec(c),e=c===b?new a:f?new a(+f[1]):c instanceof a?c:u(c)?v(c):new a(c)),new r(e)},c.version=p,c.lang=function(a,b){var d,h,i,j=[];if(b){for(d=0;d<12;d++)j[d]=new RegExp("^"+b.months[d]+"|^"+b.monthsShort[d].replace(".",""),"i");b.monthsParse=b.monthsParse||j,e[a]=b}if(e[a])for(d=0;d<g.length;d++)h=g[d],c[h]=e[a][h]||c[h];else f&&(i=require("./lang/"+a),c.lang(a,i))},c.lang("en",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},meridiem:{AM:"AM",am:"am",PM:"PM",pm:"pm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(a){var b=a%10;return~~(a%100/10)===1?"th":b===1?"st":b===2?"nd":b===3?"rd":"th"}}),c.fn=r.prototype={clone:function(){return c(this)},valueOf:function(){return+this._d},"native":function(){return this._d},toString:function(){return this._d.toString()},toDate:function(){return this._d},format:function(a){return w(this._d,a)},add:function(a,b){return this._d=t(this._d,a,1,b),this},subtract:function(a,b){return this._d=t(this._d,a,-1,b),this},diff:function(a,b,e){var f=c(a),g=(this.zone()-f.zone())*6e4,h=this._d-f._d-g,i=this.year()-f.year(),j=this.month()-f.month(),k=this.date()-f.date(),l;return b==="months"?l=i*12+j+k/30:b==="years"?l=i+j/12:l=b==="seconds"?h/1e3:b==="minutes"?h/6e4:b==="hours"?h/36e5:b==="days"?h/864e5:b==="weeks"?h/6048e5:h,e?l:d(l)},from:function(a,b){var d=this.diff(a),e=c.relativeTime,f=B(d,b);return b?f:(d<=0?e.past:e.future).replace(/%s/i,f)},fromNow:function(a){return this.from(c(),a)},calendar:function(){var a=this.diff(c().sod(),"days",!0),b=c.calendar,d=b.sameElse,e=a<-6?d:a<-1?b.lastWeek:a<0?b.lastDay:a<1?b.sameDay:a<2?b.nextDay:a<7?b.nextWeek:d;return this.format(typeof e=="function"?e.apply(this):e)},isLeapYear:function(){var a=this.year();return a%4===0&&a%100!==0||a%400===0},isDST:function(){return this.zone()<c([this.year()]).zone()||this.zone()<c([this.year(),5]).zone()},day:function(a){var b=this._d.getDay();return a==null?b:this.add({d:a-b})},sod:function(){return this.clone().hours(0).minutes(0).seconds(0).milliseconds(0)},eod:function(){return this.sod().add({d:1,ms:-1})}};for(h=0;h<q.length;h++)C(q[h].toLowerCase(),q[h]);C("year","FullYear"),c.fn.zone=function(){return this._d.getTimezoneOffset()},f&&(module.exports=c),typeof window!="undefined"&&(window.moment=c),typeof define=="function"&&define.amd&&define("moment",[],function(){return c})})(Date);(function(window,document){"use strict";var keyboardAllowed=typeof Element!=="undefined"&&"ALLOW_KEYBOARD_INPUT"in Element,fn=function(){var fnMap=[["requestFullscreen","exitFullscreen","fullscreenchange","fullscreen","fullscreenElement","fullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitfullscreenchange","webkitIsFullScreen","webkitCurrentFullScreenElement","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozFullScreen","mozFullScreenElement","mozfullscreenerror"]],i=0,l=fnMap.length,ret={},val,valLength;for(;i<l;i++){val=fnMap[i];if(val&&val[1]in document){for(i=0,valLength=val.length;i<valLength;i++){ret[fnMap[0][i]]=val[i]}return ret}}return false}(),screenfull={isFullscreen:document[fn.fullscreen],element:document[fn.fullscreenElement],request:function(elem){var request=fn.requestFullscreen;elem=elem||document.documentElement;if(/5\.1[\.\d]* Safari/.test(navigator.userAgent)){elem[request]()}else{elem[request](keyboardAllowed&&Element.ALLOW_KEYBOARD_INPUT)}},exit:function(){document[fn.exitFullscreen]()},toggle:function(elem){if(this.isFullscreen){this.exit()}else{this.request(elem)}},onchange:function(){},onerror:function(){}};if(!fn){window.screenfull=null;return}document.addEventListener(fn.fullscreenchange,function(e){screenfull.isFullscreen=document[fn.fullscreen];screenfull.element=document[fn.fullscreenElement];screenfull.onchange.call(screenfull,e)});document.addEventListener(fn.fullscreenerror,function(e){screenfull.onerror.call(screenfull,e)});window.screenfull=screenfull})(window,document);(function(){var __slice=[].slice;window.arcs={};arcs.views={};arcs.models={};arcs.collections={};arcs.utils={};arcs.routers={};arcs.templates={};arcs.bus={};_.extend(arcs.bus,Backbone.Events);arcs.mode=CAKE_DEBUG;arcs.debug=arcs.mode>0;arcs.version="0.9.6";arcs.baseURL="/~bogdan.pozderca/arcs/";arcs.url=function(){var components;components=1<=arguments.length?__slice.call(arguments,0):[];return arcs.baseURL+components.join("/")};arcs.log=function(){var msg;msg=1<=arguments.length?__slice.call(arguments,0):[];if(arcs.debug&&(typeof console!=="undefined"&&console!==null?console.log:void 0)!=null){return console.log.apply(console,["[ARCS]:"].concat(__slice.call(msg)))}};arcs.tmpl=function(key,data,func){var tmpl;if(func==null){func=_.template}tmpl=_.has(JST,key)?JST[key]:key;return func(tmpl,data!=null?data:{})};$.fn.extend({toggleAttr:function(attr){if($(this).attr(attr)){return $(this).removeAttr(attr)}return $(this).attr(attr,attr)}});$.postJSON=function(url,data,success){return $.ajax({url:url,data:JSON.stringify(data),type:"POST",contentType:"application/json",dataType:"json",success:success})}}).call(this);(function(){var _sync;if(document.location.href.match(/:8080\/~[a-z0-9]+\//)){arcs.baseURL+=document.location.href.match(/~[a-z0-9]+\//);arcs.baseURL+="arcs/"}if(arcs.mode>0){arcs.dev={};arcs.dev.reload=false;arcs.dev.reloadAt=2e3;_sync=Backbone.sync;Backbone.sync=function(method,model,options){arcs.log("Backbone.sync:",method,model,options);return _sync(method,model,options)};arcs.dev.reloadStylesheets=function(){var query;query="?reload="+(new Date).getTime();return $('link[rel="stylesheet"]').each(function(){return this.href=this.href.replace(/\?.*|$/,query)})};if(arcs.dev.reload){setInterval(arcs.dev.reloadStylesheets,arcs.dev.reloadAt)}}}).call(this);arcs.utils.auth={};arcs.utils.auth.canView=function(user,resource){if(user==null)user=null;if(resource==null)resource=null;if(user.role<3)return true;return false};arcs.utils.auth.canMeta=function(user,resource){var exclusive;if(user==null)user=null;if(resource==null)resource=null;if(user.role<=1)return true;exclusive=resource.get("exclusive");if(user.role===2&&!exclusive)return true;return false};arcs.utils.auth.canDelete=function(user,resource){if(user==null)user=null;if(resource==null)resource=null};arcs.utils.auth.canResolve=function(user,resource){if(user==null)user=null;if(resource==null)resource=null;if(user.role<=1)return true};(function(){var complete,completeFacet,memoize;memoize=function(f,expire){var cache;cache={};return function(){var args,key,res,time;args=_.toArray(arguments);key=args.join("");time=Date.now();if(key in cache&&time-cache[key][0]<expire){return cache[key][1]}res=f.apply(this,args);cache[key]=[time,res];return res}};completeFacet=function(category,query){var result;if(query==null){query=""}result=[];$.ajax({url:arcs.baseURL+("resources/complete?cat="+category+"&q="+query),async:false,dataType:"json",success:function(data){return result=_.compact(_.uniq(_.values(data)))}});return result};complete=function(url){var result;result=[];$.ajax({url:arcs.baseURL+url,async:false,dataType:"json",success:function(data){return result=_.compact(_.uniq(_.values(data)))}});return result};arcs.completeFacet=memoize(completeFacet,3e4);arcs.complete=memoize(complete,3e4);arcs.completeDate=function(url){var aliases,d,dates,fmt,parseFmt,raw,_ref;raw=arcs.complete(url);_ref=["DD-MM-YYYY","YYYY-MM-DD HH:mm:ss"],fmt=_ref[0],parseFmt=_ref[1];dates=function(){var _i,_len,_results;_results=[];for(_i=0,_len=raw.length;_i<_len;_i++){d=raw[_i];_results.push(moment(d,parseFmt).format(fmt))}return _results}();aliases=[{label:"today",value:moment().format(fmt)},{label:"yesterday",value:moment().subtract("days",1).format(fmt)}];return _.union(dates,aliases)};arcs.utils.autocomplete=function(opts){var $el,addTerm,defaults,focus,getLast,options,select,split,_ref;defaults={source:[],multiple:false,sel:null};options=_.extend(defaults,opts);$el=$(options.sel);split=function(val){return val.split(/,\s*/)};getLast=function(term){return split(term).pop()};addTerm=function(val,appendage){var terms;terms=split(val);terms.pop();terms.push(appendage,"");return terms.join(", ")};if(_.isFunction(options.source)&&options.source.length===0){_ref=[options.source(),options.source],options.source=_ref[0],options._source=_ref[1]}if(options.multiple){options._source=options.source;options.source=function(request,response){var filter;filter=$.ui.autocomplete.filter;return response(filter(options._source,getLast(request.term)))};select=function(event,ui){this.value=addTerm(this.value,ui.item.value);return false};focus=function(){return false}}$el.autocomplete({source:options.source,autoFocus:true,focus:focus!=null?focus:function(){},minLength:0,select:select!=null?select:function(){}});return $el.on("keydown",function(e){if(e.keyCode===9){e.preventDefault();return false}})}}).call(this);(function(){arcs.config={metadata:{copyright:"Who owns copyright on this resource?",coverage:"What area(s) does this resource concern",creator:"Person who made the physical resource",date:"When was the original resource created?","date-modified":"What is the most recent date the resource was modified?",description:"Short description of the resource",format:"What kind of file is this resource?",identifier:"Dig-specific title for the resource (e.g. Identifier for "+"a photo: 72-BW-01-63_64)",language:"What is the original language of this resource?",location:"Area of the dig this resource concerns",medium:"What is this resource made of? (e.g: Notebook page: white "+"paper and ink)",subject:"Subjects are like tags or keywords...short, basic descriptions "+"about things what a resource describes"},metadataSingular:["identifier"],types:{"":"",Drawing:"Drawings are informational line drawings of artifacts, "+"places, or other objects","Inventory Card":"Notecard dedicated to a single artifact",Map:"There are two types of map, 1) Vectored CAD drawings with "+"geo coordinates and 2) hand-drawn renderings of dig areas "+"and trenches",Notebook:"Archaeologist field notes collected in small leather-bound "+"notebooks...a Notebook is a collection of Notebook Pages","Notebook Page":"A two-page spread of field notes from a Notebook",Photograph:"A photographic negative either depicting a significant scene "+"or object",Report:"Weekly or monthly typed account of the happenings of the dig"},flags:{incorrect:"Incorrect attributes",spam:"Spam",duplicate:"Duplicate",other:"Other"}}}).call(this);(function(){var __slice=[].slice;arcs.confirm=function(){var msg,onConfirm,_i,_ref;msg=2<=arguments.length?__slice.call(arguments,0,_i=arguments.length-1):(_i=0,[]),onConfirm=arguments[_i++];return new arcs.views.Modal({title:msg[0],subtitle:(_ref=msg[1])!=null?_ref:"",buttons:{yes:{"class":"btn btn-danger",callback:onConfirm},no:function(){}}})};arcs.prompt=function(){var msg,_ref;msg=1<=arguments.length?__slice.call(arguments,0):[];return new arcs.views.Modal({title:msg[0],subtitle:(_ref=msg[1])!=null?_ref:"",buttons:{ok:{"class":"btn btn-primary",callback:function(){}}}})};arcs.needsLogin=function(){var title;if(arcs.user.get("loggedIn")){title="You have been logged out."}else{title="You'll need to login to do that."}return new arcs.views.Modal({title:title,subtitle:"Click 'Login' below to go to the login page.",buttons:{login:function(){return location.href=arcs.url("login")},cancel:function(){}}})}}).call(this);(function(){arcs.utils.convertBytes=function(bytes){var sizes;bytes=parseInt(bytes,10);if(!isFinite(bytes)){return"unknown size"}sizes=["B","KB","MB","GB","TB"];while(!(bytes<1024)){bytes/=1024;sizes.shift()}return Math.round(bytes)+sizes.shift()}}).call(this);(function(){var formats;formats={second:[1,60],minute:[60,3600],hour:[3600,604800],week:[604800,2419200],month:[2419200,31536e3],year:[31536e3,Number.MAX_VALUE]};arcs.relativeDate=function(date){var delta,formatted,name,ratio,threshold,vals;if(!(date instanceof Date)){date=new Date(date)}delta=(new Date).getTime()-date.getTime();for(name in formats){vals=formats[name];threshold=vals[0],ratio=vals[1];if(delta<threshold){formatted=Math.round(delta/ratio);return""+formatted+" "+arcs.inflector.pluralize(name,formatted)+" ago"}}}}).call(this);(function(){arcs.inflector={PLURALS:{"(m)an$":"$1en","(pe)rson$":"$1ople","(child)$":"$1ren","^(ox)$":"$1en","(ax|test)is$":"$1es","(octop|vir)us$":"$1i","(alias|status)$":"$1es","(bu)s$":"$1ses","(buffal|tomat|potat)o$":"$1oes","([ti])um$":"$1a",sis$:"ses","(?:([^f])fe|([lr])f)$":"$1$2ves","(hive)$":"$1s","([^aeiouy]|qu)y$":"$1ies","(x|ch|ss|sh)$":"$1es","(matr|vert|ind)ix|ex$":"$1ices","([m|l])ouse$":"$1ice","(quiz)$":"$1zes",s$:"s",$:"s"},CONJUGATIONS:{was:"were",is:"are",am:"are",has:"have"},pluralize:function(noun,n){var exp,regex,repl,_ref;if(n==null){n=0}if(!(noun.length&&n!==1)){return noun}_ref=this.PLURALS;for(exp in _ref){repl=_ref[exp];regex=new RegExp(exp,"gi");if(noun.match(regex)){noun=noun.replace(regex,repl);break}}return noun},conjugate:function(verb,n){if(n==null){n=0}if(n===1){return verb}return this.CONJUGATIONS[verb]},truncate:function(text,length,ending){if(ending==null){ending="..."}if(!(text!=null)){return""}if(text.length<length){return text}return text.substring(0,length)+ending},identifierize:function(string){var id,_ref;if((_ref=this._identifiers)==null){this._identifiers={}}if(this._identifiers[string]!=null){return this._identifiers[string]}id=string.replace(/(\s|-)/g,"_").replace(/\W/g,"").toLowerCase();if(id.match(/^\d/)){id="_"+id}return this._identifiers[string]=_.uniqueId(id+"_")},enquote:function(string,single){var quote;if(single==null){single=true}quote=single?"'":'"';return quote+string+quote}}}).call(this);(function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};arcs.utils.Keys=function(){function Keys(sel){if(sel==null){sel=document}this.delegate=__bind(this.delegate,this);$(sel).on("keydown",this.delegate)}Keys.prototype.delegate=function(e){var bubble,callback,m,mappings,modifier,_i,_len;if(e.target.type==="text"||/textarea|select/i.test(e.target.nodeName)){return true}if(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey){modifier=true}else{modifier=false}mappings=this.get(e.which,modifier);if(!mappings.length){return true}bubble=false;for(_i=0,_len=mappings.length;_i<_len;_i++){m=mappings[_i];if(m.bubble){bubble=true}if(m.context){callback=_.bind(m.callback,m.context)}else{callback=m.callback}callback(e)}if(!bubble){e.preventDefault();return false}return true};Keys.prototype.add=function(key,callback,context,bubble){if(bubble==null){bubble=false}return this.mappings.push({key:key,callback:callback,context:context,bubble:bubble})};Keys.prototype.map=function(ctx,map){var cb,key,_results;_results=[];for(key in map){cb=map[key];_results.push(this.mappings.push({key:key,callback:cb,context:ctx}))}return _results};Keys.prototype.get=function(keyCode,modifier){var key,matches,_this=this;if(modifier==null){modifier=false}key=this.humanize(keyCode,modifier);return matches=_.filter(this.mappings,function(map){return map.key===key})};Keys.prototype.mappings=[];Keys.prototype.humanize=function(keyCode,modifier){var key;key=modifier?"ctrl+":"";if(this.specialKeys[keyCode]!=null){return key+=this.specialKeys[keyCode]}return key+=String.fromCharCode(keyCode).toLowerCase()};Keys.prototype.specialKeys={8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down",187:"+",189:"-",191:"?"};return Keys}();arcs.keys=arcs.utils.keys=new arcs.utils.Keys}).call(this);(function(){arcs.loader=arcs.utils.loader={show:function(){if(!$(".loading").length){$("body").append(arcs.tmpl("ui/loader"))}return $(".loading").show()},hide:function(){return $(".loading").hide()}}}).call(this);(function(){arcs.utils.hash={set:function(val,uri_encode){if(uri_encode==null){uri_encode=false}this.history.push(document.location.hash);if(uri_encode){val=encodeURIComponent(val)}return document.location.hash=val},get:function(uri_decode){var hash;if(uri_decode==null){uri_decode=false}hash=document.location.hash.slice(1);if(uri_decode){return decodeURIComponent(hash)}return hash},rewind:function(){return this.set(this.history.pop())},history:[]};arcs.utils.params={get:function(name){var p,pair,params,_i,_len;params=document.location.search.slice(1).split("&");for(_i=0,_len=params.length;_i<_len;_i++){p=params[_i];pair=p.split("=");if(pair[0]===name){return decodeURIComponent(unescape(pair[1]))}}}}}).call(this);(function(){var __indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};arcs.utils.mime=arcs.mime={imageTypes:{"image/png":"png","image/jpeg":"jpeg","image/jpg":"jpg","image/gif":"gif","image/tiff":"tiff"},documentTypes:{"application/pdf":"pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"docx","application/msword":"doc","text/plain":"plaintext","text/richtext":"richtext","text/rtf":"rtf"},videoTypes:{"video/mpeg":"mpeg","video/msvideo":"avi","video/quicktime":"mov","video/mp4":"mp4"},isDocument:function(mime){return __indexOf.call(_.keys(this.documentTypes),mime)>=0},isImage:function(mime){return __indexOf.call(_.keys(this.imageTypes),mime)>=0},isVideo:function(mime){return __indexOf.call(_.keys(this.videoTypes),mime)>=0},types:function(){return _.extend(this.videoTypes,this.documentTypes,this.imageTypes)},getInfo:function(mime){var obj,result,type,types,undef;undef={type:"undefined",ext:null};types={image:this.imageTypes,document:this.documentTypes,video:this.videoTypes};for(type in types){obj=types[type];if(__indexOf.call(_.keys(types[type]),mime)>=0){result={type:type,ext:types[type][mime]}}}return result||undef}};_.bindAll(arcs.utils.mime)}).call(this);(function(){_.mixin({isNumeric:function(val){return!isNaN(parseFloat(val))&&isFinite(val)},inverse:function(object){var k,result,v;result={};for(k in object){v=object[k];result[v]=k}return result},twins:function(array){return _.uniq(array).length===1},surrounding:function(array,index,len){var after,alt,before,result;before=_.first(array,index);after=_.rest(array,index+1);result=[array[index]];alt=true;while(len>result.length&&(before.length||after.length)){if(alt&&before.length){result.unshift(before.pop())}else if(after.length){result.push(after.shift())}alt=!alt}return result}})}).call(this);(function(){arcs.utils.Modal=function(){function Modal(options){var defaults;defaults={template:"",templateValues:{},draggable:false,handle:null,backdrop:true,"class":null,inputs:[],buttons:{}};this.options=_.extend(defaults,options);this._setEl();if(this.options["class"]!=null)this.el.addClass(this.options["class"]);if(this.options.draggable){this.el.draggable({handle:this.options.handle})}this.el.modal({backdrop:this.options.backdrop,keyboard:true,show:false});if(this.el.attr("data-first")!=="false"){this.el.attr("data-first","true")}this.show();this._bindButtons()}Modal.prototype._setEl=function(){if(!$("#modal").length)$("body").append(arcs.tmpl("ui/modal_wrapper"));return this.el=$("#modal")};Modal.prototype.hide=function(){return this.el.modal("hide")};Modal.prototype.show=function(){this.el.html(arcs.tmpl(this.options.template,this.options.templateValues));this.el.modal("show");if(this.el.attr("data-first")==="true"){this.el.css("right","-400px").animate({right:"0px"});return this.el.attr("data-first","false")}};Modal.prototype.visible=function(){return this.el.is(":visible")};Modal.prototype.values=function(){var id,vals,_i,_len,_ref;vals={};if(this.options.inputs.length){_ref=this.options.inputs;for(_i=0,_len=_ref.length;_i<_len;_i++){id=_ref[_i];vals[id]=this.el.find("#"+id).val()}}return vals};Modal.prototype._bindButtons=function(){var id,_i,_len,_ref,_results,_this=this;_ref=_.keys(this.options.buttons);_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){id=_ref[_i];_results.push(this.el.find("a#"+id+", button#"+id).one("click",function(e){var button,callback,context,_ref2,_ref3;button=_this.options.buttons[e.target.id];if(_.isFunction(button)){button(_this.values())}else{_ref3=[button.callback,(_ref2=button.context)!=null?_ref2:null],callback=_ref3[0],context=_ref3[1];if(context!=null)callback=_.bind(callback,context);callback(_this.values())}if(!button.keepOpen)return _this.hide()}))}return _results};return Modal}()}).call(this);(function(){arcs.notify=function(msg,type,hide){var $el,duration;if(type==null){type="info"}if(hide==null){hide=3}if(!$("#notification").length){$("body").append(arcs.tmpl("ui/notification"))}$el=$("#notification");$el.removeClass(function(i,klass){return(klass.match(/\balert-\S+/g)||[]).join(" ")});$el.addClass("alert-"+type);$el.find("#msg").html(msg);$el.show();if(hide){duration=_.isNumber(hide)?hide:3;setTimeout(function(){return $el.fadeOut(500)},duration*1e3)}return $el}}).call(this);(function(){var preloaded,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};preloaded=[];arcs.preload=function(images){var img,_i,_len,_results;if(typeof images==="string"){images=[images]}_results=[];for(_i=0,_len=images.length;_i<_len;_i++){img=images[_i];if(__indexOf.call(preloaded,img)>=0){continue}$("<img />").attr("src",img).hide().appendTo("body");_results.push(preloaded.push(img))}return _results}}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.utils.Search=function(_super){__extends(Search,_super);function Search(){return Search.__super__.constructor.apply(this,arguments)}Search.prototype.options={container:null,query:"",loader:false,order:"modified",direction:"asc",page:1,n:25,add:false,run:true,onSearch:function(){},success:function(){},error:function(){}};Search.prototype.facets={id:[],sha:[],text:[],access:["public","private"],filetype:arcs.completeFacet,filename:arcs.completeFacet,title:arcs.completeFacet,user:arcs.completeFacet,keyword:arcs.completeFacet,type:arcs.completeFacet,created:function(){return arcs.completeDate("resources/complete/created")},uploaded:function(){return arcs.completeDate("resources/complete/created")},modified:function(){return arcs.completeDate("resources/complete/modified")}};Search.prototype.initialize=function(){var _ref,_this=this;_ref=[this.options.query,this.options.page],this.query=_ref[0],this.page=_ref[1];this.collection=this.results=new arcs.collections.ResultSet;this.vs=VS.init({container:this.options.container,query:this.query,callbacks:{search:function(query,searchCollection){_this.query=query;_this.options.page=1;_this.options.onSearch(query);return _this.run()},facetMatches:function(callback){return callback(_.keys(_this.facets))},valueMatches:function(facet,searchTerm,callback){var val;val=_this.facets[facet];if(typeof val==="function"){return callback(val(facet,encodeURIComponent(_this.query)))}else{return callback(val)}}}});if(this.options.run){return this.run()}};Search.prototype.setQuery=function(query){return this.vs.searchBox.setQuery(query)};Search.prototype.getLast=function(){return this.results.last(this.results.length%this.options.n||this.options.n)};Search.prototype.run=function(query,options){var params,_this=this;options=_.extend(_.clone(this.options),options);if(query==null){query=this.vs.searchBox.value()}params="?related&n="+options.n+("&page="+options.page)+("&order="+options.order)+("&direction="+options.direction);if(query){params+="&q="+encodeURIComponent(query)}if(options.loader){arcs.loader.show()}this.results.fetch({add:options.add,url:this.results.url()+params,success:function(set,res){_this.results.query=res;options.success();if(options.loader){return arcs.loader.hide()}},error:function(){options.error();if(options.loader){return arcs.loader.hide()}}});this.query=this.vs.searchBox.value();this.page=options.page;return this.results};return Search}(Backbone.View)}).call(this);(function(){if(!("open"in document.createElement("details"))){document.documentElement.className+=" no-details"}$(function(){$("body").on("focus","input[placeholder]",function(e){var $el;$el=$(e.currentTarget);if($el.val()===$el.attr("placeholder")){$el.val("");return $el.removeClass("unfocused")}});$("body").on("blur","input[placeholder]",function(e){var $el;$el=$(e.currentTarget);if($el.val()===""){$el.val($el.attr("placeholder"));return $el.addClass("unfocused")}});$("body").tooltip({selector:"[rel=tooltip]"});$("body").popover({selector:"[rel=popover]"});return $("body").delegate('input[type="text"][id*="date"]',"focus",function(e){return $(e.currentTarget).datepicker({format:"yyyy/mm/dd"})})})}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.routers.Search=function(_super){__extends(Search,_super);function Search(){return Search.__super__.constructor.apply(this,arguments)}Search.prototype.initialize=function(options){return this.search=options.search};Search.prototype.routes={"":"root","p:page":"emptyWithPage",":query/p:page":"doSearch",":query":"doSearch"};Search.prototype.root=function(){return this.hasTrailing=true&&this.doSearch()};Search.prototype.navigate=function(fragment,options){arcs.log("navigate",fragment);options||(options={});if(!this.hasTrailing){options.replace=true;this.hasTrailing=true}return Search.__super__.navigate.call(this,fragment,options)};Search.prototype.emptyWithPage=function(page){if(/\d+/.test(page)){return this.doSearch("",page)}else{return this.doSearch(page)}};Search.prototype.doSearch=function(query,page){if(query==null){query=""}if(page==null){page=1}if(query==="search"){return this.navigate("//p1",{replace:true})}this.search.setQuery(query);this.search.options.page=parseInt(page);this.search.run();this.navigate(""+encodeURIComponent(this.search.query)+"/p"+page);return this.searched=true};return Search}(Backbone.Router)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.routers.Viewer=function(_super){__extends(Viewer,_super);function Viewer(){return Viewer.__super__.constructor.apply(this,arguments)}Viewer.prototype.routes={":id":"noIndex",":id/":"noIndex",":id/:index":"indexChange"};Viewer.prototype.noIndex=function(id){return arcs.bus.trigger("indexChange",0,{noNavigate:true,replace:true})};Viewer.prototype.indexChange=function(id,index){if(_.isNumeric(index)){index-=1}return arcs.bus.trigger("indexChange",index,{noNavigate:true})};return Viewer}(Backbone.Router)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.models.Annotation=function(_super){__extends(Annotation,_super);function Annotation(){return Annotation.__super__.constructor.apply(this,arguments)}Annotation.prototype.url=function(){if(this.isNew()){return arcs.baseURL+"annotations"}return arcs.baseURL+("annotations/"+this.id)};Annotation.prototype.setScaled=function(box,height,width){return this.set({x1:box.x1/width,y1:box.y1/height,x2:box.x2/width,y2:box.y2/height})};Annotation.prototype.scaleTo=function(height,width){return{x1:this.get("x1")*width,y1:this.get("y1")*height,x2:this.get("x2")*width,y2:this.get("y2")*height}};Annotation.prototype.getType=function(){if(this.get("relation")){return"Relation"}if(this.get("transcript")){return"Transcription"}if(this.get("url")){return"URL"}};Annotation.prototype.parse=function(response){if(response.Annotation!=null){response=response.Annotation}return response};return Annotation}(Backbone.Model)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.models.Bookmark=function(_super){__extends(Bookmark,_super);function Bookmark(){return Bookmark.__super__.constructor.apply(this,arguments)}Bookmark.prototype.urlRoot=arcs.baseURL+"bookmarks";return Bookmark}(Backbone.Model)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.models.Collection=function(_super){__extends(Collection,_super);Collection.prototype.defaults={id:null,title:"Temporary Collection",description:"","public":false,members:[]};function Collection(attributes){Collection.__super__.constructor.call(this,this.parse(attributes))}Collection.prototype.urlRoot=arcs.baseURL+"collections/add";Collection.prototype.parse=function(c){var k,v,_ref;if(c.Collection!=null){_ref=c.Collection;for(k in _ref){v=_ref[k];c[k]=v}delete c.Collection}return c};return Collection}(Backbone.Model)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.models.Comment=function(_super){__extends(Comment,_super);function Comment(){return Comment.__super__.constructor.apply(this,arguments)}Comment.prototype.urlRoot=arcs.baseURL+"comments";return Comment}(Backbone.Model)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.models.Flag=function(_super){__extends(Flag,_super);Flag.prototype.urlRoot=arcs.baseURL+"flags";function Flag(attributes){Flag.__super__.constructor.call(this,this.parse(attributes))}Flag.prototype.parse=function(f){var k,v,_ref;if(f.Flag!=null){_ref=f.Flag;for(k in _ref){v=_ref[k];f[k]=v;delete f.Flag}if(f.User!=null){f.user=f.User;delete f.User}if(f.Resource!=null){f.resource=f.Resource;delete f.Resource}}return f};return Flag}(Backbone.Model)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.models.Job=function(_super){__extends(Job,_super);function Job(){return Job.__super__.constructor.apply(this,arguments)}Job.prototype.urlRoot=arcs.baseURL+"jobs";return Job}(Backbone.Model)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.models.Keyword=function(_super){__extends(Keyword,_super);function Keyword(){return Keyword.__super__.constructor.apply(this,arguments)}Keyword.prototype.url=function(){if(this.isNew()){return arcs.baseURL+"keywords"}return arcs.baseURL+("keywords/"+this.id)};return Keyword}(Backbone.Model)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.models.MetadataContainer=function(_super){__extends(MetadataContainer,_super);function MetadataContainer(){return MetadataContainer.__super__.constructor.apply(this,arguments)}MetadataContainer.prototype.url=function(){return arcs.baseURL+"resources/metadata/"+this.id};return MetadataContainer}(Backbone.Model)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.models.Resource=function(_super){__extends(Resource,_super);Resource.prototype.defaults={title:"",keywords:[],annotations:[],comments:[],metadata:{},mime_type:"unknown",page:0,preview:false,"public":false,selected:false};function Resource(attributes){Resource.__super__.constructor.call(this,this.parse(attributes))}Resource.prototype.url=function(){return arcs.baseURL+"resources/"+this.id};Resource.prototype.urlRoot=arcs.baseURL+"resources";Resource.prototype.parse=function(r){var k,m,v,_i,_j,_len,_len1,_ref,_ref1,_ref2;if(r.Resource!=null){_ref=r.Resource;for(k in _ref){v=_ref[k];r[k]=v}if(r.User!=null){r.user=r.User;delete r.User}if(r.Keyword!=null){r.keywords=function(){var _i,_len,_ref1,_results;_ref1=r.Keyword;_results=[];for(_i=0,_len=_ref1.length;_i<_len;_i++){k=_ref1[_i];_results.push(k.keyword)}return _results}();delete r.Keyword}if(r.Comment!=null){r.comments=r.Comment;delete r.Comment}if(r.Flag!=null){r.flags=r.Flag;delete r.Flag}if(r.Membership!=null){r.memberships={};_ref1=r.Membership;for(_i=0,_len=_ref1.length;_i<_len;_i++){m=_ref1[_i];r.memberships[m.collection_id]=parseInt(m.page)}delete r.Membership}if(r.Annotation!=null){r.annotations=r.Annotation;delete r.Annotation}if(r.Metadatum!=null){r.metadata=new arcs.models.MetadataContainer;r.metadata.id=r.id;_ref2=r.Metadatum;for(_j=0,_len1=_ref2.length;_j<_len1;_j++){m=_ref2[_j];r.metadata.set(m.attribute,m.value)}delete r.Metadatum}delete r.Resource}if(r.modified===r.created){r.modified=false}return r};return Resource}(Backbone.Model)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.models.Upload=function(_super){__extends(Upload,_super);function Upload(){return Upload.__super__.constructor.apply(this,arguments)}Upload.prototype.defaults={name:null,sha:null,identifier:null,progress:0,size:0,error:0,type:"unknown",title:null,lastModifiedDate:null};return Upload}(Backbone.Model)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.models.User=function(_super){__extends(User,_super);function User(){return User.__super__.constructor.apply(this,arguments)}User.prototype.ROLES={Admin:0,"Sr. Researcher":1,Researcher:2,Guest:3};User.prototype.urlRoot=arcs.baseURL+"users";User.prototype.is=function(role){return this.get("role")<=this.ROLES[role]};User.prototype.isLoggedIn=function(){return this.id!=null};User.prototype.isAdmin=function(){return this.get("role")===this.ROLES["Admin"]};return User}(Backbone.Model)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.collections.AnnotationList=function(_super){__extends(AnnotationList,_super);function AnnotationList(){return AnnotationList.__super__.constructor.apply(this,arguments)}AnnotationList.prototype.model=arcs.models.Annotation;AnnotationList.prototype.url=function(){return arcs.baseURL+"resources/annotations/"+arcs.resource.id};AnnotationList.prototype.parse=function(r){if(r.relations!=null){this.relations=new arcs.collections.Collection(r.relations)}return r.annotations};return AnnotationList}(Backbone.Collection)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.collections.Collection=function(_super){__extends(Collection,_super);function Collection(){return Collection.__super__.constructor.apply(this,arguments)}Collection.prototype.model=arcs.models.Resource;Collection.prototype.comparator=function(resource){return resource.get("page")};return Collection}(Backbone.Collection)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.collections.CollectionList=function(_super){__extends(CollectionList,_super);function CollectionList(){return CollectionList.__super__.constructor.apply(this,arguments)}CollectionList.prototype.model=arcs.models.Collection;return CollectionList}(Backbone.Collection)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.collections.Discussion=function(_super){__extends(Discussion,_super);function Discussion(){return Discussion.__super__.constructor.apply(this,arguments)}Discussion.prototype.model=arcs.models.Comment;Discussion.prototype.url=function(){return arcs.baseURL+"resources/comments/"+arcs.resource.id};Discussion.prototype.parse=function(response){var r,_i,_len,_results;_results=[];for(_i=0,_len=response.length;_i<_len;_i++){r=response[_i];_results.push(_.extend(r.User,r.Comment))}return _results};return Discussion}(Backbone.Collection)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.collections.FlagList=function(_super){__extends(FlagList,_super);function FlagList(){return FlagList.__super__.constructor.apply(this,arguments)}FlagList.prototype.model=arcs.models.Flag;FlagList.prototype.url=function(){return arcs.baseURL+"resources/flags/"+arcs.resource.id};FlagList.prototype.parse=function(response){var r,_i,_len,_results;_results=[];for(_i=0,_len=response.length;_i<_len;_i++){r=response[_i];_results.push(r.Flag)}return _results};return FlagList}(Backbone.Collection)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.collections.JobList=function(_super){__extends(JobList,_super);function JobList(){return JobList.__super__.constructor.apply(this,arguments)}JobList.prototype.model=arcs.models.Job;return JobList}(Backbone.Collection)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.collections.KeywordList=function(_super){__extends(KeywordList,_super);function KeywordList(){return KeywordList.__super__.constructor.apply(this,arguments)}KeywordList.prototype.model=arcs.models.Keyword;KeywordList.prototype.url=function(){return arcs.baseURL+"resources/keywords/"+arcs.resource.id};KeywordList.prototype.parse=function(response){var k,keywords,r,_i,_len;keywords=function(){var _i,_len,_results;_results=[];for(_i=0,_len=response.length;_i<_len;_i++){r=response[_i];_results.push(r.Keyword)}return _results}();for(_i=0,_len=keywords.length;_i<_len;_i++){k=keywords[_i];k.link=arcs.baseURL+"search/"+encodeURIComponent("keyword: '"+k.keyword+"'")}return keywords};return KeywordList}(Backbone.Collection)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.collections.ResultSet=function(_super){__extends(ResultSet,_super);function ResultSet(){return ResultSet.__super__.constructor.apply(this,arguments)}ResultSet.prototype.model=arcs.models.Resource;ResultSet.prototype.url=function(){return arcs.baseURL+"resources/search"};ResultSet.prototype.selected=function(){return this.filter(function(result){return result.get("selected")})};ResultSet.prototype.notSelected=function(){return this.reject(function(result){return result.get("selected")})};ResultSet.prototype.anySelected=function(){return this.any(function(result){return result.get("selected")})};ResultSet.prototype.numSelected=function(){return this.selected().length};ResultSet.prototype.select=function(result){return this._eachSetSelected(result,function(){return true})};ResultSet.prototype.toggle=function(result){return this._eachSetSelected(result,function(m){return!m.get("selected")})};ResultSet.prototype.unselect=function(result){return this._eachSetSelected(result,function(){return false})};ResultSet.prototype.unselectAll=function(){return this.each(function(result){return result.set("selected",false,{silent:true})})};ResultSet.prototype._eachSetSelected=function(result,func){var id,model,_i,_len,_results;if(!_.isArray(result)){result=[result]}_results=[];for(_i=0,_len=result.length;_i<_len;_i++){id=result[_i];model=this.get(id);if(!model){continue}_results.push(model.set("selected",func(model),{silent:true}))}return _results};ResultSet.prototype.parse=function(response){this.metadata=response;return response.results};return ResultSet}(Backbone.Collection)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.collections.UploadSet=function(_super){__extends(UploadSet,_super);function UploadSet(){return UploadSet.__super__.constructor.apply(this,arguments)}UploadSet.prototype.model=arcs.models.Upload;UploadSet.prototype.url=function(){return arcs.baseURL+"uploads"};return UploadSet}(Backbone.Collection)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.collections.UserList=function(_super){__extends(UserList,_super);function UserList(){return UserList.__super__.constructor.apply(this,arguments)}UserList.prototype.model=arcs.models.User;return UserList}(Backbone.Collection)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.views.Modal=function(_super){__extends(Modal,_super);function Modal(){return Modal.__super__.constructor.apply(this,arguments)}Modal.prototype.options={draggable:true,backdrop:true,keyboard:true,show:true,"class":"",title:"No Title",subtitle:null,template:"ui/modal",inputs:{},buttons:{}};Modal.prototype.initialize=function(){var $sel,name,options,_ref,_ref1;$("#modal").remove();$(".modal-backdrop").remove();$("body").append(arcs.tmpl("ui/modal_wrapper"));this.el=this.$el=$("#modal");if(this.options["class"]){this.$el.addClass(this.options["class"])}this.$el.html(arcs.tmpl(this.options.template,this.options));_ref=this.options.inputs;for(name in _ref){options=_ref[name];$sel=this.$("#modal-"+name+"-input");if(options.complete||options.multicomplete){arcs.utils.autocomplete({sel:$sel,multiple:!!options.multicomplete,source:(_ref1=options.multicomplete)!=null?_ref1:options.complete})}}if(this.options.draggable){this.$el.draggable({handle:this.$(".modal-header")});this.$(".modal-header").css("cursor","move")}this.$el.modal({backdrop:this.options.backdrop,keyboard:this.options.keyboard,show:this.options.show});return this.bindButtons()};Modal.prototype.hide=function(){return this.$el.modal("hide")};Modal.prototype.show=function(){return this.$el.modal("show")};Modal.prototype.isOpen=function(){return this.$el.is(":visible")};Modal.prototype.validate=function(){var name,options,required,values,_i,_len,_ref;this.$("#validation-error").hide();this.$(".error").removeClass("error");values=this.getValues();required=[];_ref=this.options.inputs;for(name in _ref){options=_ref[name];if(options.required){if(!values[name].replace(/\s/g,"").length){required.push(name)}}}if(!required.length){return true}for(_i=0,_len=required.length;_i<_len;_i++){name=required[_i];this.$("#modal-"+name+"-input").addClass("error");this.$("label[for='modal-"+name+"']").addClass("error")}this.$("#validation-error").show().html("Looks like you missed a required field.");return false};Modal.prototype.getValues=function(){var name,values;values={};for(name in this.options.inputs){values[name]=this.$("#modal-"+name+"-input").val()}return values};Modal.prototype.bindButtons=function(){var name,_results,_this=this;_results=[];for(name in this.options.buttons){_results.push(this.$("button#modal-"+name+"-button").click(function(e){var callback,cb,context,options,valid,_ref,_ref1,_ref2;name=e.target.id.match(/modal-([\w-]+)-button/)[1];options=_this.options.buttons[name];if(_.isFunction(options)){cb=options}else{_ref2=[(_ref=options.callback)!=null?_ref:function(){},(_ref1=options.context)!=null?_ref1:window],callback=_ref2[0],context=_ref2[1];cb=_.bind(callback,context)}valid=options.validate?_this.validate():true;if(valid){cb(_this.getValues())}if(!(options.close!=null&&options.close||!valid)){return _this.hide()}}))}return _results};return Modal}(Backbone.View)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};arcs.views.BaseActions=function(_super){__extends(BaseActions,_super);function BaseActions(){return BaseActions.__super__.constructor.apply(this,arguments)}BaseActions.prototype.openResource=function(resource){if(this._modelFromRef!=null){resource=this._modelFromRef(resource)}return window.open(arcs.baseURL+"resource/"+resource.id)};BaseActions.prototype.keywordResource=function(resource,string){var keyword;resource.set("keywords",resource.get("keywords").concat(string));keyword=new arcs.models.Keyword({resource_id:resource.id,keyword:string});return keyword.save()};BaseActions.prototype.flagResource=function(resource,reason,explanation){var flag;flag=new arcs.models.Flag({resource_id:resource.id,reason:reason,explanation:explanation});return flag.save()};BaseActions.prototype.editResource=function(resource,attributes){var key,metadata,value,_metadata,_resource;metadata=resource.get("metadata");_resource=_.clone(resource.attributes);_metadata=_.clone(metadata.attributes);for(key in attributes){value=attributes[key];if(__indexOf.call(_.keys(resource.attributes),key)>=0){resource.set(key,value)}else if(metadata.get(key)||value){metadata.set(key,value)}}if(!_.isEqual(resource.attributes,_resource)){resource.save()}if(!_.isEqual(metadata.attributes,_metadata)){metadata.save();return resource.trigger("change")}};BaseActions.prototype.bookmarkResource=function(resource,note){var bkmk;bkmk=new arcs.models.Bookmark({resource_id:resource.id,description:note});return bkmk.save()};BaseActions.prototype.downloadResource=function(resource){var iframe;iframe=this.make("iframe",{style:"display: none",id:"downloader-for-"+resource.id});$("body").append(iframe);return iframe.src=arcs.baseURL+"resources/download/"+resource.id};BaseActions.prototype.splitResource=function(resource){if(resource.get("mime_type")!=="application/pdf"){return}return $.post(arcs.baseURL+"resources/split_pdf/"+resource.id,function(){return arcs.notify("Resource successfully queued for split.")})};BaseActions.prototype.rethumbResource=function(resource){return $.post(arcs.baseURL+"resources/rethumb/"+resource.id,function(){return arcs.notify("Resource successfully queued for re-thumbnail.")})};BaseActions.prototype.repreviewResource=function(resource){return $.post(arcs.baseURL+"resources/repreview/"+resource.id,function(){return arcs.notify("Resource successfully queued for re-preview.")})};BaseActions.prototype.indexResource=function(resource){return $.post(arcs.baseURL+"resources/solr/"+resource.id,function(){return arcs.notify("Resource successfully queued for SOLR index.")})};return BaseActions}(Backbone.View)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.views.CollectionList=function(_super){__extends(CollectionList,_super);function CollectionList(){return CollectionList.__super__.constructor.apply(this,arguments)}CollectionList.prototype.initialize=function(){var _this=this;this.search=new arcs.utils.Search({container:$(".search-wrapper"),run:false,onSearch:function(){return location.href=arcs.url("search",_this.search.query)}});this.render();return this.$("details.open").each(function(i,el){return _this.renderDetails($(el))})};CollectionList.prototype.events={"click summary":"onClick","click details.closed":"onClick","click #delete-btn":"deleteCollection"};CollectionList.prototype.onClick=function(e){var $el,_ref;if(e.currentTarget.tagName==="DETAILS"){$el=$(e.currentTarget)}else{$el=$(e.currentTarget).parent()}console.log($el);$el.toggleAttr("open");$el.toggleClass("closed").toggleClass("open");this.renderDetails($el);if((_ref=e.srcElement.tagName)!=="SPAN"&&_ref!=="BUTTON"&&_ref!=="I"&&_ref!=="A"){e.preventDefault();return false}};CollectionList.prototype.deleteCollection=function(e){var $parent,id,model,_this=this;e.preventDefault();$parent=$(e.currentTarget).parents("details");id=$parent.data("id");model=this.collection.get(id);return arcs.confirm("Are you sure you want to delete this collection?","<p>Collection <b>"+model.get("title")+"</b> will be "+"deleted. <p><b>N.B.</b> Resources within the collection will not be "+"deleted. They may still be accessed from other collections to which they "+"belong.",function(){arcs.loader.show();return $.ajax({url:arcs.url("collections","delete",model.id),type:"DELETE",success:function(){_this.collection.remove(model,{silent:true});_this.render();return arcs.loader.hide()}})})};CollectionList.prototype.render=function(){this.$el.html(arcs.tmpl("collections/list",{collections:this.collection.toJSON()}));return this};CollectionList.prototype.renderDetails=function($el){var id,query;id=$el.data("id");query=encodeURIComponent('collection_id:"'+id+'"');return $.getJSON(arcs.baseURL+("resources/search?n=12&q="+query),function(response){return $el.children(".results").html(arcs.tmpl("home/details",{resources:response.results,searchURL:arcs.baseURL+("collection/"+id)}))})};return CollectionList}(Backbone.View)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.views.Home=function(_super){__extends(Home,_super);function Home(){return Home.__super__.constructor.apply(this,arguments)}Home.prototype.initialize=function(){var _this=this;this.search=new arcs.utils.Search({container:$(".search-wrapper"),run:false,onSearch:function(){return location.href=arcs.url("search",_this.search.query)}});return this.renderDetails($("details:first"))};Home.prototype.events={"click summary":"onClick"};Home.prototype.onClick=function(e){var $el;$el=$(e.currentTarget).parent();$el.toggleAttr("open");this.renderDetails($el);e.preventDefault();return false};Home.prototype.renderDetails=function($el){var query,type;type=$el.data("type");query=encodeURIComponent('type: "'+type+'"');return $.getJSON(arcs.baseURL+("resources/search?n=12&q="+query),function(response){var html;html=arcs.tmpl("home/details",{resources:response.results});return $el.children("div").html(html)})};return Home}(Backbone.View)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.views.Profile=function(_super){__extends(Profile,_super);function Profile(){return Profile.__super__.constructor.apply(this,arguments)}Profile.prototype.events={"click #edit-btn":"editAccount"};Profile.prototype.editAccount=function(){var _this=this;return new arcs.views.Modal({title:"Edit Your Account",subtitle:"If you'd like your password to stay the same, leave the "+"password field blank.",inputs:{name:{value:this.model.get("name")},username:{value:this.model.get("username")},email:{value:this.model.get("email")},password:{type:"password"}},buttons:{save:{validate:true,"class":"btn btn-success",callback:function(vals){if(vals.password===""){delete vals.password}arcs.loader.show();return _this.model.save(vals,{success:arcs.loader.hide})}},cancel:function(){}}})};return Profile}(Backbone.View)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};arcs.views.Upload=function(_super){__extends(Upload,_super);function Upload(){return Upload.__super__.constructor.apply(this,arguments)}Upload.prototype.UPLOAD_ERR_OK=0;Upload.prototype.UPLOAD_ERR_INI_SIZE=1;Upload.prototype.UPLOAD_ERR_FORM_SIZE=2;Upload.prototype.UPLOAD_ERR_PARTIAL=3;Upload.prototype.UPLOAD_ERR_NO_FILE=4;Upload.prototype.pending=0;Upload.prototype.progress=0;Upload.prototype.allDone=false;Upload.prototype.initialize=function(){this.uploads=new arcs.collections.UploadSet;this.setupFileupload();this.$uploads=this.$el.find("#uploads-container");return this.uploads.on("add remove change",this.render,this)};Upload.prototype.events={"click #upload-btn":"upload","click .remove":"remove"};Upload.prototype.setupFileupload=function(){var _this=this;this.fileupload=this.$el.find("#fileupload");return this.fileupload.fileupload({dataType:"json",url:arcs.url("uploads/add_files"),add:function(e,data){var existing,f,maybeUploads,u,upload,uploads,_i,_len;maybeUploads=function(){var _i,_len,_ref,_results;_ref=data.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){f=_ref[_i];_results.push(new arcs.models.Upload(f))}return _results}();existing=_this.uploads.pluck("name");uploads=_.reject(maybeUploads,function(u){var name;name=u.get("name");if(__indexOf.call(existing,name)>=0){arcs.notify("You tried to add '"+name+"', but a file with that "+"name is already being uploaded, so we couldn't add it. If it is "+"not the same file, change the name or upload it in another "+"batch.","error",false);return true}return false});if(!uploads.length){return false}_this.uploads.add(uploads);for(_i=0,_len=uploads.length;_i<_len;_i++){u=uploads[_i];upload=u.toJSON();upload.cid=u.cid;_this.$uploads.append(arcs.tmpl("upload/list",upload))}_this.$("span#drop-msg").remove();_this.$("#upload-btn").addClass("disabled");data.submit();return _this.pending+=1},fail:function(e,data){if(data.errorThrown==="Forbidden"){return arcs.needsLogin()}},progress:function(e,data){var f,model,progress,_i,_len,_ref;progress=parseInt(data.loaded/data.total*100,10);_ref=data.files;for(_i=0,_len=_ref.length;_i<_len;_i++){f=_ref[_i];model=_this.uploads.find(function(m){return m.get("name")===f.name});model.set("progress",progress)}return _this.render()},progressall:function(e,data){_this.progress=data.loaded/data.total*100;return _this.render()},done:function(e,data){var f,model,response,_i,_len,_ref;_ref=data.files;for(_i=0,_len=_ref.length;_i<_len;_i++){f=_ref[_i];model=_this.uploads.find(function(m){return m.get("name")===f.name});response=_.find(data.result,function(r){return r.name===f.name});model.set("progress",100);model.set("sha",response.sha);model.set("error",response.error)}_this.pending-=1;if(!_this.pending){_this.$el.find("#upload-btn").removeClass("disabled");_this.allDone=true}return _this.checkForErrors()&&_this.render()}})};Upload.prototype.upload=function(){var _this=this;if(this.pending!==0){return arcs.notify("Downloads are still pending.","error")}if(!this.uploads.length){return arcs.notify("Choose a file to upload.","error")}this.uploads.each(function(u){var $u;$u=_this.$uploads.find(".upload[data-id="+u.cid+"]");u.set("title",$u.find("#upload-title").val());u.set("identifier",$u.find("#upload-identifier").val());u.set("rtype",$u.find("#upload-type").val());if(u.get("identifier")==="Identifier"){return u.set("identifier","")}});return $.postJSON(arcs.baseURL+"uploads/batch",this.uploads.toJSON(),function(data){return location.href=arcs.url("search/")})};Upload.prototype.checkForErrors=function(){var error,msg,upload,_i,_len,_ref,_results;_ref=this.uploads.models;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){upload=_ref[_i];error=upload.get("error");if(error===this.UPLOAD_ERR_OK){continue}if(error===this.UPLOAD_ERR_INI_SIZE||error===this.UPLOAD_ERR_FORM_SIZE){msg="The file '"+upload.get("name")+"' was too large. If "+"possible, split the file into pieces."}else if(error===this.UPLOAD_ERR_PARTIAL){msg="The file '"+upload.get("name")+"' was only partially "+"uploaded. Please refresh the page and try again."}else{msg="Something went wrong. Please refresh the page and "+"try again. If the problem persists, contact the system "+"administrator."}msg+=" For more information, see our "+("<a href='"+arcs.url("help/uploading")+"'>Uploading ")+"documentation.</a>";arcs.notify(msg,"error",false);_results.push(this.disable())}return _results};Upload.prototype.remove=function(e){var $upload;$upload=this.$(e.currentTarget).parents(".upload");this.uploads.remove(this.uploads.getByCid($upload.data("id")));$upload.remove();if(!this.uploads.length){return this.$("#upload-btn").addClass("disabled")}};Upload.prototype.disable=function(){this.$el.addClass("disabled");return this.$el.find("a, button").addClass("disabled")};Upload.prototype.render=function(){var $u,msg,upload,_i,_len,_ref;_ref=this.uploads.models;for(_i=0,_len=_ref.length;_i<_len;_i++){upload=_ref[_i];$u=this.$uploads.find(".upload[data-id="+upload.cid+"]");if(upload.get("progress")<100){$u.find(".bar").css("width",upload.get("progress")+"%")}else{$u.find(".progress").hide();$u.find("span#progress-done").show()}}if(this.allDone){msg="<i class='icon-ok'></i> All Done"}else if(this.progress===100||this.pending===0){msg="<i class='icon-time'></i> Waiting on server..."}else{msg=""+this.progress.toFixed(2)+"% ("+this.pending+" pending)"}this.$("span#progress-all").html(msg);return this};return Upload}(Backbone.View)}).call(this);(function(){var _base,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};if((_ref=(_base=arcs.views).admin)==null){_base.admin={}}arcs.views.admin.Flags=function(_super){__extends(Flags,_super);function Flags(){return Flags.__super__.constructor.apply(this,arguments)}Flags.prototype.initialize=function(){this.collection.on("add remove change sync",this.render,this);return this.render()};Flags.prototype.render=function(){this.$("#flags").html(arcs.tmpl("admin/flags",{flags:this.collection.toJSON()}));return this};return Flags}(Backbone.View)}).call(this);(function(){var _base,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};if((_ref=(_base=arcs.views).admin)==null){_base.admin={}}arcs.views.admin.Jobs=function(_super){__extends(Jobs,_super);function Jobs(){return Jobs.__super__.constructor.apply(this,arguments)}Jobs.prototype.JOB_STATUSES={done:0,pending:1,failing:2,failed:3,interrupted:4};Jobs.prototype.options={autoUpdate:false,updateEvery:15e3};Jobs.prototype.initialize=function(){this.collection.on("add remove change reset sync",this.render,this);this.collection.url=arcs.baseURL+"jobs";this.filterJobs();this.lastUpdated=new Date;setInterval(_.bind(this.render,this),5e3);return setInterval(_.bind(this.update,this),this.options.updateEvery)};Jobs.prototype.events={"keyup #filter-input":"filterJobs","change #auto-update":"setUpdate","click #retry-btn":"retryJob","click #delete-btn":"deleteJob","click #release-btn":"releaseJob","click #show-btn":"showJob"};Jobs.prototype.showJob=function(e){var job;job=this.collection.get($(e.currentTarget).data("id"));return arcs.prompt("Job "+job.id,arcs.tmpl("admin/show_job",job.toJSON()))};Jobs.prototype.retryJob=function(e){var job,_this=this;job=this.collection.get($(e.currentTarget).data("id"));return arcs.confirm("Are you sure you want to retry this job?","Job <b>"+job.id+"</b> will be set to <b>pending</b>.",function(){job.set({status:"1",failed_at:null,error:null});arcs.loader.show();return job.save({},{success:function(){return arcs.loader.hide()}})})};Jobs.prototype.deleteJob=function(e){var job,_this=this;job=this.collection.get($(e.currentTarget).data("id"));return arcs.confirm("Are you sure you want to delete this job?","Job <b>"+job.id+"</b> will be deleted.",function(){arcs.loader.show();return job.destroy({success:function(){return arcs.loader.hide()}})})};Jobs.prototype.releaseJob=function(e){var job,_this=this;job=this.collection.get($(e.currentTarget).data("id"));return arcs.confirm("Are you sure you want to release this job?","Job <b>"+job.id+"</b> will be released.",function(){arcs.loader.show();return job.save({locked_by:null,locked_at:null},{success:function(){return arcs.loader.hide()}})})};Jobs.prototype.filterJobs=function(){var val;val=this.$("#filter-input").val();if(this.JOB_STATUSES[val]!=null){val=this.JOB_STATUSES[val]}this.filter=new RegExp(val,"i");return this.render()};Jobs.prototype.setUpdate=function(){return this.options.autoUpdate=!this.options.autoUpdate};Jobs.prototype.update=function(){var _this=this;if(!this.options.autoUpdate){return}return this.collection.fetch({success:function(){return _this.lastUpdated=new Date}})};Jobs.prototype.render=function(){var filtered,m,_this=this;filtered=this.collection.filter(function(m){return m.get("status").match(_this.filter)||m.get("name").match(_this.filter)});this.$("#jobs").html(arcs.tmpl("admin/jobs",{jobs:function(){var _i,_len,_results;_results=[];for(_i=0,_len=filtered.length;_i<_len;_i++){m=filtered[_i];_results.push(m.toJSON())}return _results}()}));this.$("#time").html(relativeDate(this.lastUpdated));$(".popover").hide();this.$(".has-error").popover();return this};return Jobs}(Backbone.View)}).call(this);(function(){var _base,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};if((_ref=(_base=arcs.views).admin)==null){_base.admin={}}arcs.views.admin.Users=function(_super){__extends(Users,_super);function Users(){return Users.__super__.constructor.apply(this,arguments)}Users.prototype.USER_ROLES={Researcher:2,"Sr. Researcher":1,Admin:0};Users.prototype.initialize=function(){this.collection.on("add remove change sync",this.render,this);return this.render()};Users.prototype.events={"click #delete-btn":"deleteUser","click #edit-btn":"editUser","click #new-btn":"newUser","click #invite-btn":"sendInvite"};Users.prototype.deleteUser=function(e){var user,_this=this;user=this.collection.get($(e.currentTarget).data("id"));return arcs.confirm("Are you sure you want to delete this user?","The account for <b>"+user.get("name")+"</b> will be deleted.",function(){arcs.loader.show();return user.destroy({success:arcs.loader.hide})})};Users.prototype.editUser=function(e){var user,_this=this;user=this.collection.get($(e.currentTarget).data("id"));new arcs.views.Modal({title:"Edit user",inputs:{name:{value:user.get("name")},username:{value:user.get("username")},email:{value:user.get("email")},role:{type:"select",options:this.USER_ROLES}},buttons:{save:{"class":"btn btn-success",callback:function(vals){arcs.loader.show();user.unset("password");return user.save(vals,{success:arcs.loader.hide})}},cancel:function(){}}});return $("#modal-role-input").val(user.get("role"))};Users.prototype.newUser=function(){var _this=this;return new arcs.views.Modal({title:"Create a new user",inputs:{name:{focused:true},username:true,email:true,password:{type:"password"},role:{type:"select",options:this.USER_ROLES}},buttons:{save:{"class":"btn btn-success",callback:function(vals){var user;user=new arcs.models.User(vals);arcs.loader.show();return user.save({},{success:function(m,r){user.id=r.id;arcs.loader.hide();return _this.collection.add(user)}})}},cancel:function(){}}})};Users.prototype.sendInvite=function(){var _this=this;return new arcs.views.Modal({title:"Invite someone to ARCS",subtitle:"Provide an email address and we'll send them a link that will "+"allow them to create an account.",inputs:{email:{focused:true},role:{type:"select",options:this.USER_ROLES}},buttons:{send:{"class":"btn btn-success",callback:function(vals){vals.email=$.trim(vals.email);return $.postJSON(arcs.baseURL+"users/invite",vals,function(){return _this.collection.add(vals)})}},cancel:function(){}}})};Users.prototype.render=function(){this.$("#users").html(arcs.tmpl("admin/users",{users:this.collection.toJSON()}));return this};return Users}(Backbone.View)}).call(this);(function(){var _base,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};if((_ref=(_base=arcs.views).search)==null){_base.search={}}arcs.views.search.Actions=function(_super){__extends(Actions,_super);function Actions(){return Actions.__super__.constructor.apply(this,arguments)}Actions.prototype.initialize=function(){this.results=this.collection;this.ctxMenu=new arcs.views.ContextMenu({el:$(document),filter:"img",options:this._getContextOptions(),onShow:function(e){$(e.currentTarget).parents(".result").addClass("selected");return arcs.bus.trigger("selection")},context:this});return arcs.keys.map(this,{"ctrl+o":this.openSelected,"ctrl+e":arcs.user.isLoggedIn()?this.editSelected:function(){},space:this.previewSelected})};Actions.prototype.events={"dblclick img":"openResource","click #open-btn":"openSelected","click #open-colview-btn":"collectionFromSelected","click #collection-btn":"namedCollectionFromSelected","click #collection-add-btn":"addToCollection","click #attribute-btn":"editSelected","click #flag-btn":"flagSelected","click #delete-btn":"deleteSelected","click #bookmark-btn":"bookmarkSelected","click #keyword-btn":"keywordSelected","click #download-btn":"downloadSelected","click #zipped-btn":"zippedDownloadSelected","click #rethumb-btn":"rethumbSelected","click #repreview-btn":"repreviewSelected","click #split-btn":"splitSelected","click #access-btn":"setAccessForSelected","click #solr-btn":"indexSelected"};Actions.prototype.deleteSelected=function(){var n,_this=this;if(!this.results.anySelected()){return}n=this.results.numSelected();return new arcs.views.Modal({title:"Delete Selected",subtitle:""+n+" "+arcs.inflector.pluralize("resource",n)+" will be "+"permanently deleted.",buttons:{"delete":{"class":"btn btn-danger",callback:function(){var result,_i,_len,_ref1;_ref1=_this.results.selected();for(_i=0,_len=_ref1.length;_i<_len;_i++){result=_ref1[_i];result.destroy()}return _this._notify("deleted",n)}},cancel:function(){}}})};Actions.prototype.keywordSelected=function(){var n,_this=this;if(!this.results.anySelected()){return}n=this.results.numSelected();return new arcs.views.Modal({title:"Keyword Selected",subtitle:"The keyword will be applied to "+n+" "+(""+arcs.inflector.pluralize("resource",n)+"."),backdrop:true,inputs:{keyword:{label:false,complete:arcs.complete("keywords/complete"),focused:true,required:true}},buttons:{save:{"class":"btn btn-success",validate:true,callback:function(vals){var result,_i,_len,_ref1;_ref1=_this.results.selected();for(_i=0,_len=_ref1.length;_i<_len;_i++){result=_ref1[_i];_this.keywordResource(result,vals.keyword)}return _this._notify("keyworded")}},cancel:function(){}}})};Actions.prototype.rethumbSelected=function(){var result,_i,_len,_ref1,_results;_ref1=this.results.selected();_results=[];for(_i=0,_len=_ref1.length;_i<_len;_i++){result=_ref1[_i];_results.push(this.rethumbResource(result))}return _results};Actions.prototype.splitSelected=function(){var result,_i,_len,_ref1,_results;_ref1=this.results.selected();_results=[];for(_i=0,_len=_ref1.length;_i<_len;_i++){result=_ref1[_i];_results.push(this.splitResource(result))}return _results};Actions.prototype.flagSelected=function(){var n,_this=this;if(!this.results.anySelected()){return}n=this.results.numSelected();return new arcs.views.Modal({title:"Flag Selected",subtitle:""+n+" "+arcs.inflector.pluralize("resource",n)+" will be flagged.",inputs:{reason:{type:"select",options:_.inverse(arcs.config.flags)},explain:{type:"textarea"}},buttons:{save:{"class":"btn btn-success",callback:function(vals){var result,_i,_len,_ref1;_ref1=_this.results.selected();for(_i=0,_len=_ref1.length;_i<_len;_i++){result=_ref1[_i];_this.flagResource(result,vals.reason,vals.explain)}return _this._notify("flagged")}},cancel:function(){}}})};Actions.prototype.editSelected=function(){var field,fields,help,inputs,metadata,result,_ref1,_this=this;if(!this.results.anySelected()){return}if(this.results.numSelected()>1){return this.batchEditSelected()}result=this.results.selected()[0];inputs={title:{value:result.get("title")},type:{type:"select",options:_.keys(arcs.config.types),value:result.get("type")}};metadata=result.get("metadata");fields=arcs.config.metadata;for(field in fields){help=fields[field];inputs[field]={value:(_ref1=metadata.get(field))!=null?_ref1:"",help:help}}return new arcs.views.Modal({title:"Edit Info",subtitle:"",template:"ui/modal_columned",inputs:inputs,buttons:{save:{"class":"btn btn-success",callback:function(values){return _this.editResource(result,values)}},cancel:function(){}}})};Actions.prototype.batchEditSelected=function(){var checked,field,help,inputs,results,types,value,values,_ref1,_this=this;results=this.results.selected();types=_.map(results,function(r){return r.get("type")});inputs={type:{type:"select",options:_.keys(arcs.config.types),value:_.twins(types)?results[0].get("type"):"",checkbox:_.twins(types)&&results[0].get("type")}};_ref1=arcs.config.metadata;for(field in _ref1){help=_ref1[field];if(__indexOf.call(arcs.config.metadataSingular,field)>=0){continue}values=_.map(results,function(r){return r.get("metadata").get(field)});checked=_.twins(values)&&values[0];value=_.twins(values)&&values[0]?values[0]:void 0;inputs[field]={checkbox:!!checked,value:value!=null?value:"",help:help}}return new arcs.views.BatchEditModal({title:"Edit Info (Multiple)",subtitle:"The values of checked fields will be applied to all "+"of the selected results, even when blank.",template:"ui/modal_columned",inputs:inputs,buttons:{save:{"class":"btn btn-success",callback:function(values){var r,_i,_len,_ref2,_results;_ref2=_this.results.selected();_results=[];for(_i=0,_len=_ref2.length;_i<_len;_i++){r=_ref2[_i];_results.push(_this.editResource(r,values))}return _results}},cancel:function(){}}})};Actions.prototype.namedCollectionFromSelected=function(){var n;if(!this.results.anySelected()){return}n=this.results.numSelected();return new arcs.views.Modal({title:"Create a Collection",subtitle:"A collection with "+n+" "+arcs.inflector.pluralize("resource",n)+" "+"will be created.",inputs:{title:{focused:true},description:{type:"textarea"}},buttons:{save:{"class":"btn btn-success",callback:this.collectionFromSelected,context:this},cancel:function(){}}})};Actions.prototype.collectionFromSelected=function(vals){var collection,_ref1,_ref2,_this=this;if(!this.results.anySelected()){return}collection=new arcs.models.Collection({title:(_ref1=vals.title)!=null?_ref1:"Temporary Collection",description:(_ref2=vals.description)!=null?_ref2:"Results from search","public":false,temporary:true,members:_.map(this.results.selected(),function(r){return r.get("id")})});return collection.save({},{success:function(newCol){return window.open(arcs.url("collection",newCol.id))},error:function(){return arcs.notify("An error occurred.","error")}})};Actions.prototype.addToCollection=function(){var n,_this=this;n=this.results.numSelected();return new arcs.views.Modal({title:"Add to existing collection",subtitle:""+n+" "+arcs.inflector.pluralize("resource",n)+" will be added        to the selected collection.",inputs:{collection:{type:"select",options:this.getCollections()}},buttons:{add:{"class":"btn btn-success",callback:function(vals){var data,url;url=arcs.url("collections/append/",vals.collection);data={members:_.map(_this.results.selected(),function(r){return r.get("id")})};return $.postJSON(url,data,function(){return _this._notify("added")})}},cancel:function(){}}})};Actions.prototype.getCollections=function(){var result;result=[];$.ajax({url:arcs.baseURL+"collections/titles",async:false,dataType:"json",success:function(data){return result=data}});return _.inverse(result)};Actions.prototype.previewSelected=function(){if(!this.results.anySelected()){return}if(this.preview!=null&&$("#modal").is(":visible")){this.preview.remove();return this.preview=null}return this.preview=new arcs.views.Preview({collection:new arcs.collections.ResultSet(this.results.selected())})};Actions.prototype.downloadSelected=function(){var result,_i,_len,_ref1,_results;_ref1=this.results.selected();_results=[];for(_i=0,_len=_ref1.length;_i<_len;_i++){result=_ref1[_i];_results.push(this.downloadResource(result))}return _results};Actions.prototype.zippedDownloadSelected=function(){var data,_this=this;if(!(this.results.numSelected()>1)){return arcs.notify("To download resources zipped, select at least 2.")}data={resources:_.pluck(this.results.selected(),"id")};$.postJSON(arcs.baseURL+"resources/zipped",data,function(response){var iframe;if(response.url!=null){iframe=_this.make("iframe",{style:"display:none"});$("body").append(iframe);return iframe.src=response.url}});return arcs.notify("Hold tight. We're building your zipfile. "+"Your download will start in a moment","success")};Actions.prototype.bookmarkSelected=function(){var result,_i,_len,_ref1;_ref1=this.results.selected();for(_i=0,_len=_ref1.length;_i<_len;_i++){result=_ref1[_i];this.bookmarkResource(result)}if(this.results.anySelected()){return this._notify("bookmarked")}};Actions.prototype.openSelected=function(){var result,_i,_len,_ref1;_ref1=this.results.selected();for(_i=0,_len=_ref1.length;_i<_len;_i++){result=_ref1[_i];this.openResource(result)}if(this.results.anySelected()){return this._notify("opened")}};Actions.prototype.setAccessForSelected=function(){var n,settings,value,_this=this;n=this.results.numSelected();settings=_.map(this.results.selected(),function(r){return r.get("public")});if(!_.twins(settings)){value=""}else{value=settings[0]?"Public":"Private"}return new arcs.views.Modal({title:"Set Access",subtitle:"<b>Private</b> resources may only be viewed by ARCS users. "+"<b>Public</b> resources may be viewed by the general public.",inputs:{access:{type:"select",options:["","Public","Private"],value:value}},buttons:{save:{"class":"btn btn-success",callback:function(vals){var result,_i,_len,_ref1,_results;if(!vals.access){return}_ref1=_this.results.selected();_results=[];for(_i=0,_len=_ref1.length;_i<_len;_i++){result=_ref1[_i];result.set("public",vals.access==="Public");_results.push(result.save())}return _results}},cancel:function(){}}})};Actions.prototype.indexSelected=function(){var result,_i,_len,_ref1,_results;_ref1=this.results.selected();_results=[];for(_i=0,_len=_ref1.length;_i<_len;_i++){result=_ref1[_i];_results.push(this.indexResource(result))}return _results};Actions.prototype.repreviewSelected=function(){var result,_i,_len,_ref1,_results;_ref1=this.results.selected();_results=[];for(_i=0,_len=_ref1.length;_i<_len;_i++){result=_ref1[_i];_results.push(this.repreviewResource(result))}return _results};Actions.prototype._notify=function(verb,n){var msg;if(verb==null){verb="affected"}if(n==null){n=this.results.numSelected()}msg=""+n+" "+arcs.inflector.pluralize("resource",n)+" "+(""+arcs.inflector.conjugate("was",n)+" "+verb+".");return arcs.notify(msg,"success")};Actions.prototype._modelFromRef=function(ref){var id;if(ref instanceof arcs.models.Resource){return ref}if(ref instanceof jQuery.Event){ref.preventDefault();ref=$(ref.currentTarget).parents(".result")}id=$(ref).data("id");return this.results.get(id)};Actions.prototype._getContextOptions=function(){var admin,public1,restricted;public1={Open:"openSelected",Preview:"previewSelected",Download:"downloadSelected"};restricted={"Edit...":"editSelected","Flag...":"flagSelected"};admin={"Delete...":"deleteSelected"};if(arcs.user.isAdmin()){return _.extend(public1,restricted,admin)}if(arcs.user.isLoggedIn()){return _.extend(public1,restricted)}return public1};return Actions}(arcs.views.BaseActions)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.views.BatchEditModal=function(_super){__extends(BatchEditModal,_super);function BatchEditModal(){return BatchEditModal.__super__.constructor.apply(this,arguments)}BatchEditModal.prototype.initialize=function(){var _this=this;BatchEditModal.__super__.initialize.call(this);this.$("input[type=text][id^=modal]").change(function(e){return _this._checkBox($(e.currentTarget))});this.$("input[type=text][id^=modal]").keyup(function(e){return _this._checkBox($(e.currentTarget))});return this.$("select[id^=modal]").change(function(e){return _this._checkBox($(e.currentTarget))})};BatchEditModal.prototype._checkBox=function($el){var ckbox,id,name,_ref;_ref=$el.attr("id").match(/modal-([\w-]+)-input/),id=_ref[0],name=_ref[1];ckbox=$("input#modal-"+name+"-checkbox");if(!$el.val()){return ckbox.prop("checked",false)}return ckbox.prop("checked",true)};BatchEditModal.prototype.getValues=function(){var name,values;values={};for(name in this.options.inputs){if(this.$("input#modal-"+name+"-checkbox").is(":checked")){values[name]=this.$("#modal-"+name+"-input").val()}}return values};return BatchEditModal}(arcs.views.Modal)}).call(this);(function(){var _base,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};if((_ref=(_base=arcs.views).search)==null){_base.search={}}arcs.views.search.Search=function(_super){__extends(Search,_super);function Search(){return Search.__super__.constructor.apply(this,arguments)}Search.prototype.options={sort:"title",sortDir:"asc",grid:true,url:arcs.baseURL+"search/"};Search.prototype.initialize=function(){this.setupSelect();this.setupSearch();this.actions=new arcs.views.search.Actions({el:this.$el,collection:this.search.results});this.router=new arcs.routers.Search({search:this.search});Backbone.history.start({pushState:true,root:this.options.url});if(!this.router.searched){this.search.run(null,{order:this.options.sort,direction:this.options.sortDir})}this.search.results.on("change remove",this.render,this);arcs.bus.on("selection",this.afterSelection,this);arcs.keys.map(this,{"ctrl+a":this.selectAll,"?":this.showHotkeys,t:this.scrollTop});return this.setupHelp()};Search.prototype.events={"click img":"toggle","click .result":"maybeUnselectAll","click #search-results":"maybeUnselectAll","click #grid-btn":"toggleView","click #list-btn":"toggleView","click #top-btn":"scrollTop","click .sort-btn":"setSort","click .dir-btn":"setSortDir","click .search-page-btn":"setPage"};Search.prototype.setupSelect=function(){var _this=this;return this.$el.find("#search-results").selectable({distance:20,filter:".img-wrapper img",selecting:function(e,ui){$(ui.selecting).parents(".result").addClass("selected");return _this.afterSelection()},selected:function(e,ui){$(ui.selected).parents(".result").addClass("selected");return _this.afterSelection()},unselecting:function(e,ui){$(ui.unselecting).parents(".result").removeClass("selected");return _this.afterSelection()},unselected:function(e,ui){$(ui.unselected).parents(".result").removeClass("selected");return _this.afterSelection()}})};Search.prototype.setupSearch=function(){var _this=this;this.scrollReady=false;return this.search=new arcs.utils.Search({container:$(".search-wrapper"),order:this.options.sort,run:false,loader:true,success:function(){_this.router.navigate(""+encodeURIComponent(_this.search.query)+"/p"+_this.search.page);if(!_this.scrollReady){_this.setupScroll()&&(_this.scrollReady=true)}_this.setupHelp();return _this.render()}})};Search.prototype.setupScroll=function(){var $actions,$results,$window,pos,_ref1,_this=this;_ref1=[this.$("#search-actions"),this.$("#search-results")],$actions=_ref1[0],$results=_ref1[1];$window=$(window);pos=$actions.offset().top-10;$window.scroll(function(){if($window.scrollTop()>pos){return $actions.addClass("toolbar-fixed").width($results.width()+22)}else{return $actions.removeClass("toolbar-fixed").width("auto")}});return $window.resize(function(){if($window.scrollTop()>pos){return $actions.width($results.width()+23)}})};Search.prototype.setupHelp=function(){if(!$(".search-help-btn").length){$(".VS-search-inner").append(arcs.tmpl("search/help-toggle"));$(".search-help-btn").click(this.showHelp);return $(".search-help-close").click(this.closeHelp)}};Search.prototype.toggleView=function(){this.options.grid=!this.options.grid;this.$("#grid-btn").toggleClass("active");this.$("#list-btn").toggleClass("active");return this.render()};Search.prototype.scrollTop=function(){var time;time=$(window).scrollTop()/$(document).height()*1e3;return $("html, body").animate({scrollTop:0},time)};Search.prototype.setSort=function(e){this.options.sort=e.target.id.match(/sort-(\w+)-btn/)[1];this.$(".sort-btn .icon-ok").remove();this.$(e.target).append(this.make("i",{"class":"icon-ok"}));this.$("#sort-btn span#sort-by").html(this.options.sort);return this.search.run(null,{order:this.options.sort,direction:this.options.sortDir})};Search.prototype.setSortDir=function(e){this.options.sortDir=e.target.id.match(/dir-(\w+)-btn/)[1];this.$(".dir-btn .icon-ok").remove();this.$(e.target).append(this.make("i",{"class":"icon-ok"}));return this.search.run(null,{order:this.options.sort,direction:this.options.sortDir})};Search.prototype.setPage=function(e){var $el;e.preventDefault();$el=$(e.currentTarget);this.search.options.page=$el.data("page");return this.search.run()};Search.prototype.unselectAll=function(trigger){if(trigger==null){trigger=true}this.$(".result").removeClass("selected");if(trigger){return arcs.bus.trigger("selection")}};Search.prototype.selectAll=function(trigger){if(trigger==null){trigger=true}this.$(".result").addClass("selected");if(trigger){return arcs.bus.trigger("selection")}};Search.prototype.toggle=function(e){if(!(e.ctrlKey||e.shiftKey||e.metaKey)){this.unselectAll(false)}$(e.currentTarget).parents(".result").toggleClass("selected");return arcs.bus.trigger("selection")};Search.prototype.maybeUnselectAll=function(e){if(!(e instanceof jQuery.Event)){return this.unselectAll()}if(e.metaKey||e.ctrlKey||e.shiftKey){return false}if($(e.target).attr("src")){return false}return this.unselectAll()};Search.prototype.showHotkeys=function(){if($(".hotkeys-modal").length){return $(".hotkeys-modal").remove()}return new arcs.views.Hotkeys({template:"search/hotkeys"})};Search.prototype.showHelp=function(){return $(".search-help").show()};Search.prototype.closeHelp=function(){return $(".search-help").hide()};Search.prototype.afterSelection=function(){var _this=this;return _.defer(function(){var selected;selected=$(".result.selected").map(function(){return $(this).data("id")}).get();_this.search.results.unselectAll();if(selected.length){_this.search.results.select(selected)}if(_this.search.results.anySelected()){$(".btn.needs-resource").removeClass("disabled");return $("#search input").blur()}else{return $(".btn.needs-resource").addClass("disabled")}})};Search.prototype.append=function(){var results;if(!(this.search.results.length>this.search.options.n)){return}results=new arcs.collections.ResultSet(this.search.getLast());return this._render({results:results.toJSON()},true)};Search.prototype.render=function(){var data;this._render({results:this.search.results.toJSON()});data=this.search.results.query;data.page=this.search.page;data.query=encodeURIComponent(this.search.query);return $("#search-pagination").html(arcs.tmpl("search/paginate",{results:data}))};Search.prototype._render=function(results,append){var $results,template;if(append==null){append=false}$results=$("#search-results");template=this.options.grid?"search/grid":"search/list";$results[append?"append":"html"](arcs.tmpl(template,results));if(!this.search.results.length){return $results.html(this.make("div",{id:"no-results"},"No Results"))}};return Search}(Backbone.View)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.views.ContextMenu=function(_super){__extends(ContextMenu,_super);function ContextMenu(){return ContextMenu.__super__.constructor.apply(this,arguments)}ContextMenu.prototype.events={"click *":"hide"};ContextMenu.prototype.options={options:{"Example option":function(){},"Another option":function(){}},context:window,onShow:function(){}};ContextMenu.prototype.initialize=function(){$(".context-menu").remove();$("body").append(arcs.tmpl("ui/context_menu",{options:this.options.options}));this.menu=$(".context-menu");return this.addEvents()};ContextMenu.prototype.show=function(e){this.hide();this.menu.css({position:"absolute",top:e.pageY+"px",left:e.pageX+"px"});this.menu.show();this.options.onShow(e);e.preventDefault();return false};ContextMenu.prototype.addEvents=function(){var boundCb,cb,id,opt,_ref;this.events["contextmenu "+this.options.filter]="show";_ref=this.options.options;for(opt in _ref){cb=_ref[opt];if(this.options.context[cb]==null){continue}boundCb=_.bind(this.options.context[cb],this.options.context);id=arcs.inflector.identifierize(opt);this.events["click #context-menu-option-"+id]=boundCb}return this.delegateEvents()};ContextMenu.prototype.hide=function(e){return this.menu.hide()};return ContextMenu}(Backbone.View)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.views.Hotkeys=function(_super){__extends(Hotkeys,_super);function Hotkeys(){return Hotkeys.__super__.constructor.apply(this,arguments)}Hotkeys.prototype.initialize=function(){var ctrl;ctrl=navigator.appVersion.indexOf("Mac")!==-1?"â":"ctrl";if(!$(".hotkeys-modal").length){$("body").append(arcs.tmpl(this.options.template,{ctrl:ctrl}))}this.el=this.$el=$(".hotkeys-modal");$(".hotkeys-modal").modal({backdrop:false});return this.delegateEvents()};Hotkeys.prototype.events={"click .hotkeys-close":"close"};Hotkeys.prototype.close=function(){return this.el.remove()};return Hotkeys}(Backbone.View)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.views.Preview=function(_super){__extends(Preview,_super);function Preview(){return Preview.__super__.constructor.apply(this,arguments)}Preview.prototype.options={index:0,template:"search/preview"};Preview.prototype.initialize=function(){if(!$("#modal").length){$("body").append(arcs.tmpl("ui/modal_wrapper"))}this.el=this.$el=$("#modal");this.$el.modal();arcs.keys.map(this,{left:this.prev,right:this.next});return this.set(this.options.index,true)};Preview.prototype.events={"click #prev-btn":"prev","click #next-btn":"next"};Preview.prototype.prev=function(){return this.set(this.index-1)};Preview.prototype.next=function(){return this.set(this.index+1)};Preview.prototype.set=function(index,force){if(force==null){force=false}if(!(0<=index&&index<this.collection.length||force)){return}this.model=this.collection.at(index);this.index=index;this._preloadNext();return this.render()};Preview.prototype._preloadNext=function(){if(this.index+1<this.collection.length){return arcs.preload(this.collection.at(this.index+1).get("url"))}};Preview.prototype.remove=function(){this.$el.modal("hide");Preview.__super__.remove.call(this);return this.undelegateEvents()};Preview.prototype.render=function(){var pageInfo;pageInfo={page:this.index+1,count:this.collection.length};this.$el.html(arcs.tmpl(this.options.template,_.extend(this.model.toJSON(),pageInfo)));return this};return Preview}(Backbone.View)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.views.ViewerActions=function(_super){__extends(ViewerActions,_super);function ViewerActions(){return ViewerActions.__super__.constructor.apply(this,arguments)}ViewerActions.prototype.initialize=function(){var _this=this;this.viewer=this.options.viewer;arcs.bus.on("indexChange",function(){_this.updateNav(arguments[0]);return _this.checkNav()});this.onNavKeyup=_.debounce(this.setNav,1e3);arcs.keys.map(this,{"ctrl+e":arcs.user.isLoggedIn()?this.edit:function(){},"-":this.zoomOut,"+":this.zoomIn,0:function(){return this.zoomTo(1)},p:this.onNavClick});if(screenfull){return screenfull.onchange=_.bind(this.onFullScreenChange,this)}};ViewerActions.prototype.events={"click .page-nav input":"onNavClick","keyup .page-nav input":"onNavKeyup","keydown .page-nav input":"onNavKeydown","keydown .collection-search":"search","click #thumbs-btn":"openInSearch","click #mini-next-btn":"next","click #mini-prev-btn":"prev","click #edit-btn":"edit","click #flag-btn":"flag","click #full-screen-btn":"fullScreen","click #delete-btn":"delete","click #delete-col-btn":"deleteCollection","click #split-btn":"split","click #rethumb-btn":"rethumb","click #download-btn":"download","click #annotate-btn":"annotate","click #zoom-in-btn":"zoomIn","click #zoom-out-btn":"zoomOut"};ViewerActions.prototype.onNavClick=function(){return this.$(".page-nav input").select()};ViewerActions.prototype.onNavKeyup=function(e){if(e.which!==13){return this.setNav()}};ViewerActions.prototype.onNavKeydown=function(e){if(e.which===13){return this.setNav()}};ViewerActions.prototype.setNav=function(){if(!this.viewer.set(this.$(".page-nav input").val()-1,{trigger:true})){if(this.$(".page-nav input").val()!==""){return this.$(".page-nav input").val(this.viewer.index+1)}}};ViewerActions.prototype.updateNav=function(index){return this.$(".page-nav input").val(index+1)};ViewerActions.prototype.checkNav=function(){if(this.viewer.collection.length===this.viewer.index+1){this.$("#mini-next-btn").addClass("disabled")}else{this.$("#mini-next-btn").removeClass("disabled")}if(this.viewer.index===0){return this.$("#mini-prev-btn").addClass("disabled")}else{return this.$("#mini-prev-btn").removeClass("disabled")}};ViewerActions.prototype.search=function(e){var facets,query;if(e.which!==13){return}query=this.$(".collection-search").val();facets="collection:'"+arcs.collectionModel.get("title")+"' text:'"+query+"'";return location.href=arcs.baseURL+"search/"+encodeURIComponent(facets)};ViewerActions.prototype.openInSearch=function(){return location.href=arcs.baseURL+"search/"+encodeURIComponent("collection:'"+arcs.collectionModel.get("title")+"'")};ViewerActions.prototype.next=function(){return this.viewer.next()};ViewerActions.prototype.prev=function(){return this.viewer.prev()};ViewerActions.prototype.flag=function(){var _this=this;return new arcs.views.Modal({title:"Flag",inputs:{reason:{type:"select",options:{"Incorrect attributes":"incorrect",Spam:"spam",Duplicate:"duplicate",Other:"other"}},explain:{type:"textarea"}},buttons:{save:{"class":"btn btn-success",callback:function(vals){return _this.flagResource(_this.viewer.model,vals.reason,vals.explain)}},cancel:function(){}}})};ViewerActions.prototype.edit=function(){var field,fields,help,inputs,metadata,_ref,_this=this;inputs={title:{value:this.viewer.model.get("title")},type:{type:"select",options:_.keys(arcs.config.types),value:this.viewer.model.get("type")}};metadata=this.viewer.model.get("metadata");fields=arcs.config.metadata;for(field in fields){help=fields[field];inputs[field]={value:(_ref=metadata.get(field))!=null?_ref:"",help:help}}return new arcs.views.Modal({title:"Edit Info",subtitle:"",template:"ui/modal_columned",inputs:inputs,buttons:{save:{"class":"btn btn-success",callback:function(values){return _this.editResource(_this.viewer.model,values)}},cancel:function(){}}})};ViewerActions.prototype["delete"]=function(){var _this=this;return arcs.confirm("Are you sure you want to delete this resource?","<b>"+this.viewer.model.get("title")+"</b> will be permanently deleted.",function(){return _this.viewer.model.destroy()})};ViewerActions.prototype.deleteCollection=function(){var _this=this;return arcs.confirm("Are you sure you want to delete this collection?","<p>Collection <b>"+this.viewer.collectionModel.get("title")+"</b> will be "+"deleted. <p><b>N.B.</b> Resources within the collection will not be "+"deleted. They may still be accessed from other collections to which they "+"belong.",function(){arcs.loader.show();return $.ajax({url:arcs.url("collections","delete",_this.viewer.collectionModel.id),type:"DELETE",success:function(){return location.href=arcs.baseURL}})})};ViewerActions.prototype.rethumb=function(){return this.rethumbResource(this.viewer.model)};ViewerActions.prototype.split=function(){return this.splitResource(this.viewer.model)};ViewerActions.prototype.download=function(){return this.downloadResource(this.viewer.model)};ViewerActions.prototype.annotate=function(){return arcs.bus.trigger("annotate")};ViewerActions.prototype.fullScreen=function(){if(screenfull){return screenfull.toggle()}else{return arcs.notify("Your browser does not support the full-screen API."+"You'll need to open fullscreen manually, or upgrade your browser.")}};ViewerActions.prototype.onFullScreenChange=function(){if(screenfull.isFullscreen){this.$("#full-screen-btn i").removeClass("icon-resize-full").addClass("icon-resize-small")}else{this.$("#full-screen-btn i").addClass("icon-resize-full").removeClass("icon-resize-small")}return setTimeout(function(){return arcs.bus.trigger("resourceResize")},1e3)};ViewerActions.prototype.zoomTo=function(level){$("#resource img").data("zoom",level);this.viewer.resize();this._checkZoom();return arcs.bus.trigger("resourceReloaded")};ViewerActions.prototype.zoomIn=function(){var current;current=$("#resource img").data("zoom");if(current<2){$("#resource img").data("zoom",current+.25)}this.viewer.resize();this._checkZoom();return arcs.bus.trigger("resourceReloaded")};ViewerActions.prototype.zoomOut=function(){var current;current=$("#resource img").data("zoom");if(current>1){$("#resource img").data("zoom",current-.25)}this.viewer.resize();this._checkZoom();return arcs.bus.trigger("resourceReloaded")};ViewerActions.prototype._checkZoom=function(){var zoom;zoom=$("#resource img").data("zoom");if(zoom===1){this.$("#zoom-out-btn").addClass("disabled")}if(zoom===2){this.$("#zoom-in-btn").addClass("disabled")}if(zoom>1){this.$("#zoom-out-btn").removeClass("disabled")}if(zoom<2){return this.$("#zoom-in-btn").removeClass("disabled")}};return ViewerActions}(arcs.views.BaseActions)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.views.Annotation=function(_super){__extends(Annotation,_super);function Annotation(){return Annotation.__super__.constructor.apply(this,arguments)}Annotation.prototype.initialize=function(){var _this=this;this.collection=new arcs.collections.AnnotationList;this.collection.on("add sync reset remove",this.render,this);arcs.bus.on("resourceLoaded",this.onLoad,this);arcs.bus.on("resourceReloaded",this.render,this);arcs.bus.on("resourceResize",this.render,this);arcs.bus.on("indexChange",this.clear,this);arcs.bus.on("annotate",this.toggleState,this);this.visible=true;this.active=false;$("#annotation-vis-btn").on("click",function(){return _this.toggleVisibility()});return arcs.keys.map(this,{a:this.toggleVisibility})};Annotation.prototype.events={"click #annotate-new-btn":"newAnnotation","click #annotate-done-btn":"exit","mouseenter .annotation":"onSummaryMouseenter","mouseleave .annotation":"onSummaryMouseleave","mouseenter .hotspot":"onBoxMouseenter","hover .annotation a":"onSummaryMouseenter","click .remove-btn":"removeAnnotation"};Annotation.prototype.onLoad=function(){this.img=$("#resource img");if(this.active){this.setupSelection()}return this.collection.fetch()};Annotation.prototype.toggleState=function(){if(this.active){return this.exit()}else{return this.enter()}};Annotation.prototype.enter=function(){this.$(".annotate-controls").show();$("#annotate-btn").addClass("disabled");$(".hotspot i").show();$("#wrapping").css("cursor","default");this.setupSelection();return this.active=true};Annotation.prototype.exit=function(){this.$(".annotate-controls").hide();$("#annotate-btn").removeClass("disabled");$(".hotspot i").hide();this.removeIas();return this.active=false};Annotation.prototype.onSummaryMouseenter=function(e){var $li,id;if(e.target.tagName==="A"){$li=$(e.target).parent()}else{$li=$(e.target)}id=$li.data("id");$(".hotspot").removeClass("active");return $(".hotspot[data-id='"+id+"']").addClass("active")};Annotation.prototype.onSummaryMouseleave=function(){return $(".hotspot").removeClass("active")};Annotation.prototype.onBoxMouseenter=function(e){var $el,anno;$el=$(e.target);anno=this.collection.get($el.data("id"));$el.popover({title:arcs.tmpl("viewer/popover_title",{type:anno.getType()}),content:arcs.tmpl("viewer/popover",anno.toJSON()),placement:this._placePopover($el)});return $el.popover("show")};Annotation.prototype._placePopover=function($el){var best,choice,k,maxHeight,maxWidth,offsets,_ref,_ref1;_ref=[$(window).width(),$(window).height()],maxWidth=_ref[0],maxHeight=_ref[1];offsets={left:$el.offset().left,top:$el.offset().top,right:maxWidth-($el.offset().left+$el.width()),bottom:maxHeight-($el.offset().top+$el.height())};_ref1=["right",offsets.right],choice=_ref1[0],best=_ref1[1];for(k in offsets){if(offsets[k]>best){best=offsets[choice=k]}}if(offsets.bottom<0){choice="top"}if(offsets.top<0){choice="bottom"}return choice};Annotation.prototype.setupSelection=function(coords){var _this=this;if(coords==null){coords=null}this.removeIas();return this.ias=this.img.imgAreaSelect({instance:true,handles:true,fadeSpeed:250,parent:this.$(".viewer-well"),onSelectEnd:function(img,sel){if(!arcs.user.get("loggedIn")){return arcs.needsLogin()}return _this.openAnnotator()}})};Annotation.prototype.removeIas=function(){this.img.removeData("imgAreaSelect");if(this.ias!=null){this.ias.remove();return this.ias=null}};Annotation.prototype.toggleVisibility=function(){var $btn,msg,_this=this;this.visible=!this.visible;msg="Annotations are "+(this.visible?"visible":"hidden");$btn=$("#annotation-vis-btn");$btn.toggleClass("opaque").attr("data-original-title",msg).tooltip("show");_.delay(function(){return $btn.tooltip("hide")},1e3);if(this.visible){return this.collection.fetch()}return $("#hotspots-wrapper").html("")};Annotation.prototype.removeAnnotation=function(e){var $hotspot,anno,_this=this;e.stopPropagation();$hotspot=$(e.target).parent();$hotspot.popover("hide");anno=this.collection.get($hotspot.data("id"));if(!anno){return}arcs.confirm("Are you sure?","This <b>"+anno.getType().toLowerCase()+"</b> will be deleted.",function(){return anno.destroy()});return false};Annotation.prototype.newAnnotation=function(){var height,width,xMid,yMid,_ref;_ref=[this.img.width(),this.img.height()],width=_ref[0],height=_ref[1];xMid=Math.floor(width/2);yMid=Math.floor(height/2);this.ias.setOptions({show:true});this.ias.setSelection(xMid-50,yMid-50,xMid+50,yMid+50);return this.ias.update()};Annotation.prototype.openAnnotator=function(){var _ref,_this=this;if((_ref=this.annotator)!=null?_ref.isOpen():void 0){return}this.annotator=new arcs.views.Modal({title:"New Annotation",subtitle:arcs.tmpl("viewer/annotator"),backdrop:false,"class":"annotator",buttons:{save:{"class":"btn btn-success",callback:function(){var data;data={relation:_this.annotator.$(".result.selected img").data("id"),transcript:_this.annotator.$("textarea#transcript").val(),url:_this.annotator.$("input#url").val()};if(!_.any(data)){return}_this.create(data);_this.ias.cancelSelection();return delete _this.annotator}},cancel:function(){_this.ias.cancelSelection();return delete _this.annotator}}});this.annotator.$el.on("click",".result img",function(){$(".result").removeClass("selected");return $(this).parents(".result").addClass("selected")});this.annotator.$("input#url").keyup(function(){var val;val=$(this).val();if(val.substring(0,7)==="http://"){return $(this).val(val.substring(7))}});return this.search=new arcs.utils.Search({container:$(".mini-search"),success:function(){return $(".mini-search-results").html(arcs.tmpl("search/grid",{results:_this.search.results.toJSON()}))}})};Annotation.prototype.create=function(data){var anno;anno=new arcs.models.Annotation({resource_id:arcs.resource.id});if(data.relation){anno.set("relation",data.relation)}else if(data.transcript){anno.set("transcript",data.transcript)}else{anno.set("url","http://"+data.url)}if(this.ias!=null){anno.setScaled(this.ias.getSelection(),this.img.height(),this.img.width())}anno.save();anno.set("id",_.uniqueId());return this.collection.add(anno)};Annotation.prototype.clear=function(){$("#annotations-wrapper").html("");$("#hotspots-wrapper").html("");return $(".popover").remove()};Annotation.prototype.render=function(){var annos,_this=this;this.clear();annos={annotations:this.collection.map(function(m){var rid,_ref,_ref1;if(rid=m.get("relation")){m.set("relation",(((_ref=_this.search)!=null?_ref.results.get(rid):void 0)||((_ref1=_this.collection.relations)!=null?_ref1.get(rid):void 0)).toJSON())}return _.extend(m.toJSON(),m.scaleTo(_this.img.height(),_this.img.width()))}),offset:$("#resource img").offset().left-$("#resource").offset().left};$("#annotations-wrapper").html(arcs.tmpl("viewer/annotations",annos));if(this.visible){$("#hotspots-wrapper").html(arcs.tmpl("viewer/hotspots",annos))}if(this.active){$(".hotspot i").show()}return this};return Annotation}(Backbone.View)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.views.Carousel=function(_super){__extends(Carousel,_super);function Carousel(){return Carousel.__super__.constructor.apply(this,arguments)}Carousel.prototype.options={index:0,nthumbs:30};Carousel.prototype.initialize=function(){var _this=this;arcs.bus.on("indexChange",this.slideTo,this);arcs.bus.on("indexChange",this.setSelected,this);this.render();this.$el.elastislide({imageW:100,onClick:function($item){return arcs.bus.trigger("indexChange",$item.index(),{noSlide:true})},onSlide:function(first,last){if(!_.isNaN(last)){if(first>1){setTimeout(function(){return _this.$el.find(".es-nav-prev").show()},50)}if(last>_this.options.nthumbs-10){return _this._addThumbs()}}}});return this.slideTo(this.options.index)};Carousel.prototype.events={"click li":"onClick"};Carousel.prototype.onClick=function(e){return arcs.bus.trigger("indexChange",$(e.target).parent().index(),{noSlide:true})};Carousel.prototype.slideTo=function(index,options){if(options==null){options={}}if(this.$("li").length<index){this._addThumbs(index+1-this.$("li").length)}if(!options.noSlide){return this.$el.elastislide("slideToIndex",index)}};Carousel.prototype.setSelected=function(index){var img;this.$(".thumb.selected").removeClass("selected");img=this.$(".thumb").get(index);return $(img).addClass("selected")};Carousel.prototype._addThumbs=function(n){var $thumbs,additions,m;if(n==null){n=30}additions=this.collection.models.slice(this.options.nthumbs,this.options.nthumbs+n);$thumbs=$(this._tmpl({resources:function(){var _i,_len,_results;_results=[];for(_i=0,_len=additions.length;_i<_len;_i++){m=additions[_i];_results.push(m.toJSON())}return _results}(),offset:this.options.nthumbs}));this.$el.elastislide("add",$thumbs.filter("li"));this.options.nthumbs+=n;return this.delegateEvents()};Carousel.prototype.render=function(){return this.$("ul").html(this._tmpl({resources:_.first(this.collection.toJSON(),this.options.nthumbs),offset:0}))};Carousel.prototype._tmpl=function(data){return arcs.tmpl("viewer/carousel",data)};return Carousel}(Backbone.View)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.views.DiscussionTab=function(_super){__extends(DiscussionTab,_super);function DiscussionTab(){return DiscussionTab.__super__.constructor.apply(this,arguments)}DiscussionTab.prototype.events={"click #comment-btn":"saveComment"};DiscussionTab.prototype.initialize=function(){var _this=this;this.collection=new arcs.collections.Discussion;this.collection.on("add remove reset",this.render,this);this.$tab=$("#discussion-btn");this.$tab.on("click",function(){return _this.update()});arcs.bus.on("indexChange",function(){if(_this.isActive()){return _this.update()}});if(this.isActive()){return this.update()}};DiscussionTab.prototype.activate=function(){$("#discussion-btn a").tab("show");return this.collection.fetch()};DiscussionTab.prototype.update=function(){var _this=this;this.$el.parent().css("opacity","0.2");return this.collection.fetch({success:function(){return _this.$el.parent().css("opacity","1.0")},error:function(){return arcs.notify("An error occurred while loading comments","error")}})};DiscussionTab.prototype.isActive=function(){return $("#discussion-btn").hasClass("active")};DiscussionTab.prototype.saveComment=function(){var $textarea,comment;$textarea=this.$el.find("textarea#content");if(!$textarea.val()){return arcs.notify("Enter a comment.")}comment=new arcs.models.Comment({resource_id:arcs.resource.id,content:$textarea.val()});$textarea.val("");comment.save();comment.set({created:new Date,username:arcs.user.get("username"),name:arcs.user.get("name")});return this.collection.add(comment)};DiscussionTab.prototype.render=function(){$("#comment-wrapper").html(arcs.tmpl("viewer/discussion",{comments:this.collection.toJSON()}));return this};return DiscussionTab}(Backbone.View)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.views.Keyword=function(_super){__extends(Keyword,_super);function Keyword(){return Keyword.__super__.constructor.apply(this,arguments)}Keyword.prototype.events={"keydown #keyword-btn":"saveKeyword","click .keyword-remove-btn":"deleteKeyword"};Keyword.prototype.initialize=function(){var _this=this;this.collection=new arcs.collections.KeywordList;arcs.bus.on("indexChange",function(){return _this.collection.fetch()});this.collection.on("add remove reset sync",this.render,this);arcs.utils.autocomplete({sel:"#keyword-btn",source:arcs.complete("keywords/complete")});return this.collection.fetch()};Keyword.prototype.saveKeyword=function(e){var $input,keyword;if(e.keyCode!==13){return}e.preventDefault();$input=this.$el.find("input#keyword-btn");keyword=new arcs.models.Keyword({resource_id:arcs.resource.id,keyword:$input.val()});$input.val("");keyword.save();this.collection.add(keyword);return false};Keyword.prototype.deleteKeyword=function(e){var $keyword,keyword,_this=this;$keyword=$(e.target).parent().find(".keyword-link");keyword=this.collection.get($keyword.data("id"));if(!keyword){return}return arcs.confirm("Are you sure?","This keyword will be deleted.",function(){return keyword.destroy()})};Keyword.prototype.render=function(){this.$("#keywords-wrapper").html(arcs.tmpl("viewer/keywords",{keywords:this.collection.toJSON()}));return this};return Keyword}(Backbone.View)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.views.RelationModal=function(_super){__extends(RelationModal,_super);function RelationModal(){return RelationModal.__super__.constructor.apply(this,arguments)}RelationModal.prototype.initialize=function(){return RelationModal.__super__.initialize.call(this)};RelationModal.prototype.miniSearch=function(){};return RelationModal}(arcs.views.Modal)}).call(this);(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};arcs.views.Viewer=function(_super){__extends(Viewer,_super);function Viewer(){return Viewer.__super__.constructor.apply(this,arguments)}Viewer.prototype.initialize=function(){var _ref,_ref1,_this=this;this.collectionModel=this.options.collectionModel;this.orderCollection();arcs.bus.on("indexChange",this.set,this);arcs.bus.on("all",function(name){return arcs.log(name)});this.collection.on("add change remove",this.render,this);this.model.on("add change remove",this.render,this);this.throttledResize=_.throttle(this.resize,500);$(window).resize(function(){return arcs.bus.trigger("resourceResize")});arcs.bus.on("resourceResize",this.throttledResize,this);arcs.keys.map(this,{left:this.prev,right:this.next,"?":this.showHotkeys});this.actions=new arcs.views.ViewerActions({el:$("#viewer-controls"),collection:this.collection,viewer:this});this.discussion=new arcs.views.DiscussionTab({el:$("#discussion")});this.keywords=new arcs.views.Keyword({el:$("#notations")});this.annotations=new arcs.views.Annotation({el:$("#viewer")});this.carousel=new arcs.views.Carousel({el:$("#carousel-wrapper"),collection:this.collection,index:(_ref=this.index)!=null?_ref:0});this.router=new arcs.routers.Viewer;Backbone.history.start({pushState:true,root:arcs.baseURL+(this.collection.length?"collection/":"resource/")});if(this.model.get("first_req")){this.splitPrompt()}if((_ref1=this.index)==null){this.index=0}return this.resize()};Viewer.prototype.events={"dblclick #resource img":"openFull","click #next-btn":"next","click #prev-btn":"prev"};Viewer.prototype.orderCollection=function(){var _ref,_this=this;if(((_ref=this.collectionModel)!=null?_ref.id:void 0)==null){return}this.collection.each(function(resource){return resource.set("page",resource.get("memberships")[_this.collectionModel.id])});return this.collection.sort()};Viewer.prototype.set=function(identifier,options){var index,model,route,_ref,_ref1,_ref2;if(options==null){options={}}if(options.noSet){return false}if(_.isNumeric(identifier)){index=parseInt(identifier);model=this.collection.length?this.collection.at(index):this.model}else{model=this.collection.get(identifier);index=this.collection.models.indexOf(model);options.noNavigate=false;options.replace=true}if(!(model&&index>=0)){return false}_ref=[model,model,index],this.model=_ref[0],arcs.resource=_ref[1],this.index=_ref[2];if(options.trigger){arcs.bus.trigger("indexChange",index,{noSet:true})}if(!options.noRender){this.render()}route=""+((_ref1=(_ref2=arcs.collectionModel)!=null?_ref2.id:void 0)!=null?_ref1:this.model.id)+"/"+(this.index+1);if(!options.noNavigate){this.router.navigate(route,{replace:options.replace})}if(!options.noPreload){this._preloadNeighbors()}return true};Viewer.prototype._preloadNeighbors=function(){if(this.collection.at(this.index+1)!=null){arcs.preload(this.collection.at(this.index+1).get("url"))}if(this.collection.at(this.index-1)!=null){return arcs.preload(this.collection.at(this.index-1).get("url"))}};Viewer.prototype.next=function(){return this.set(this.index+1,{trigger:true})};Viewer.prototype.prev=function(){return this.set(this.index-1,{trigger:true})};Viewer.prototype.openFull=function(){return window.open(this.model.get("url"),"_blank","menubar=no")};Viewer.prototype.checkNav=function(){if(this.collection.length===this.index+1){this.$("#next-btn").addClass("disabled")}else{this.$("#next-btn").removeClass("disabled")}if(this.index===0){return this.$("#prev-btn").addClass("disabled")}else{return this.$("#prev-btn").removeClass("disabled")}};Viewer.prototype.splitPrompt=function(){var _this=this;if(this.model.get("mime_type")!=="application/pdf"){return}return new arcs.views.Modal({title:"Split into a PDF?",subtitle:"We noticed you've uploaded a PDF. If you'd like, "+"we can split the PDF into a collection, where it can be "+"annotated and commented on--page by page.",buttons:{yes:{"class":"btn btn-success",callback:function(){return $.post(arcs.baseURL+"resources/split_pdf/"+_this.model.id)}},no:function(){}}})};Viewer.prototype.showHotkeys=function(){if($(".hotkeys-modal").length){return $(".hotkeys-modal").remove()}return new arcs.views.Hotkeys({template:"viewer/hotkeys"})};Viewer.prototype.resize=function(){var $resource,$well,$wrapping,COLLECTION,STANDALONE,TAB_MARGIN,height,margin,zoomLevel;STANDALONE=128;COLLECTION=204;TAB_MARGIN=75;$resource=this.$("#resource img");$wrapping=this.$("#wrapping");$well=this.$(".viewer-well");margin=$("body").hasClass("standalone")?STANDALONE:COLLECTION;height=$(window).height()-margin;zoomLevel=$resource.data("zoom");$well.height(height);$resource.height(height*zoomLevel);$wrapping.height(height).width($well.width()-36);this.$(".tab-content").height(height-TAB_MARGIN);if($wrapping.data().kineticSettings!=null){$wrapping.kinetic("detach")}if(zoomLevel>1){return $wrapping.kinetic()}};Viewer.prototype.render=function(){var mimeInfo,template;mimeInfo=arcs.utils.mime.getInfo(this.model.get("mime_type"));switch(mimeInfo.type){case"image":template="viewer/image";break;case"document":template="viewer/document";break;case"video":template="viewer/video";break;default:template="viewer/unknown"}this.$("#resource").html(arcs.tmpl(template,this.model.toJSON()));this.$("#resource img").load(function(){return arcs.bus.trigger("resourceLoaded")});this.$("#resource-details").html(arcs.tmpl("viewer/table",this.model.toJSON()));if(this.collectionModel!=null){this.$("#collection-details").html(arcs.tmpl("viewer/collection_table",this.collectionModel.toJSON()))}this.checkNav();this.resize();return this};return Viewer}(Backbone.View)}).call(this);(function(){$(function(){var warning;warning=function(){return arcs.prompt("Your browser is old and unsupported.","<p>ARCS was designed for modern web browsers. Please upgrade to the "+"newest version of <a href='http://google.com/chrome'>Chrome</a> or "+"<a href='http://mozilla.org/en-US/firefox/new'>Firefox</a>.</p>If "+"you'd like to give it a try anyway, click 'Ok' below.")};if(!(jQuery.support.ajax&&jQuery.support.cors&&history.pushState)){return warning()}})}).call(this);window.JST = window.JST || {};
JST["admin/flags"] = "<table class=\"table table-striped table-bordered\">  <tr>    <th>Resource</th>    <th>Reason</th>    <th>Explanation</th>    <th>Flagger</th>    <th>Flagged</th>    <th>Status</th>  </tr><% _.each(flags, function(f, i) { %>  <tr>    <td>      <% if (f.resource.title) { %>      <a href=\"<%= arcs.url('resource', f.resource.id) %>\">        <%= f.resource.title %>      </a>      <% } else { %>      (deleted)      <% } %>    </td>    <td><%= f.reason %></td>    <td><%= f.explanation %></td>    <td>      <a href=\"<%= arcs.url('user', f.user.username) %>\">        <%= f.user.name %>      </a>    </td>    <td><%= relativeDate(new Date(f.created)) %></td>    <td><span class=\"label label-important\">Unresolved</span></td>  </tr><% }) %></table>";
JST["admin/jobs"] = "<table class=\"table table-striped table-bordered\">  <tr>    <th>Job</th>    <th>Status</th>    <th>Lock</th>    <th>Created</th>    <th>Data</th>    <th>Error</th>    <th>Actions</th>  </tr><% _.each(jobs, function(j, i) { %>  <tr>    <td><%= j.name %></td>    <td>      <% if (j.status == 0) { %>      <span class=\"label label-success\">done</span>      <% } if (j.status == 1) { %>      <span class=\"label label-info\">pending</span>      <% } if (j.status == 2) { %>      <span class=\"label label-warning has-error\" rel=\"popover\" data-original-title=\"Error\"        data-content=\"<%= j.error %>\">failing</span>      <% } if (j.status == 3) { %>      <span class=\"label label-important has-error\" rel=\"popover\" data-original-title=\"Error\"        data-content=\"<%= j.error %>\">failed</span>      <% } if (j.status == 4) { %>      <span class=\"label label-important has-error\" rel=\"popover\" data-original-title=\"Error\"        data-content=\"<%= j.error %>\">interrupted</span>      <% } %>    </td>    <td>    <% if (j.locked_by) { %>      <%= relativeDate(new Date(j.locked_at)) %> by <span class=\"label\"><%= j.locked_by %></span>     <% } %>    </td>    <td><%= relativeDate(new Date(j.created)) %></td>    <td class=\"data\"><%= arcs.inflector.truncate(j.data, 50) %></td>    <td class=\"data\"><%= arcs.inflector.truncate(j.error, 50) %></td>    <td>      <button id=\"show-btn\" class=\"btn btn-mini\"        data-id=\"<%= j.id %>\">Show</button>      <button id=\"retry-btn\" class=\"btn btn-mini\"        data-id=\"<%= j.id %>\">Retry</button>      <button id=\"release-btn\" class=\"btn btn-mini\"        data-id=\"<%= j.id %>\">Release</button>      <button id=\"delete-btn\" class=\"btn btn-danger btn-mini\"        data-id=\"<%= j.id %>\">Delete</button>    </td>  </tr><% }) %></table>";
JST["admin/show_job"] = "<dl>  <dt>Job</dt>  <dd><%= name %></dd>  <dt>Status</dt>  <dd><%= status %></dd>  <dt>Created</dt>  <dd><%= created %></dd>  <dt>Lock</dt>  <dd><%= locked_at %></dd>  <dt>Data</dt>  <dd><pre><%= data %></pre></dd>  <dt>Error</dt>  <dd><pre><%= error %></pre></dd></dl>";
JST["admin/users"] = "<table class=\"table table-striped table-bordered\">  <tr>    <th>Name</th>    <th>Username</th>    <th>Email</th>    <th>Role</th>    <th>Actions</th>  </tr><% _.each(users, function(u, i) { %>  <tr>    <td><%= u.name %></td>    <td><%= u.username %></td>    <td><%= u.email %></td>    <td>      <% if (u.role == 0) print('Admin') %>      <% if (u.role == 1) print('Sr. Researcher') %>      <% if (u.role == 2) print('Researcher') %>    <td>      <button id=\"delete-btn\" class=\"btn btn-danger btn-mini \"        data-id=\"<%= u.id %>\">Delete</button>      <button id=\"edit-btn\" class=\"btn btn-info btn-mini\"        data-id=\"<%= u.id %>\">Edit</button>    </td>  </tr><% }) %></table>";
JST["collections/list"] = "<% _.each(collections, function(c, i) { %><% if (i == 0) { %>  <details data-id=\"<%= c.id %>\" class=\"open\" open=\"open\"><% } else { %>  <details data-id=\"<%= c.id %>\" class=\"closed\"><% } %>    <summary>      <h3><%= c.title %></h3>      <h4><%= c.description %></h4>      <h5><%= relativeDate(new Date(c.modified)) %></h5>    </summary>    <div class=\"actions\">        <div class=\"btn-group\">          <button class=\"btn no-rounded\" data-toggle=\"dropdown\">            <i class=\"icon-cog\"></i>            <span class=\"caret\"></span>          </button>          <ul class=\"dropdown-menu pull-right\">          <li>            <a class=\"subtle\" href=\"<%= arcs.url('collection', c.id) %>\">Open</a>          </li>          <% if (c.pdf) { %>            <li>              <a class=\"subtle\" href=\"<%= arcs.url('resource', c.pdf) %>\">View Source PDF</a>              <a class=\"subtle\"                 href=\"<%= arcs.url('resources', 'download', c.pdf) %>\">Download PDF</a>            </li>          <% } if (arcs.user.isAdmin()) { %>            <li><a id=\"delete-btn\">Delete</a></li>          <% } %>          </ul>        </div>    </div>    <div class=\"results\"></div>  </details><% }) %>";
JST["home/details"] = "<ul class=\"resource-thumbs\"><% _.each(resources, function(r, i) { %>  <li class=\"resource-thumb\">    <a target=\"_blank\"  href=\"<%= arcs.baseURL + 'resource/' + r.id %>\">      <img src=\"<%= r.thumb %>\" alt=\"resource\" />    </a>    <a target=\"_blank\"  class=\"subtle\" href=\"<%= arcs.baseURL + 'resource/' + r.id %>\"><%= r.title %></a>  </li><% }) %><% if (!resources.length) { %>  <li>    <i class=\"icon-exclamation-sign\"></i> No Results Found  </li><% } else { %>  <li class=\"resource-thumb\">    <% if (typeof searchURL != \"undefined\") { %>      <a target=\"_blank\" href='<%= searchURL %>'><i class=\"icon-share-alt\"></i> Show all</a>    <% } else { %>      <a target=\"_blank\"  href='<%= arcs.baseURL + 'search/type:\"' + resources[0].type + '\"' %>'>        <i class=\"icon-share-alt\"></i> Show all      </a>    <% } %>  </li><% } %></ul>";
JST["search/grid"] = "<% _.each(results, function(r, i) { %><div class=\"result grid\" data-id=\"<%= r.id %>\">  <div class=\"img-wrapper\">    <img src=\"<%= r.thumb %>\" data-id=\"<%= r.id %>\" />  </div>  <% if (r.title) { %>  <div>    <strong>      <%- r.title.length > 30 ? r.title.substring(0, 30) + '...' : r.title %>    </strong>  </div>  <% } %>  <% if (r.metadata) { %>  <div><%= r.metadata.get('identifier') %></div>  <% } %>  <div>    <% if (r.comments.length) { %>      <%= r.comments.length %> <i class=\"icon-comment\"></i>    <% } if (r.annotations.length) { %>      <%= r.annotations.length %> <i class=\"icon-map-marker\"></i>    <% } if (r.flags.length) { %>      <%= r.flags.length %> <i class=\"icon-flag\"></i>    <% } %> &nbsp;  </div></div><% }) %>";
JST["search/help-toggle"] = "<i class=\"search-help-btn icon-info-sign\" rel=\"tooltip\"   data-placement=\"top\" data-original-title=\"Show Search Help\"></i>";
JST["search/hotkeys"] = "<div class=\"modal hotkeys-modal\">  <div class=\"modal-header\">    <a class=\"hotkeys-close pull-right\">close</a>    <h3>Shortcuts</h3>  </div>  <div class=\"modal-body\">    <table>      <thead>        <tr>          <th>Action</th>          <th>Keys(s)</th>        </tr>      </thead>      <tbody>        <tr>          <td>Select all</td>          <td><%= ctrl %> + A</td>        </tr>        <tr>          <td>Select multiple</td>          <td>click + drag</td>        </tr>        <tr>          <td>Add/remove from selection</td>          <td><%= ctrl %> + click</td>        </tr>        <tr>          <td>Quick preview</td>          <td>spacebar</td>        </tr>        <tr>          <td>Navigate previews</td>          <td>            <i class=\"icon-white icon-arrow-left\"></i>            <i class=\"icon-white icon-arrow-right\"></i>          </td>        <tr>          <td>Edit info (for selected)</td>          <td><%= ctrl %> + E</td>        </tr>        <tr>          <td>Back to top</td>          <td>T</td>        </tr>      </tbody>    </table>  </div></div>";
JST["search/list"] = "<table style=\"width:100%\"><% _.each(results, function(r, i) { %>  <tr class=\"result list\" data-id=\"<%= r.id %>\">    <td class=\"img-wrapper\">      <img src=\"<%= r.thumb %>\" data-id=\"<%= r.id %>\" />    </td>    <td>      <div>        <strong><%= r.title %></strong> &nbsp;        <% if (r.metadata.get('identifier')) { %>          <span class=\"monospace\"><%= r.metadata.get('identifier') %></span> &nbsp;        <% } %>        <a class=\"subtle\" href=\"<%= r.url %>\"><%= r.file_name %></a> &nbsp;        (<em><%= arcs.utils.convertBytes(r.file_size) %></em>)      </div>      <% if (r.type) { %>      <div>        <% if (arcs.mime.isImage(r.mime_type)) { %>          <i class=\"icon-picture\"></i>        <% } else if (arcs.mime.isVideo(r.mime_type)) { %>          <i class=\"icon-film\"></i>        <% } else { %>          <i class=\"icon-file\"></i>        <% } %>        <%= r.type %>      </div>      <% } %>      <div>        Uploaded        <%= relativeDate(new Date(r.created)) %>        by        <a class=\"subtle\" href=\"<%= arcs.url('user', r.user.username) %>\"><%= r.user.name %></a>       </div>      <div>        <% _.each(r.keywords, function(k) { %>          <a class=\"keyword-link subtle\"             href=\"<%= arcs.url('search', 'keyword:' + k) %>\"><%= k %></a>        <% }) %>      </div>      <div>        <% if (r.comments.length) { %>          <%= r.comments.length %> <i class=\"icon-comment\"></i>        <% } if (r.annotations.length) { %>          <%= r.annotations.length %> <i class=\"icon-map-marker\"></i>        <% } if (r.flags.length) { %>          <%= r.flags.length %> <i class=\"icon-flag\"></i>        <% } if (!r.public) { %>          <i class=\"icon-lock\"></i>        <% } %>      </div>    </td>  </tr><% }) %></table>";
JST["search/paginate"] = "<% if (results.num_results > 0) { %>  <div class=\"search-pages btn-toolbar\">    <% if (results.page != 1) {%>      <div class=\"btn-group\">        <a class=\"search-page-btn btn\" data-page=\"<%= results.page - 1 %>\"           href=\"<%= arcs.url('search', results.query, 'p' + (results.page - 1)) %>\">          &larr;        </a>      </div>    <% } %>    <div class=\"btn-group\">      <% var pages = _.range(1, _.range(0, results.total, results.limit).length + 1) %>      <% _.each(_.surrounding(pages, results.page - 1, 10), function(p) { %>        <a class=\"search-page-btn btn <%= (p == results.page) ? \"active\" : \"\" %>\"           data-page=\"<%= p %>\" href=\"<%= arcs.url('search', results.query, 'p' + p) %>\"><%= p %></a>      <% }) %>    </div>    <% if (results.num_results == results.limit) { %>      <div class=\"btn-group\">        <a class=\"search-page-btn btn\" data-page=\"<%= results.page + 1 %>\"           href=\"<%= arcs.url('search', results.query, 'p' + (results.page + 1)) %>\">          &rarr;        </a>      </div>    <% } %>  </div>  <div class=\"search-description\">    <%= results.offset + 1 %> &mdash;    <%= results.offset + results.num_results %>    of <%= results.total %> resources  </div><% } %>";
JST["search/preview"] = "<div class=\"preview\">  <img class=\"preview-image\" src=\"<%= preview || url %>\" alt=\"preview\"/>  <div class=\"preview-footer\">    <a id=\"title\" href=\"<%= arcs.baseURL + \"resource/\" + id %>\">      <%= title %>    </a>&nbsp;    <% if (mime_type == 'application/pdf') print('(PDF)'); %>    <% if (count > 1) { %>    <span class=\"pull-right\">      <% if (page > 1) { %>        <span id=\"prev-btn\">&larr;</span>      <% } %>      <%= page %> / <%= count %>      <span id=\"next-btn\"         class=\"<%= page < count ? '' : 'invisible' %>\">&rarr;</span>    </span>    <% } %>  </div></div>";
JST["ui/button"] = "<a class=\"btn icon unselectable\" id=\"<%= id %>\"    <%= this.url !== undefined ? 'href=\"' + url + '\"' : '' %>>    <span class=\"<%= this.class %>\"></span>    <%= text %></a>";
JST["ui/context_menu"] = "<ul class=\"nav nav-list context-menu\" style=\"display:none\">  <% for (o in options) { %>  <li><a class=\"context-menu-option\"     id=\"context-menu-option-<%= arcs.inflector.identifierize(o) %>\">    <%= o %></a></li>  <% } %></ul>";
JST["ui/loader"] = "<div class=\"loading\"></div>";
JST["ui/modal"] = "<div class=\"modal-header\">  <a class=\"close\" data-dismiss=\"modal\">Ã</a>  <h3><%= title %></h3></div><div class=\"modal-body\"><% if (subtitle) { %>  <%= subtitle %>  <br><br><% } %>  <div id=\"validation-error\"></div><% _.each(inputs, function(i, name) { %>  <% if (_.isUndefined(i.label) || i.label !== false) { %>    <label for=\"modal-<%= name %>\">      <%= _.isUndefined(i.label) ? name.charAt(0).toUpperCase() + name.substr(1) : i.label %>       <% if (i.help) { %>        <i class=\"icon-info-sign\" rel=\"tooltip\" title=\"<%= i.help %>\"></i>      <% } %>    </label>  <% } %>  <% if (i.type === 'select') { %>    <select class=\"<%= i.class %>\" id=\"modal-<%= name %>-input\"      <%= i.focused ? 'autofocus' : '' %>      name=\"modal-<%= name %>\">    <% _.each(i.options, function(val, key) { %>      <option <%= i.value == val ? 'selected' : '' %> value=\"<%= val %>\"?>        <%= _.isArray(i.options) ? val : key %>      </option>    <% }) %>    </select>  <% } else if (i.type === 'textarea') { %>    <textarea class=\"<%= i.class %>\" id=\"modal-<%= name %>-input\"      name=\"modal-<%= name %>\" <%= i.focused ? 'autofocus' : '' %>><%= i.value || '' %></textarea>  <% } else { %>    <input type=\"<%= i.type ? i.type : 'text' %>\" class=\"<%= i.class %>\"      id=\"modal-<%= name %>-input\" value=\"<%= i.value %>\"      <%= i.focused ? 'autofocus' : '' %>      name=\"modal-<%= name %>\" placeholder=\"<%= i.placeholder %>\" />  <% } %><% }) %></div><div class=\"modal-footer\"><% _.each(buttons, function(b, name) { %>  <button class=\"<%= b.class ? b.class : 'btn' %>\"     id=\"modal-<%= name %>-button\">    <%= name.substr(0, 1).toUpperCase() + name.substr(1) %>   </button><% }) %></div>";
JST["ui/modal_columned"] = "<div class=\"modal-header\">  <a class=\"close\" data-dismiss=\"modal\">Ã</a>  <h3><%= title %></h3></div><div class=\"modal-body\"><% if (subtitle) { %>  <%= subtitle %>  <br><br><% } %><% var left = true %><% _.each(inputs, function(i, name) { %>  <% if (left) { %>  <div class=\"row\">  <% } %>  <span class=\"span-6\">  <% if (_.isUndefined(i.label) || i.label !== false) { %>    <label for=\"modal-<%= name %>\">      <%= _.isUndefined(i.label) ? name.substr(0, 1).toUpperCase() + name.substr(1) : i.label %>       <% if (i.help) { %>        <i class=\"icon-info-sign\" rel=\"tooltip\" title=\"<%= i.help %>\"></i>      <% } %>    </label>  <% } %>  <% if (i.type === 'select') { %>    <select class=\"<%= i.class %>\" id=\"modal-<%= name %>-input\"      <%= i.focused ? 'autofocus' : '' %>      name=\"modal-<%= name %>\">    <% _.each(i.options, function(val, key) { %>      <option <%= i.value == val ? 'selected' : '' %> value=\"<%= val %>\">        <%= _.isArray(i.options) ? val : key %>      </option>    <% }) %>    </select>  <% } else if (i.type === 'textarea') { %>    <textarea class=\"<%= i.class %>\" id=\"modal-<%= name %>-input\"      name=\"modal-<%= name %>\" <%= i.focused ? 'autofocus' : '' %>></textarea>  <% } else { %>    <input type=\"<%= i.type ? i.type : 'text' %>\" class=\"<%= i.class %>\"      id=\"modal-<%= name %>-input\" value=\"<%= i.value %>\"      <%= i.focused ? 'autofocus' : '' %>      name=\"modal-<%= name %>\" placeholder=\"<%= i.placeholder %>\" />  <% } %>  <% if (!_.isUndefined(i.checkbox)) { %>    <input class=\"checkbox inline\" id=\"modal-<%= name %>-checkbox\"       type=\"checkbox\" <%= (i.checkbox) ? 'checked' : '' %> />  <% } %>  </span>  <% if (!left) { %>  </div>  <% } %>  <% left = !left %><% }) %><% if (!left) { %>  </div><% } %></div><div class=\"modal-footer\"><% _.each(buttons, function(b, name) { %>  <button class=\"<%= b.class ? b.class : 'btn' %>\"     id=\"modal-<%= name %>-button\">    <%= name.substr(0, 1).toUpperCase() + name.substr(1) %>   </button><% }) %></div>";
JST["ui/modal_wrapper"] = "<div id=\"modal\" class=\"modal\" style=\"display:none; max-height:none;\"></div>";
JST["ui/notification"] = "<div id=\"notification\" class=\"alert notification\" style=\"display:none\">    <a class=\"close\" data-dismiss=\"alert\" href=\"#\">Ã</a>    <span id=\"msg\"></span></div>";
JST["ui/progress"] = "<span class=\"progress\">  <div class=\"bar\" style=\"width: <%= progress %>%\"></div></span>";
JST["upload/list"] = "<div class=\"accordion-group upload\" data-id=\"<%= cid %>\">  <div class=\"accordion-heading\">    <div class=\"accordion-toggle\">      <% if (arcs.mime.isImage(type)) { %>        <i class=\"icon-picture\"></i>      <% } else if (arcs.mime.isVideo(type)) { %>        <i class=\"icon-film\"></i>      <% } else { %>        <i class=\"icon-file\"></i>      <% } %>      <%= name %> &nbsp;&nbsp;      <em><%= arcs.utils.convertBytes(size) %></em> &nbsp;&nbsp;      <div class=\"remove\"></div>      <span class=\"progress\">        <div class=\"bar\" style=\"width: <%= progress %>%\"></div>      </span>      <span id=\"progress-done\" class=\"pull-right\" style=\"display:none\">        <i class=\"icon-ok\"></i> Done      </span>    </div>  </div>  <div class=\"accordion-body collapse in\">    <div class=\"accordion-inner\">      <input type=\"text\" id=\"upload-title\" placeholder=\"Title\" />      <input type=\"text\" id=\"upload-identifier\" placeholder=\"Identifier\" />      <select id=\"upload-type\" style=\"display:inline-block\">        <option disabled selected>Choose Type...</option>      <% _.each(arcs.config.types, function(help, type) { %>        <option><%= type %></option>      <% }) %>      </select>    </div>  </div></div>";
JST["viewer/annotations"] = "<ul class=\"annotations\"><% _.each(annotations, function(a) { %>  <li class=\"annotation\" data-id=\"<%= a.id %>\">  <% if (a.relation) { %>    <i class=\"icon-magnet\"></i>    <a href=\"<%= arcs.url('resource', a.relation.id) %>\"      class=\"subtle\"><%= a.relation.title %></a>  <% } else if (a.transcript) { %>    <i class=\"icon-align-justify\"></i>    <%= arcs.inflector.truncate(a.transcript, 200) %>  <% } else if (a.url) { %>    <i class=\"icon-share\"></i>    <a class=\"subtle\" href=\"<%= a.url %>\"><%= a.url %></a>  <% } %>  </li><% }) %></ul>";
JST["viewer/annotator"] = "<div class=\"annotator-tabs tabbable\">  <ul class=\"nav nav-tabs\">    <li class=\"active\">      <a href=\"#relation-tab\" data-toggle=\"tab\">Relation</a>    </li>    <li>      <a href=\"#transcription-tab\" data-toggle=\"tab\">Transcription</a>    </li>    <li>      <a href=\"#url-tab\" data-toggle=\"tab\">URL</a>    </li>  </ul>  <div class=\"tab-content\">    <div id=\"relation-tab\" class=\"tab-pane active\">      <div class=\"mini-search\"></div>      <div class=\"mini-search-results\">        <div class=\"loading-squares\" style=\"margin-top:40px\"></div>      </div>    </div>    <div id=\"transcription-tab\" class=\"tab-pane\">      <textarea class=\"transcription\" id=\"transcript\"         placeholder=\"Transcribe text within the resource...\"></textarea>    </div>    <div id=\"url-tab\" class=\"tab-pane\">      <div class=\"input-prepend\">        <span class=\"add-on\">http://</span>        <input id=\"url\" class=\"span2\" type=\"text\"           placeholder=\"google.com\"/>      </div>    </div>  </div></div>";
JST["viewer/carousel"] = "<% _.each(resources, function(r, i) { %>  <li>    <img class=\"thumb\" src=\"<%= r.thumb %>\" alt=\"thumbnail\"      style=\"width:100px; height:90px;\" data-id=\"<%= r.id %>\"/>    <div class=\"overlay\">      <span><%= i + 1 + offset %></span>    </div>  </li><% }) %>";
JST["viewer/collection_table"] = "<tr>  <td>Title</td>  <td>    <a class=\"subtle\"       href='<%= arcs.url(\"search\", \"collection:\" + arcs.inflector.enquote(title, false)) %>'>      <%- title || '' %>    </a>  </td></tr><tr>  <td>Description</td>  <td><%= description %></td></tr><% if (pdf) { %><tr>  <td>Original PDF</td>  <td><a href=\"<%= arcs.baseURL + 'resource/' + pdf %>\">Link</a></td></tr><% } %>";
JST["viewer/discussion"] = "<% _.each(comments, function(c) { %><div class=\"comment-wrapper\" id=\"comment-<%= c.id %>\">  <div class=\"comment-voice thumbnail\">    <img class=\"user-thmb\" src=\"http://gravatar.com/avatar/<%= c.gravatar %>?s=40\"/>  </div>  <div class=\"comment-header\">    <a class=\"name subtle\" href=\"<%= arcs.baseURL + 'user/' + c.username %>\">      <%= c.name %>    </a>    commented     <span class=\"time\"><%= relativeDate(new Date(c.created)) %></span>  </div>  <div class=\"comment\"><%- c.content %></div></div><% }) %>";
JST["viewer/document"] = "<iframe src=\"http://docs.google.com/gview?url=<%= url %>&embedded=true\"    style=\"width: 100%; height: 100%; float:left;\" frameborder=\"0\"></iframe>";
JST["viewer/hotkeys"] = "<div class=\"modal hotkeys-modal\">  <div class=\"modal-header\">    <a class=\"hotkeys-close pull-right\">close</a>    <h3>Shortcuts</h3>  </div>  <div class=\"modal-body\">    <table>      <thead>        <tr>          <th>Action</th>          <th>Keys(s)</th>        </tr>      </thead>      <tbody>        <tr>          <td>Navigate pages</td>          <td>            <i class=\"icon-white icon-arrow-left\"></i>            <i class=\"icon-white icon-arrow-right\"></i>          </td>        </tr>        <tr>          <td>Annotate</td>          <td>            <i class=\"icon-white icon-screenshot\"></i>          </td>        </tr>        <tr>          <td>Edit info</td>          <td><%= ctrl %> + E</td>        </tr>        <tr>          <td>Enter page number</td>          <td>P</td>        </tr>        <tr>          <td>Toggle annotation visibility</td>          <td>A</td>        </tr>        <tr>          <td>Zoom in</td>          <td>            <i class=\"icon-white icon-plus\"></i>          </td>        </tr>        <tr>          <td>Zoom out</td>          <td>            <i class=\"icon-white icon-minus\"></i>          </td>        </tr>      </tbody>    </table>  </div></div>";
JST["viewer/hotspots"] = "<% _.each(annotations, function(a) { %>  <% a.url = a.url || '#' %>  <a class=\"hotspot\" style=\"left:<%= a.x1 + offset %>px; top:<%= a.y1 %>px;     width:<%= a.x2 - a.x1 %>px; height:<%= a.y2 - a.y1 %>px;\" data-id=\"<%= a.id %>\"     href=\"<%= a.relation ? arcs.url('resource', a.relation.id) : a.url %>\">    <% if (arcs.user.is('Sr. Researcher') || a.user_id == arcs.user.id) { %>      <i class=\"remove-btn icon-remove\"></i>    <% } %>  </a><% }) %>";
JST["viewer/image"] = "<img src=\"<%= preview || url %>\" alt=\"resource\" data-zoom=\"1\" data-id=\"<%= id %>\">";
JST["viewer/keywords"] = "<ul class=\"keyword-list\"><% _.each(keywords, function(k) { %>  <li>    <a class=\"keyword-link subtle\" id=\"keyword-<%= k.id %>\"       href=\"<%= k.link %>\" data-id=\"<%= k.id %>\"><%- k.keyword %></a>    <% if (arcs.user.is('Sr. Researcher') || k.user_id == arcs.user.id) { %>      <i class=\"keyword-remove-btn icon-remove\"></i>    <% } %>  </li><% }) %></ul>";
JST["viewer/popover"] = "<% if (relation) { %>  <h3>  <% if (arcs.mime.isImage(relation.mime_type)) { %>    <i class=\"icon-picture\"></i>  <% } else if (arcs.mime.isVideo(relation.mime_type)) { %>    <i class=\"icon-film\"></i>  <% } else { %>    <i class=\"icon-file\"></i>  <% } %>  <%= relation.title %>  </h3>  <h4><%= relation.type %></h4>  <br><img class=\"thumb\" src=\"<%= relation.thumb %>\"/><% } else if (transcript) { %>  <p><%= arcs.inflector.truncate(transcript, 500) %></p><% } else { %>  <a href=\"<%= url %>\"><%= url %></a><% } %>";
JST["viewer/popover_title"] = "<% if (type == 'Relation') { %>Relation <i class=\"icon-magnet\"></i> <% } if (type == 'Transcription') { %>Transcription <i class=\"icon-align-justify\"></i> <% } if (type == 'URL') { %>URL <i class=\"icon-share\"></i><% } %>";
JST["viewer/table"] = "<tr>  <td>Title</td>  <td>    <a class=\"subtle\"       href='<%= arcs.url(\"search\", \"title:\" + arcs.inflector.enquote(title, false)) %>'>      <%- title || '' %>    </a>  </td></tr><tr>  <td>Access</td>  <td>    <a class=\"subtle\" href=\"<%= arcs.url('search', 'access:' + (public ? 'public' : 'private')) %>\">      <%= public ? \"public\" : \"private\" %>    </a>  </td></tr><tr>  <td>Type</td>  <td>    <a class=\"subtle\"       href='<%= arcs.url(\"search\", \"type:\" + arcs.inflector.enquote(type, false)) %>'>      <%- type || '' %>    </a>  </td></tr><tr>  <td>Created</td>  <td><%= created %></td></tr><% if (modified) { %><tr>  <td>Modified</td>  <td><%= modified %></td></tr><% } %><tr>  <td>File-name</td>  <td><a href=\"<%= url %>\"><%= file_name %></a></td></tr><tr>  <td>File-type</td>  <td><%= mime_type %></td></tr><% _.each(metadata.attributes, function(v, k) { %>  <% if (v) { %>  <tr>    <td><%- k.charAt(0).toUpperCase() + k.substr(1) %></td>    <td>    <% if (k.match(/date/i)) { %>      <%- v %>    <% } else { %>      <a class=\"subtle\"        href='<%= arcs.url(\"search\", k + \":\" + arcs.inflector.enquote(v, false)) %>'>        <%- v %>      </a>    <% } %>    </td>  </tr>  <% } %><% }) %>";
